<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Install | Monal</title>
<meta name=keywords content><meta name=description content="iOS macOS macOS (homebrew) Stable App Store App Store brew install --cask monal Beta Testflight Invitation Testflight Invitation brew install --cask monal@beta Alpha upon request to info@monal-im.org
Then download from our alpha download site brew tap monal-im/homebrew-monal-alpha
brew install --cask monal-alpha Features Monal currently covers the following chat features:
Decentralised and federated chat standard XMPP Private and group messaging Privacy-respecting push notifications Encrypted private and group chats (state-of-the-art encryption (OMEMO) Message history Free selection of your XMPP account provider Voice messaging Message archiving Upload of files, videos and images (HTTP Upload) Audio and Video calls Many settings and a design to offer privacy settings in the app to the need of the user A detailed and technical listing of your supported features (so called XMPP Extensions) can be found in our DOAP file."><meta name=author content="Monal"><link crossorigin=anonymous href=/monal-im.org/site/assets/css/stylesheet.1ae742f00bc5f2d0a3081012780dcc1b3bd5bedc9543ac834ee6c4a2376d6d05.css integrity="sha256-GudC8AvF8tCjCBASeA3MGzvVvtyVQ6yDTubEojdtbQU=" rel="preload stylesheet" as=style fetchpriority=high><link rel=apple-touch-icon sizes=57x57 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu9226661354266959314.png fetchpriority=medium><link rel=apple-touch-icon sizes=60x60 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu8470063439725904799.png fetchpriority=medium><link rel=apple-touch-icon sizes=72x72 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu18288407859476642524.png fetchpriority=medium><link rel=apple-touch-icon sizes=76x76 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu6414787890045216233.png fetchpriority=medium><link rel=apple-touch-icon sizes=114x114 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu6619652817782247178.png fetchpriority=low><link rel=apple-touch-icon sizes=120x120 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu894495203423433172.png fetchpriority=low><link rel=apple-touch-icon sizes=144x144 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu1793076886603118967.png fetchpriority=low><link rel=apple-touch-icon sizes=152x152 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu6527885457578573986.png fetchpriority=low><link rel=apple-touch-icon sizes=180x180 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu14423601252178870903.png fetchpriority=low><link rel=icon type=image/x-icon href=https://monal-im.github.io/monal-im.org/site/favicons/favicon.ico fetchpriority=medium><link rel=icon type=image/png sizes=16x16 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu5274798539085373485.png fetchpriority=medium><link rel=icon type=image/png sizes=32x32 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu6030642740833475062.png fetchpriority=medium><link rel=icon type=image/png sizes=96x96 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu12801676228225958111.png fetchpriority=low><link rel=icon type=image/png sizes=128x128 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu2459652923700611417.png fetchpriority=low><link rel=icon type=image/png sizes=196x196 href=https://monal-im.github.io/monal-im.org/site/favicons/logo_hu2634708206758277487.png fetchpriority=low><link rel=mask-icon color=red href=favicons/safari-pinned-tab.svg fetchpriority=low><meta name=application-name content="Monal-IM"><meta name=msapplication-TileColor content="#FFFFFF"><meta name=msapplication-square70x70logo content="https://monal-im.github.io/monal-im.org/site/favicons/logo_hu9246991740056342692.png" fetchpriority=medium><meta name=msapplication-TileImage content="https://monal-im.github.io/monal-im.org/site/favicons/logo_hu1793076886603118967.png" fetchpriority=low><meta name=msapplication-square150x150logo content="https://monal-im.github.io/monal-im.org/site/favicons/logo_hu7604909012089617892.png" fetchpriority=low><meta name=msapplication-square310x310logo content="https://monal-im.github.io/monal-im.org/site/favicons/logo_hu6170689704943308540.png" fetchpriority=low><meta property="og:title" content="Install"><meta property="og:description" content="iOS macOS macOS (homebrew) Stable App Store App Store brew install --cask monal Beta Testflight Invitation Testflight Invitation brew install --cask monal@beta Alpha upon request to info@monal-im.org
Then download from our alpha download site brew tap monal-im/homebrew-monal-alpha
brew install --cask monal-alpha Features Monal currently covers the following chat features:
Decentralised and federated chat standard XMPP Private and group messaging Privacy-respecting push notifications Encrypted private and group chats (state-of-the-art encryption (OMEMO) Message history Free selection of your XMPP account provider Voice messaging Message archiving Upload of files, videos and images (HTTP Upload) Audio and Video calls Many settings and a design to offer privacy settings in the app to the need of the user A detailed and technical listing of your supported features (so called XMPP Extensions) can be found in our DOAP file."><meta property="og:type" content="article"><meta property="og:url" content="https://monal-im.github.io/monal-im.org/site/install/"><meta property="article:section" content><meta property="article:published_time" content="2022-03-12T08:09:44+01:00"><meta property="article:modified_time" content="2024-05-26T05:01:17+02:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Install","item":"https://monal-im.github.io/monal-im.org/site/install/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Install","name":"Install","description":"iOS macOS macOS (homebrew) Stable App Store App Store brew install --cask monal Beta Testflight Invitation Testflight Invitation brew install --cask monal@beta Alpha upon request to info@monal-im.org\nThen download from our alpha download site brew tap monal-im/homebrew-monal-alpha\nbrew install --cask monal-alpha Features Monal currently covers the following chat features:\nDecentralised and federated chat standard XMPP Private and group messaging Privacy-respecting push notifications Encrypted private and group chats (state-of-the-art encryption (OMEMO) Message history Free selection of your XMPP account provider Voice messaging Message archiving Upload of files, videos and images (HTTP Upload) Audio and Video calls Many settings and a design to offer privacy settings in the app to the need of the user A detailed and technical listing of your supported features (so called XMPP Extensions) can be found in our DOAP file.","keywords":[],"articleBody":" iOS macOS macOS (homebrew) Stable App Store App Store brew install --cask monal Beta Testflight Invitation Testflight Invitation brew install --cask monal@beta Alpha upon request to info@monal-im.org\nThen download from our alpha download site brew tap monal-im/homebrew-monal-alpha\nbrew install --cask monal-alpha Features Monal currently covers the following chat features:\nDecentralised and federated chat standard XMPP Private and group messaging Privacy-respecting push notifications Encrypted private and group chats (state-of-the-art encryption (OMEMO) Message history Free selection of your XMPP account provider Voice messaging Message archiving Upload of files, videos and images (HTTP Upload) Audio and Video calls Many settings and a design to offer privacy settings in the app to the need of the user A detailed and technical listing of your supported features (so called XMPP Extensions) can be found in our DOAP file. Planned features User-interface overhaul Implemented XEPs XEP Status Since xep-0004 complete 4.9 xep-0030 complete 4.6 xep-0045 partial 5.0 xep-0048 complete 5.0 xep-0054 Implemented only for MUC profiles complete 5.0 xep-0059 complete 4.8 xep-0060 Used mainly for Pep partial 4.9 xep-0066 Used to mark XEP-0363 filetransfers only partial 4.9 xep-0077 partial 4.7 xep-0084 complete 4.9 xep-0085 Only typing notifications, use XEP-0319 to publish interactions partial 4.7 xep-0092 complete 5.0 xep-0115 complete 4.7 xep-0153 XEP-0153: vCard-Based Avatars (implemented only for MUC profiles) partial 5.0 xep-0162 partial 5.4 xep-0163 complete 4.9 xep-0167 complete 6.0 xep-0176 complete 6.0 xep-0172 complete 4.9 xep-0184 complete 4.7 xep-0191 complete 5.0 xep-0198 complete 4.6 xep-0199 complete 4.7 xep-0215 complete 6.0 xep-0223 XEP-0223: Persistent Storage of Private Data via PubSub complete 4.9 xep-0237 complete 4.6 xep-0245 complete 4.9 xep-0249 XEP-0249: Direct MUC Invitations complete 5.0 xep-0280 complete 4.5 xep-0286 complete 4.7 xep-0293 complete 6.0 xep-0294 complete 6.0 xep-0305 complete 5.1.1 xep-0308 complete 4.8 xep-0313 complete 4.8 xep-0319 complete 4.7 xep-0320 complete 6.0 xep-0333 complete 4.8 xep-0338 complete 6.0 xep-0339 complete 6.0 xep-0352 complete 4.7 xep-0353 complete 6.0 xep-0357 complete 4.8 xep-0359 complete 4.8 xep-0363 complete 4.9 xep-0368 complete 4.6 xep-0379 No automatic approval if server does not support subscription pre-approval; No checking of tokens, if server does not do so (XEP-0401) partial 4.9 xep-0380 complete 5.1 xep-0384 complete 4.8 xep-0388 complete 6.0 xep-0392 complete 5.1 xep-0398 Used for MUC avatars complete 6.0 xep-0401 complete 6.0 xep-0402 complete 5.4 xep-0410 complete 5.0 xep-0423 Check this XEP to see what's missing partial xep-0424 complete 6.3 xep-0425 complete 6.3 xep-0440 complete 6.0 xep-0441 Only to automatically turn on archiving if possible (setting: always) complete 4.8 xep-0445 complete 5.2 xep-0454 No support for embedded thumbnails partial 5.0 xep-0474 complete 6.0 xep-0480 complete 6.0 xep-0486 complete 5.0 xep-0490 complete 6.3 Planned XEPs XEP Status xep-0158: { \"-xmlns\": \"\", \"header\": { \"abstract\": \"This document specifies an XMPP protocol extension that entities may use to discover whether the sender of an XML stanza is a human user or a robot.\", \"approver\": \"Council\", \"author\": [ { \"email\": \"ian.paterson@clientside.co.uk\", \"firstname\": \"Ian\", \"jid\": \"ian@zoofy.com\", \"surname\": \"Paterson\" }, { \"email\": \"stpeter@stpeter.im\", \"firstname\": \"Peter\", \"jid\": \"stpeter@jabber.org\", \"surname\": \"Saint-Andre\", \"uri\": \"https://stpeter.im/\" } ], \"dependencies\": { \"spec\": [ \"XMPP Core\", \"XMPP IM\", \"XEP-0004\", \"XEP-0066\", \"XEP-0221\" ] }, \"legal\": { \"conformance\": { \"#text\": \"This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/about/xsf/ipr-policy\", \"-url\": \"https://xmpp.org/about/xsf/ipr-policy\" } }, \"copyright\": { \"#text\": \"This XMPP Extension Protocol is copyright © 1999 – 2024 by the\", \"link\": { \"#text\": \"XMPP Standards Foundation\", \"-url\": \"https://xmpp.org/\" } }, \"liability\": \"In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.\", \"permissions\": \"Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \\\"Specification\\\"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.\", \"warranty\": \"## NOTE WELL: This Specification is provided on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##\" }, \"number\": \"0158\", \"revision\": [ { \"date\": \"2019-11-07\", \"initials\": \"egp, mb\", \"remark\": { \"p\": \"Use the correct FORM_TYPE for extended IBR, and use a proper MUC join as an example. Also fix typos.\" }, \"version\": \"1.0.1\" }, { \"date\": \"2008-09-03\", \"initials\": \"psa\", \"remark\": { \"p\": \"Per a vote of the XMPP Council, advanced status to Draft; concurrently, the XMPP Registrar issued the urn:xmpp:captcha namespace; also changed element name from challenge to captcha in order to match the namespace name.\" }, \"version\": \"1.0\" }, { \"date\": \"2008-08-06\", \"initials\": \"psa\", \"remark\": { \"p\": \"Further modified examples to track changes to XEP-0231.\" }, \"version\": \"0.11\" }, { \"date\": \"2008-08-06\", \"initials\": \"psa\", \"remark\": { \"p\": \"Modified examples to track changes to XEP-0231; to avoid confusion with cid URIs, changed name of challenge ID form field from cid to challenge.\" }, \"version\": \"0.10\" }, { \"date\": \"2008-05-12\", \"initials\": \"psa\", \"remark\": { \"p\": \"Specified that cid field is required; more clearly defined structure of challenge stanza; added several security considerations; corrected several errors in the text and examples.\" }, \"version\": \"0.9\" }, { \"date\": \"2008-05-12\", \"initials\": \"psa\", \"remark\": { \"p\": \"Moved text regarding labels to new internationalization considerations section; removed necessity that ID of IQ-set shall match ID of challenge, since this is not consistent with existing usage that IDs are generated by the sender of an IQ.\" }, \"version\": \"0.8\" }, { \"date\": \"2008-04-28\", \"initials\": \"psa\", \"remark\": { \"p\": \"Generalized text to cover abuse rather than just spim; modified temporary namespace to adhere to XMPP Registrar procedures; added use case for joining multi-user chat rooms.\" }, \"version\": \"0.7\" }, { \"date\": \"2007-07-11\", \"initials\": \"psa/ip\", \"remark\": { \"p\": \"Moved media element definition to XEP-0221; consistently used the terms sender and challenger rather than client and entity; modified provisional namespaces to adhere to XMPP Registrar policies; completed editorial review.\" }, \"version\": \"0.6\" }, { \"date\": \"2006-10-30\", \"initials\": \"ip\", \"remark\": { \"p\": \"Added reference to SPIM Reporting.\" }, \"version\": \"0.5\" }, { \"date\": \"2005-09-30\", \"initials\": \"ip\", \"remark\": { \"p\": \"Required WAV instead of MP3 for audio CAPTCHAs; minor corrections.\" }, \"version\": \"0.4\" }, { \"date\": \"2005-09-28\", \"initials\": \"ip\", \"remark\": { \"p\": \"Added more CAPTCHA types and the legacy question and answer section.\" }, \"version\": \"0.3\" }, { \"date\": \"2005-09-14\", \"initials\": \"ip\", \"remark\": { \"p\": \"Minor fixes.\" }, \"version\": \"0.2\" }, { \"date\": \"2005-09-14\", \"initials\": \"ip\", \"remark\": { \"p\": \"Initial version.\" }, \"version\": \"0.1\" }, { \"date\": \"2005-09-07\", \"initials\": \"ip\", \"remark\": { \"p\": \"First draft.\" }, \"version\": \"0.0.1\" } ], \"schemaloc\": { \"url\": \"http://xmpp.org/schemas/captcha.xsd\" }, \"shortname\": \"captcha\", \"sig\": \"Standards\", \"status\": \"Draft\", \"supersededby\": \"\", \"supersedes\": \"\", \"title\": \"CAPTCHA Forms\", \"type\": \"Standards Track\" }, \"section1\": [ { \"-anchor\": \"intro\", \"-topic\": \"Introduction\", \"p\": [ { \"#text\": \"The appearance of large public IM services based on\", \"em\": \"discourage\", \"note\": [ { \"#text\": \"RFC 6120: Extensible Messaging and Presence Protocol (XMPP): Core \\u003c\", \"link\": { \"#text\": \"http://tools.ietf.org/html/rfc6120\", \"-url\": \"http://tools.ietf.org/html/rfc6120\" } }, { \"#text\": \"RFC 6121: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence \\u003c\", \"link\": { \"#text\": \"http://tools.ietf.org/html/rfc6121\", \"-url\": \"http://tools.ietf.org/html/rfc6121\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"XMPP Core\", \"-url\": \"http://tools.ietf.org/html/rfc6120\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"XMPP IM\", \"-url\": \"http://tools.ietf.org/html/rfc6121\" } } ] }, { \"#text\": \"One technique developed to combat abusive messages and behavior via non-XMPP technologies requires humans to be differentiated from bots using a \\\"Completely Automated Public Turing Test to Tell Computers and Humans Apart\\\" or CAPTCHA (see \\u003c\", \"link\": { \"#text\": \"http://www.captcha.net/\", \"-url\": \"http://www.captcha.net/\" } }, { \"#text\": \"An alternative technique to CAPTCHAs requires Desktop PC clients to undertake a\", \"note\": { \"#text\": \"Hashcash \\u003c\", \"link\": { \"#text\": \"http://hashcash.org/\", \"-url\": \"http://hashcash.org/\" } }, \"span\": { \"#text\": \"Hashcash\", \"-class\": \"ref\" } }, \"Both CAPTCHAs and hashcash have been criticized regarding their effectiveness (or lack thereof). Therefore, the challenge protocol specified herein provides a great deal of flexibility, so that challenges can include CAPTCHAs, hashcash, word puzzles, so-called kitten authentication, and any other mechanism that may be developed in the future.\", { \"#text\": \"The generic challenge protocol described in this document is designed for incorporation into protocols such as\", \"note\": [ { \"#text\": \"XEP-0077: In-Band Registration \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0077.html\", \"-url\": \"https://xmpp.org/extensions/xep-0077.html\" } }, { \"#text\": \"XEP-0045: Multi-User Chat \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0045.html\", \"-url\": \"https://xmpp.org/extensions/xep-0045.html\" } }, { \"#text\": \"XEP-0016: Privacy Lists \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0016.html\", \"-url\": \"https://xmpp.org/extensions/xep-0016.html\" } }, { \"#text\": \"XEP-0159: SPIM-Blocking Control \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0159.html\", \"-url\": \"https://xmpp.org/extensions/xep-0159.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"In-Band Registration (XEP-0077)\", \"-url\": \"https://xmpp.org/extensions/xep-0077.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Multi-User Chat (XEP-0045)\", \"-url\": \"https://xmpp.org/extensions/xep-0045.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Privacy Lists (XEP-0016)\", \"-url\": \"https://xmpp.org/extensions/xep-0016.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"SPIM-Blocking Control (XEP-0159)\", \"-url\": \"https://xmpp.org/extensions/xep-0159.html\" } } ] } ] }, { \"-anchor\": \"require\", \"-topic\": \"Requirements\", \"section2\": [ { \"-anchor\": \"require-extend\", \"-topic\": \"Extensibility\", \"p\": \"The CAPTCHAs in most common use today are Optical Character Recognition (OCR) challenges where an image containing deformed text is presented and the human enters the characters they can read. However, if OCR software advances more rapidly than the techniques used to disguise text from Artificial Intelligence (AI) then very different CAPTCHAs will need to be deployed. This protocol must be extensible enough to allow the incorporation of CAPTCHA techniques that may not have been envisaged.\" }, { \"-anchor\": \"require-variety\", \"-topic\": \"Variety\", \"p\": { \"#text\": \"Several common CAPTCHA techniques present major problems to users with disabilities (see\", \"note\": { \"#text\": \"Inaccessibility of Visually-Oriented Anti-Robot Tests \\u003c\", \"link\": { \"#text\": \"http://www.w3.org/TR/turingtest/\", \"-url\": \"http://www.w3.org/TR/turingtest/\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Inaccessibility of Visually-Oriented Anti-Robot Tests\", \"-url\": \"http://www.w3.org/TR/turingtest/\" } } } } ] }, { \"-anchor\": \"protocol\", \"-topic\": \"Protocol\", \"section2\": [ { \"-anchor\": \"protocol-simple\", \"-topic\": \"Simple Challenge\", \"section3\": [ { \"-anchor\": \"protocol-trigger\", \"-topic\": \"Triggering Stanza\", \"example\": { \"#text\": \"\\u003cmessage from='robot@abuser.com/zombie'\\n to='innocent@victim.com'\\n xml:lang='en'\\n id='spam1'\\u003e\\n \\u003cbody\\u003eLove pills - 75% OFF\\u003c/body\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttp://www.abuser.com/lovepills.html\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Sender Generates Triggering Stanza\" }, \"p\": \"A \\\"triggering stanza\\\" is an XMPP \\u003cmessage/\\u003e, \\u003cpresence/\\u003e, or \\u003ciq/\\u003e stanza that is deemed abusive by the receiving entity (e.g., a client) or an intermediate router (e.g., a server). The entity that generates a triggering stanza is called a \\\"sender\\\".\" }, { \"-anchor\": \"protocol-challenge\", \"-topic\": \"Challenge Stanza\", \"example\": { \"#text\": \"\\u003cmessage from='victim.com'\\n to='robot@abuser.com/zombie'\\n xml:lang='en'\\n id='F3A6292C'\\u003e\\n \\u003cbody\\u003e\\n Your messages to innocent@victim.com are being blocked. To unblock\\n them, visit http://www.victim.com/challenge.html?F3A6292C\\n \\u003c/body\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttp://www.victim.com/challenge.html?F3A6292C\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='sid'\\u003e\\u003cvalue\\u003espam1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr' label='Enter the text you see'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='80'\\n width='290'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/ocr.jpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n cid:sha1+f24030b8d91d233bac14777be5ab531ca3b9f102@bob.xmpp.org\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='picture_recog' label='Identify the picture'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='150'\\n width='150'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/picture.jpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n cid:sha1+f2377f3a3287eac81028243079e1aa9905c466bc@bob.xmpp.org\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='speech_recog' label='Enter the words you hear'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\u003e\\n \\u003curi type='audio/x-wav'\\u003e\\n http://www.victim.com/challenges/speech.wav?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003curi type='audio/ogg-speex'\\u003e\\n http://www.victim.com/challenges/speech.ogg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='video_recog' label='Identity the video'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='150'\\n width='150'\\u003e\\n \\u003curi type='video/mpeg'\\u003e\\n http://www.victim.com/challenges/video.mpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='Type the color of a stop light' type='text-single' var='qa'/\\u003e\\n \\u003cfield label='93C7A' type='text-single' var='SHA-256'/\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Offers a Choice of Challenges to Sender\" }, \"ol\": { \"li\": [ \"The challenge stanza MUST include an 'id' attribute set to the challenge ID (i.e., a unique identifier for this challenge within the challenger's application).\", \"The challenge stanza SHOULD include a \\u003cbody/\\u003e element that provides an explanation of the challenge for clients that do not yet support CAPTCHA forms.\", { \"#text\": \"The challenge stanza MAY include a URL (typically a Web page with instructions) using\", \"note\": { \"#text\": \"XEP-0066: Out of Band Data \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0066.html\", \"-url\": \"https://xmpp.org/extensions/xep-0066.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Out-of-Band Data (XEP-0066)\", \"-url\": \"https://xmpp.org/extensions/xep-0066.html\" } } }, \"The 'xml:lang' attribute of the challenge stanza SHOULD be the same as the one received from the sender, if any.\", { \"#text\": \"The challenge stanza MUST include a CAPTCHA form, i.e., a data form of type \\\"form\\\" containing one or more challenges.\", \"note\": \"Inclusion of a CAPTCHA form not only makes it possible to flexibly support or require a large number of challenge types, but also enables constrained clients to respond to challenges (e.g., mobile phone clients that cannot present web pages, or clients on XMPP-only networks).\" }, { \"#text\": \"The CAPTCHA form MUST include a hidden field named \\\"FORM_TYPE\\\" (in accordance with\", \"note\": { \"#text\": \"XEP-0068: Field Data Standardization for Data Forms \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0068.html\", \"-url\": \"https://xmpp.org/extensions/xep-0068.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Field Standardization for Data Forms (XEP-0068)\", \"-url\": \"https://xmpp.org/extensions/xep-0068.html\" } } }, \"The CAPTCHA form MUST include a hidden field named \\\"challenge\\\" set to the challenge ID.\", \"The CAPTCHA form MUST include a hidden field named \\\"from\\\" set to the value of the 'to' attribute from the triggering stanza.\", \"If the triggering stanza included an 'id' attribute, then the CAPTCHA form MUST include a hidden field named \\\"sid\\\" set to that value.\", \"Each of the CAPTCHA form's non-hidden \\u003cfield/\\u003e elements MAY contain a different challenge.\", { \"#text\": \"Each CAPTCHA field MAY contain a media element (see\", \"note\": { \"#text\": \"XEP-0221: Data Forms Media Element \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0221.html\", \"-url\": \"https://xmpp.org/extensions/xep-0221.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Data Forms Media Element (XEP-0221)\", \"-url\": \"https://xmpp.org/extensions/xep-0221.html\" } } } ] }, \"p\": [ \"Upon receiving a triggering stanza, an entity MAY send a \\\"challenge stanza\\\". An entity MUST NOT send a challenge stanza under any other circumstances. The entity that generates the challenge stanza is called the \\\"challenger\\\".\", { \"#text\": \"The challenge stanza consists of an XMPP \\u003cmessage/\\u003e stanza containing a data form for the sender to fill out, formatted according to\", \"note\": { \"#text\": \"XEP-0004: Data Forms \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0004.html\", \"-url\": \"https://xmpp.org/extensions/xep-0004.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Data Forms (XEP-0004)\", \"-url\": \"https://xmpp.org/extensions/xep-0004.html\" } } }, { \"#text\": \"The sender then would retrieve the media data via HTTP or (for the cid: URIs) via XMPP as described in\", \"note\": { \"#text\": \"XEP-0231: Bits of Binary \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0231.html\", \"-url\": \"https://xmpp.org/extensions/xep-0231.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Bits of Binary (XEP-0231)\", \"-url\": \"https://xmpp.org/extensions/xep-0231.html\" } } } ] }, { \"-anchor\": \"protocol-response\", \"-topic\": \"Response Stanza\", \"example\": [ { \"#text\": \"\\u003cmessage type='error'\\n from='robot@abuser.com/zombie'\\n to='victim.com'\\n xml:lang='en'\\n id='F3A6292C'\\u003e\\n \\u003cerror type='modify'\\u003e\\n \\u003cnot-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/\\u003e\\n \\u003c/error\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Sender Reports Challenge Not Acceptable\" }, { \"#text\": \"\\u003ciq type='set'\\n from='robot@abuser.com/zombie'\\n to='victim.com'\\n xml:lang='en'\\n id='z140r0s'\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='submit'\\u003e\\n \\u003cfield var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='sid'\\u003e\\u003cvalue\\u003espam1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr'\\u003e\\u003cvalue\\u003e7nHL3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Sender Sends One Response to Challenger\" } ], \"p\": [ \"The sender's client SHOULD ignore the challenge stanza in either of the following cases:\", { \"#text\": \"Otherwise, if the challenger provided a URL using\", \"cite\": \"Out-of-Band Data\" }, \"Otherwise, the sender's client MUST respond to the challenge.\", \"The sender's client MUST respond with a \\u003cnot-acceptable/\\u003e error in any of the following cases:\", \"Otherwise, it MUST select one challenge according to the sender's preferences and submit the sender's response form to the challenger.\" ], \"ul\": [ { \"li\": [ { \"#text\": \"If it has not recently sent (e.g., in the last two minutes) a stanza to the JID specified in the 'from' field of the form with the 'id' specified in the 'sid' field (or with no 'id' if no 'sid' field is included).\", \"note\": \"Otherwise the user's presence would be disclosed, or a robot might dupe the user into providing answers to other people's challenges!\" }, \"If the 'from' attribute of the challenge stanza does not match the 'from' field of the form. (If the values are different, then they still match if the bare JIDs are the same, or if the 'from' attribute is the domain of the other JID.)\" ] }, { \"li\": [ \"if it does not understand the CAPTCHA form\", { \"#text\": \"if it does not support all of the\", \"em\": \"required\", \"link\": { \"#text\": \"Multiple Challenges\", \"-url\": \"#protocol-multiple\" } }, { \"#text\": \"if it does not support enough of the challenges (see\", \"link\": { \"#text\": \"Multiple Challenges\", \"-url\": \"#protocol-multiple\" } } ] }, { \"li\": [ { \"#text\": \"if it does not support all of the required challenges (see\", \"link\": { \"#text\": \"Multiple Challenges\", \"-url\": \"#protocol-multiple\" } }, { \"#text\": \"if it does not support enough of the challenges (see\", \"link\": { \"#text\": \"Multiple Challenges\", \"-url\": \"#protocol-multiple\" } }, \"if the sender declines the challenge\" ] } ] }, { \"-anchor\": \"protocol-result\", \"-topic\": \"Result Stanza\", \"example\": [ { \"#text\": \"\\u003ciq type='error'\\n from='victim.com'\\n to='robot@abuser.com/zombie'\\n id='z140r0s'\\u003e\\n \\u003cerror type='cancel'\\u003e\\n \\u003cservice-unavailable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/\\u003e\\n \\u003c/error\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Challenger Indicates Challenge Not Found\" }, { \"#text\": \"\\u003ciq type='result'\\n from='victim.com'\\n to='robot@abuser.com/zombie'\\n id='z140r0s'/\\u003e\", \"-caption\": \"Challenger Tells Sender it Passed\" }, { \"#text\": \"\\u003ciq type='error'\\n from='victim.com'\\n to='robot@abuser.com/zombie'\\n id='z140r0s'\\u003e\\n \\u003cerror type='cancel'\\u003e\\n \\u003cnot-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/\\u003e\\n \\u003c/error\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Challenger Tells Sender it Failed\" } ], \"p\": [ \"The challenger SHOULD send a \\u003cservice-unavailable/\\u003e error to the sender if:\", \"Note: This error MAY be sent even in cases where the challenge became unnecessary while the challenger was waiting for the response.\", \"After receiving a correct response to its challenge, the challenger SHOULD inform the sender that it was successful.\", { \"#text\": \"However, if the sender submits an incorrect response the challenger SHOULD send it a \\u003cnot-acceptable/\\u003e error with type \\\"cancel\\\":\", \"note\": { \"#text\": \"If a large proportion of the responses a server is receiving from another IP are incorrect then it SHOULD inform the administrator of the other server using the protocol specified in\", \"note\": [ { \"#text\": \"XEP-0161: Abuse Reporting \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0161.html\", \"-url\": \"https://xmpp.org/extensions/xep-0161.html\" } }, { \"#text\": \"XEP-0236: Abuse Reporting \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0236.html\", \"-url\": \"https://xmpp.org/extensions/xep-0236.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"Abuse Reporting (XEP-0161)\", \"-url\": \"https://xmpp.org/extensions/xep-0161.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Abuse Reporting (XEP-0236)\", \"-url\": \"https://xmpp.org/extensions/xep-0236.html\" } } ] } } ], \"ul\": { \"li\": [ { \"#text\": \"The challenger did not send the specified challenge.\", \"note\": \"If the challenger is a client then it SHOULD be careful not to leak information about the presence of the sender and reply to potentially bogus challenge responses with exactly the same XML that its server would send if the sender were offline.\" }, \"The sender already submitted its response to this challenge.\", \"The sender took too long to submit its response.\" ] } } ] }, { \"-anchor\": \"protocol-multiple\", \"-topic\": \"Multiple Challenges\", \"example\": [ { \"#text\": \"\\u003cmessage from='victim.com'\\n to='robot@abuser.com/zombie'\\n xml:lang='en'\\n id='73DE28A2'\\u003e\\n \\u003cbody\\u003eYour messages to innocent@victim.com are being blocked.\\n To unblock them, ask innocent@victim.com to send you a message.\\u003c/body\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003e73DE28A2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='sid'\\u003e\\u003cvalue\\u003espam2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='answers'\\u003e\\u003cvalue\\u003e2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr' label='Enter the text you see'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='80'\\n width='290'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/ocr.jpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n cid:sha1+f24030b8d91d233bac14777be5ab531ca3b9f102@bob.xmpp.org\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='audio_recog' label='Describe the sound you hear'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\u003e\\n \\u003curi type='audio/x-wav'\\u003e\\n http://www.victim.com/challenges/audio.wav?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='Type the color of a stop light' type='text-single' var='qa'\\u003e\\n \\u003crequired/\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='e03d7' type='text-single' var='SHA-256'/\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Sets Multiple Challenges\" }, { \"#text\": \"\\u003ciq type='set'\\n from='robot@abuser.com/zombie'\\n to='victim.com'\\n xml:lang='en'\\n id='73DE28A2'\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='submit'\\u003e\\n \\u003cfield var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='challenge'\\u003e\\u003cvalue\\u003e73DE28A2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='sid'\\u003e\\u003cvalue\\u003espam2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='answers'\\u003e\\u003cvalue\\u003e2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='qa'\\u003e\\u003cvalue\\u003ered\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='SHA-256'\\u003e\\u003cvalue\\u003einnocent@victim.com2450F06C173B05E3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Sender Sends Multiple Responses to the Challenger\" } ], \"p\": [ \"The challenger MAY demand responses to more than one of the challenges it is offering; this is done by including an 'answers' \\u003cfield/\\u003e element in the form, which specifies how many answers the sender needs to include. The challenger also MAY require responses to particular challenges; this is done by including a \\u003crequired/\\u003e element in the compulsory fields.\", { \"#text\": \"If the sender finds the request acceptable, it MUST answer all challenges that include a \\u003crequired/\\u003e element. If the total number of answers was specified and it is greater than the number of \\u003crequired/\\u003e elements then the sender MUST also answer one or more of the challenges without a \\u003crequired/\\u003e element. In the example above, the sender should respond to the 'qa' challenge\", \"em\": \"and\" }, \"The challenger MAY decide the sender has passed a challenge even if the responses are not all perfectly correct.\" ] } ] }, { \"-anchor\": \"register\", \"-topic\": \"Extended In-Band Registration\", \"example\": [ { \"#text\": \"\\u003ciq type='get' xml:lang='en' id='reg1'\\u003e\\n \\u003cquery xmlns='jabber:iq:register'/\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Entity Requests Registration Fields from Host\" }, { \"#text\": \"\\u003ciq type='result' xml:lang='en' id='reg1'\\u003e\\n \\u003cquery xmlns='jabber:iq:register'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003ejabber:iq:register\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='sid'\\u003e\\u003cvalue\\u003ereg1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='answers'\\u003e\\u003cvalue\\u003e3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr' label='Enter the text you see'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='80'\\n width='290'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/ocr.jpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='93C7A' type='text-single' var='SHA-256'/\\u003e\\n \\u003cfield type='text-single' var='username'\\u003e\\n \\u003crequired/\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='text-private' var='password'\\u003e\\n \\u003crequired/\\u003e\\n \\u003c/field\\u003e\\n \\u003c/x\\u003e\\n \\u003cinstructions\\u003e\\n To register, visit http://www.victim.com/register.html\\n \\u003c/instructions\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttp://www.victim.com/register.html\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n \\u003c/query\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Host Returns Registration and Challenge Fields to Entity\" }, { \"#text\": \"\\u003ciq type='set' xml:lang='en' id='reg2'\\u003e\\n \\u003cquery xmlns='jabber:iq:register'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='submit'\\u003e\\n \\u003cfield var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003ejabber:iq:register\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='sid'\\u003e\\u003cvalue\\u003ereg1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='answers'\\u003e\\u003cvalue\\u003e3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr'\\u003e\\u003cvalue\\u003e7nHL3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='username'\\u003e\\u003cvalue\\u003ebill\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='password'\\u003e\\u003cvalue\\u003eCalliope\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003c/x\\u003e\\n \\u003c/query\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Entity Provides Required Information In-Band\" } ], \"p\": [ { \"#text\": \"This section shows how challenges SHOULD be combined with the existing In-Band Registration protocol according to the rules defined in the Extensibility section of\", \"cite\": \"XEP-0077\" }, { \"#text\": \"Note: The \\u003cchallenge/\\u003e wrapper element is not included, because\", \"cite\": \"XEP-0077\" }, \"Note that the CAPTCHA form MUST be inside the \\u003cquery/\\u003e element, and the server's challenge ID is specified within the form:\", { \"#text\": \"The server MAY include an \\u003cinstructions/\\u003e element and a URL using\", \"cite\": [ \"Out-of-Band Data\", \"In-Band Registration\" ] } ] }, { \"-anchor\": \"muc\", \"-topic\": \"Multi-User Chat\", \"example\": [ { \"#text\": \"\\u003cpresence from='robot@abuser.com/zombie'\\n to='friendly-chat@muc.victim.com/robot101'\\u003e\\n \\u003cx xmlns='http://jabber.org/protocol/muc'/\\u003e\\n\\u003c/presence\\u003e\", \"-caption\": \"Sender Attempts to Join Chat Room\" }, { \"#text\": \"\\u003cmessage from='friendly-chat@muc.victim.com'\\n to='robot@abuser.com/zombie'\\n id='A4C7303D'\\u003e\\n \\u003cbody\\u003e\\n Your messages to friendly-chat@muc.victim.com are being blocked. To unblock\\n them, visit http://www.victim.com/challenge.html?A4C7303D\\n \\u003c/body\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttp://www.victim.com/challenge.html?A4C7303D\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='from'\\u003e\\u003cvalue\\u003efriendly-chat@muc.victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003eA4C7303D\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr' label='Enter the text you see'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='80'\\n width='290'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/ocr.jpeg?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='picture_recog' label='Identify the picture'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='150'\\n width='150'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/picture.jpeg?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n cid:sha1+f2377f3a3287eac81028243079e1aa9905c466bc@bob.xmpp.org\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='speech_recog' label='Enter the words you hear'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\u003e\\n \\u003curi type='audio/x-wav'\\u003e\\n http://www.victim.com/challenges/speech.wav?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003curi type='audio/ogg-speex'\\u003e\\n http://www.victim.com/challenges/speech.ogg?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='video_recog' label='Identity the video'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='150'\\n width='150'\\u003e\\n \\u003curi type='video/mpeg'\\u003e\\n http://www.victim.com/challenges/video.mpeg?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='Type the color of a stop light' type='text-single' var='qa'/\\u003e\\n \\u003cfield label='93C7A' type='text-single' var='SHA-256'/\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Offers a Choice of Challenges to Sender\" } ], \"p\": { \"#text\": \"A service that hosts multi-user chat rooms in accordance with\", \"cite\": \"XEP-0045\" } }, { \"-anchor\": \"challenge\", \"-topic\": \"Challenge Types\", \"section2\": [ { \"-anchor\": \"challenge-intro\", \"-topic\": \"Introduction\", \"p\": [ \"Entities MUST address the needs of disabled people and CPU-constrained clients by offering senders a reasonable choice of different types of challenges.\", { \"#text\": \"Desktop clients running on modern PCs will typically be configured to automatically perform a specified 'SHA-256' Hashcash challenge (see below) whenever it is below a certain level of difficulty, with the result that many people may not even notice challenges most of the time. However, people using CPU-constrained clients (e.g. Web or mobile clients) would notice the performance hit. They might prefer to take a CAPTCHA challenge instead.\", \"note\": \"A CPU-constrained client could ask a faster computer (e.g., its server) to perform a Hashcash challenge for it.\" }, \"Visually disabled people using a CPU-constrained client could configure their client to always present them with an audio CAPTCHA challenge.\", \"Most of the challenges below are language sensitive. However, the evaluation of the OCR and Hashcash responses does not depend on the language the sender is using.\", { \"#text\": \"Challenge types are distinguished by the 'var' attribute of each \\u003cfield/\\u003e element. Several types of challenges are described below. More challenges MAY be documented elsewhere and registered with the XMPP Registrar (see\", \"link\": { \"#text\": \"Field Standardization\", \"-url\": \"#registrar-formtypes\" } } ] }, { \"-anchor\": \"challenge-hashcash\", \"-topic\": \"SHA-256 Hashcash\", \"code\": \"innocent@victim.com2450F06C173B05E3\", \"p\": [ { \"#text\": \"The SHA-256 Hashcash challenge is transparent to average PC users. It is indicated when the value of the 'var' attribute is 'SHA-256'. It forces clients to perform CPU-intensive work, making it difficult to send large amounts of abusive traffic. This significantly reduces abusive traffic, but alone it will not completely stop abusive stanzas from being sent through large collections of 'zombie' computers.\", \"note\": \"The hope is that the extra CPU usage will often be noticed by the owners of the zombie machines, who will be more likely to fix them.\" }, { \"#text\": \"The challenger MUST set the 'label' attribute of the \\u003cfield/\\u003e element to a hexadecimal random number containing a configured number of bits (e.g., 2\", \"span\": [ { \"#text\": \"20\", \"-class\": \"super\" }, { \"#text\": \"21\", \"-class\": \"super\" } ] }, { \"#text\": \"To pass the test, the sender MUST return a text string that starts with the JID the sender sent the first stanza to (i.e., the stanza that triggered the challenge). The least significant bits of the SHA-256 hash (see\", \"note\": { \"#text\": \"Secure Hash Standard: Federal Information Processing Standards Publication 180-2 \\u003c\", \"link\": { \"#text\": \"http://csrc.nist.gov/publications/fips/fips180-2/fips186-2withchangenotice.pdf\", \"-url\": \"http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"SHA\", \"-url\": \"http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf\" } } }, \"Note: When configuring the number of bits to be specified by a challenger in the 'label' attribute values, administrators MUST balance the need to make mass abuse as difficult as possible, with the inconvenience that may be caused to the users of less powerful computers. (Most clients will be challenged only very occasionally, so the consumption of 70% of a typical desktop CPU for 4 seconds might be considered appropriate.) Administrators SHOULD increment the configured number of bits from time to time to match increases in the performance of typical desktop PCs. If an administrator notices that abusive robots never attempt the Hashcash challenge, then he SHOULD consider reducing the number of bits, to avoid inconveniencing people unnecessarily.\" ] }, { \"-anchor\": \"challenge-captcha\", \"-topic\": \"CAPTCHAs\", \"p\": [ \"Note: It may be profitable to send abusive stanzas even if less than one percent of CAPTCHA responses are successful. The effectiveness of a CAPTCHA challenge needs to be close to perfect, unless it is used in combination with other anti-abuse techniques.\", { \"#text\": \"If a media type is specified (see table below) then the \\u003cfield/\\u003e element MUST contain a \\u003cmedia/\\u003e element that includes a \\u003curi/\\u003e element of that type. Clients that support the CAPTCHA type MUST be able to play or render the specified MIME-types (see table below). They MAY also support other formats.\", \"note\": \"Audio CAPTCHAs typically require challengers to provide at least the 'audio/x-wav' MIME-type (with the PCM codec) because more efficient patent-free formats are often not supported by constrained clients. It is RECOMMENDED that challengers provide more compact formats (like Ogg Speex or MP3) too.\" }, { \"#text\": \"The 'type' attribute of the \\u003cfield/\\u003e element SHOULD be 'text-single', 'text-private', or 'text-multi' (if no 'type' is specified, the default is 'text-single').\", \"note\": \"The 'boolean' and 'list-single' field types would make it trivial for a robot to provide a correct response at least some of the time.\" }, { \"#text\": \"* See the\", \"link\": { \"#text\": \"Internationalization Considerations\", \"-url\": \"#i18n\" } }, { \"#text\": \"** The image portrays random characters that humans can read but OCR software cannot.\", \"note\": { \"#text\": \"See PWNtcha \\u003c\", \"link\": { \"#text\": \"http://sam.zoy.org/pwntcha/\", \"-url\": \"http://sam.zoy.org/pwntcha/\" } } } ], \"table\": { \"-caption\": \"CAPTCHAs\", \"tr\": [ { \"th\": [ \"'var'\", \"Name\", \"Media type\", \"MIME-type\", \"Suggested generic instructions *\" ] }, { \"td\": [ \"audio_recog\", \"Audio Recognition\", \"audio\", \"audio/x-wav\", \"Describe the sound you hear\" ] }, { \"td\": [ \"ocr **\", \"Optical Character Recognition\", \"image\", \"image/jpeg\", \"Enter the text you see\" ] }, { \"td\": [ \"picture_q\", \"Picture Question\", \"image\", \"image/jpeg\", \"Answer the question you see\" ] }, { \"td\": [ \"picture_recog\", \"Picture Recognition\", \"image\", \"image/jpeg\", \"Identify the picture\" ] }, { \"td\": [ \"qa\", \"Text Question and Answer\", \"-\", \"-\", \"-\" ] }, { \"td\": [ \"speech_q\", \"Speech Question\", \"audio\", \"audio/x-wav\", \"Answer the question you hear\" ] }, { \"td\": [ \"speech_recog\", \"Speech Recognition\", \"audio\", \"audio/x-wav\", \"Enter the words you hear\" ] }, { \"td\": [ \"video_q\", \"Video Question\", \"video\", \"video/mpeg\", \"Answer the question in the video\" ] }, { \"td\": [ \"video_recog\", \"Video Recognition\", \"video\", \"video/mpeg\", \"Identify the video\" ] } ] } } ] }, { \"-anchor\": \"legacy\", \"-topic\": \"Question and Answer for Legacy Clients\", \"example\": [ { \"#text\": \"\\u003cmessage from='innocent@victim.com/pda'\\n to='robot@abuser.com/zombie'\\n xml:lang='en'\\n id='F3A6292C'\\u003e\\n \\u003cbody\\u003eYour messages to me are being blocked. To unblock them,\\n reply with the color of a stop light followed by 'F3A6292C'.\\u003c/body\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='sid'\\u003e\\u003cvalue\\u003espam1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield label='Type the color of a stop light' type='text-single' var='qa'/\\u003e\\n \\u003cfield label='93C7A' type='text-single' var='SHA-256'/\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Includes a Legacy Challenge\" }, { \"#text\": \"\\u003cmessage from='robot@abuser.com/zombie' to='innocent@victim.com/pda'\\u003e\\n \\u003cbody\\u003ered F3A6292C\\u003c/body\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Legacy Sender Responds\" }, { \"#text\": \"\\u003cmessage from='innocent@victim.com/pda' to='robot@abuser.com/zombie'\\u003e\\n \\u003cbody\\u003eYour message was delivered. Your messages\\n to me are no longer being blocked.\\u003c/body\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Tells Legacy Sender it Passed\" }, { \"#text\": \"\\u003cmessage type='error'\\n from='innocent@victim.com/pda'\\n to='robot@abuser.com/zombie'\\u003e\\n \\u003cerror type='cancel'\\u003e\\n \\u003cnot-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/\\u003e\\n \\u003ctext xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'\\u003e\\n Your message to me was not delivered.\\n \\u003c/text\\u003e\\n \\u003c/error\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Tells Legacy Sender it Failed\" } ], \"p\": [ { \"#text\": \"A challenger MAY provide a text question in the \\u003cbody/\\u003e element of a challenge stanza for clients that do not support CAPTCHA forms. Entities that cannot serve\", \"cite\": \"Out-of-Band Data\" }, \"Note: Robots always attempt the easiest challenge they are offered. So the question MUST be at least as difficult for a robot as the CAPTCHA form.\", \"Note: Even if it provides a text question in the \\u003cbody/\\u003e element, a challenger MUST always provide a CAPTCHA form.\", \"Legacy clients respond to the challenger using a \\u003cmessage/\\u003e stanza (not an \\u003ciq/\\u003e).\", \"The challenger SHOULD treat the stanza as a normal message (instead of as a response to its challenge) if the legacy client either takes too long to submit it or has already responded to the challenge. The challenger MAY treat the response as a normal message even in cases where the challenge became unnecessary while the challenger was waiting for the response.\", \"Otherwise the challenger MUST report the result of the challenge to the legacy client using a \\u003cmessage/\\u003e stanza (not an \\u003ciq/\\u003e).\" ] }, { \"-anchor\": \"stop\", \"-topic\": \"Discontinuation Policy\", \"p\": [ { \"#text\": \"It is RECOMMENDED that entities employ other techniques to combat abusive stanzas in addition to those described in this document (e.g., see\", \"cite\": \"XEP-0161\", \"note\": { \"#text\": \"XEP-0205: Best Practices to Discourage Denial of Service Attacks \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0205.html\", \"-url\": \"https://xmpp.org/extensions/xep-0205.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Best Practices to Discourage Denial of Service Attacks (XEP-0205)\", \"-url\": \"https://xmpp.org/extensions/xep-0205.html\" } } }, \"It is expected that this protocol will be an important and successful tool for discouraging abusive traffic. However, much of its success is dependent on the quality of the CAPTCHAs and other puzzles employed by a particular implementation.\", \"The administrator of an application that functions as a challenger SHOULD discontinue the use of CAPTCHA forms under the following circumstances:\" ], \"ul\": { \"li\": [ \"If he realises that the challenger's challenges are largely ineffective in combating abusive traffic, and that the reduction in abuse does not compensate for the inconvenience to humans of responding to the challenger's challenges.\", { \"#text\": \"If other,\", \"em\": \"more transparent\" }, \"If the challenger needs no protection at all because it receives only a negligible amount of abusive traffic.\" ] } }, { \"-anchor\": \"i18n\", \"-topic\": \"Internationalization Considerations\", \"p\": { \"#text\": \"Each form field SHOULD include a 'label' attribute. If the sender did not include an 'xml:lang' attribute, then the challenger may not know the correct language for the labels. Therefore, depending on user preferences, the client that receives a challenge MAY present generic but localized text instead of label text that would not be understood by the user. Suggested generic text (to be suitably localized) is provided by\", \"link\": [ { \"#text\": \"Table 1\", \"-url\": \"#table-1\" }, { \"#text\": \"CAPTCHAs\", \"-url\": \"#challenge-captcha\" } ] } }, { \"-anchor\": \"sec\", \"-topic\": \"Security Considerations\", \"p\": { \"#text\": \"The use of CAPTCHAs is not a panacea, and should be combined with other anti-abuse mechanisms, such as those described in\", \"cite\": [ \"XEP-0161\", \"XEP-0205\" ] } }, { \"-anchor\": \"iana\", \"-topic\": \"IANA Considerations\", \"p\": { \"#text\": \"This document requires no interaction with the\", \"note\": { \"#text\": \"The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see \\u003c\", \"link\": { \"#text\": \"http://www.iana.org/\", \"-url\": \"http://www.iana.org/\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Internet Assigned Numbers Authority (IANA)\", \"-url\": \"http://www.iana.org/\" } } } }, { \"-anchor\": \"registrar\", \"-topic\": \"XMPP Registrar Considerations\", \"section2\": [ { \"-anchor\": \"ns\", \"-topic\": \"Protocol Namespaces\", \"p\": { \"#text\": \"The\", \"link\": { \"#text\": \"https://xmpp.org/registrar/namespaces.html\", \"-url\": \"https://xmpp.org/registrar/namespaces.html\" }, \"note\": { \"#text\": \"The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/registrar/\", \"-url\": \"https://xmpp.org/registrar/\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"XMPP Registrar\", \"-url\": \"https://xmpp.org/registrar/\" } } } }, { \"-anchor\": \"registrar-formtypes\", \"-topic\": \"Field Standardization\", \"section3\": [ { \"-anchor\": \"registrar-formtypes-captcha\", \"-topic\": \"CAPTCHA FORM_TYPE\", \"code\": \"\\u003cform_type\\u003e\\n \\u003cname\\u003eurn:xmpp:captcha\\u003c/name\\u003e\\n \\u003cdoc\\u003eXEP-0158\\u003c/doc\\u003e\\n \\u003cdesc\\u003eForms enabling the use of CAPTCHAs.\\u003c/desc\\u003e\\n \\u003cfield\\n var='answers'\\n type='hidden'\\n label='number of answers required'/\\u003e\\n \\u003cfield\\n var='audio_recog'\\n type='text-single'\\n label='text associated with a sound'/\\u003e\\n \\u003cfield\\n var='challenge'\\n type='hidden'\\n label='challenge ID'/\\u003e\\n \\u003cfield\\n var='from'\\n type='hidden'\\n label='to attribute of stanza that triggered challenge'/\\u003e\\n \\u003cfield\\n var='ocr'\\n type='text-single'\\n label='code appearing in an image'/\\u003e\\n \\u003cfield\\n var='picture_q'\\n type='text-single'\\n label='answer associated with a picture'/\\u003e\\n \\u003cfield\\n var='picture_recog'\\n type='text-single'\\n label='text associated with a picture'/\\u003e\\n \\u003cfield\\n var='qa'\\n type='text-single'\\n label='answer to a question'/\\u003e\\n \\u003cfield\\n var='SHA-256'\\n type='text-single'\\n label='least significant bits of SHA-256 hash of text should equal hexadecimal label'/\\u003e\\n \\u003cfield\\n var='sid'\\n type='hidden'\\n label='stanza ID'/\\u003e\\n \\u003cfield\\n var='speech_q'\\n type='text-single'\\n label='answer associated with speech'/\\u003e\\n \\u003cfield\\n var='speech_recog'\\n type='text-single'\\n label='text associated with speech'/\\u003e\\n \\u003cfield\\n var='video_q'\\n type='text-single'\\n label='answer associated with a video'/\\u003e\\n \\u003cfield\\n var='video_recog'\\n type='text-single'\\n label='text associated with a video'/\\u003e\\n\\u003c/form_type\\u003e\", \"p\": { \"#text\": \"The\", \"cite\": \"XMPP Registrar\" } }, { \"-anchor\": \"registrar-formtypes-register\", \"-topic\": \"jabber:iq:register FORM_TYPE\", \"code\": \"\\u003cform_type\\u003e\\n \\u003cname\\u003ejabber:iq:register\\u003c/name\\u003e\\n \\u003cdoc\\u003eXEP-0077\\u003c/doc\\u003e\\n \\u003cfield\\n var='answers'\\n type='hidden'\\n label='number of answers required'/\\u003e\\n \\u003cfield\\n var='audio_recog'\\n type='text-single'\\n label='text associated with a sound'/\\u003e\\n \\u003cfield\\n var='challenge'\\n type='hidden'\\n label='challenge ID'/\\u003e\\n \\u003cfield\\n var='ocr'\\n type='text-single'\\n label='code appearing in an image'/\\u003e\\n \\u003cfield\\n var='picture_q'\\n type='text-single'\\n label='answer associated with a picture'/\\u003e\\n \\u003cfield\\n var='picture_recog'\\n type='text-single'\\n label='text associated with a picture'/\\u003e\\n \\u003cfield\\n var='qa'\\n type='text-single'\\n label='answer to a question'/\\u003e\\n \\u003cfield\\n var='SHA-256'\\n type='text-single'\\n label='least significant bits of SHA-256 hash of text should equal hexadecimal label'/\\u003e\\n \\u003cfield\\n var='sid'\\n type='hidden'\\n label='stanza ID'/\\u003e\\n \\u003cfield\\n var='speech_q'\\n type='text-single'\\n label='answer associated with speech'/\\u003e\\n \\u003cfield\\n var='speech_recog'\\n type='text-single'\\n label='text associated with speech'/\\u003e\\n \\u003cfield\\n var='video_q'\\n type='text-single'\\n label='answer associated with a video'/\\u003e\\n \\u003cfield\\n var='video_recog'\\n type='text-single'\\n label='text associated with a video'/\\u003e\\n\\u003c/form_type\\u003e\", \"p\": { \"#text\": \"The\", \"cite\": \"XMPP Registrar\" } } ] } ] }, { \"-anchor\": \"schema\", \"-topic\": \"XML Schema\", \"code\": \"\\u003c?xml version='1.0' encoding='UTF-8'?\\u003e\\n\\n\\u003cxs:schema\\n xmlns:xs='http://www.w3.org/2001/XMLSchema'\\n targetNamespace='urn:xmpp:captcha'\\n xmlns='urn:xmpp:captcha'\\n elementFormDefault='qualified'\\u003e\\n\\n \\u003cxs:annotation\\u003e\\n \\u003cxs:documentation\\u003e\\n The protocol documented by this schema is defined in\\n XEP-0158: http://xmpp.org/extensions/xep-0158.html\\n \\u003c/xs:documentation\\u003e\\n \\u003c/xs:annotation\\u003e\\n\\n \\u003cxs:import namespace='jabber:x:data'\\n schemaLocation='http://xmpp.org/schemas/x-data.xsd'/\\u003e\\n\\n \\u003cxs:element name='captcha'\\u003e\\n \\u003cxs:complexType\\u003e\\n \\u003cxs:sequence xmlns:xdata='jabber:x:data'\\u003e\\n \\u003cxs:element ref='xdata:x' minOccurs='1' maxOccurs='1'/\\u003e\\n \\u003c/xs:sequence\\u003e\\n \\u003c/xs:complexType\\u003e\\n \\u003c/xs:element\\u003e\\n\\n\\u003c/xs:schema\\u003e\" }, { \"-anchor\": \"open\", \"-topic\": \"Open Issues\", \"p\": \"Another protocol could allow users to edit the challenges their server will make on their behalf. For example, the number of SHA-256 bits, a personal or original question and answer, a picture, a video, or a sound recording. Of course Aunt Tillie would typically use this feature only if she was plagued by abusive traffic.\" } ] } planned xep-0374: { \"-xmlns\": \"\", \"header\": { \"abstract\": \"Specifies a OpenPGP for XMPP (XEP-0373) profile for the Instant\\n Messaging (IM) use case.\", \"approver\": \"Council\", \"author\": [ { \"email\": \"flo@geekplace.eu\", \"firstname\": \"Florian\", \"jid\": \"flo@geekplace.eu\", \"surname\": \"Schmaus\" }, { \"email\": \"dominik@dominikschuermann.de\", \"firstname\": \"Dominik\", \"jid\": \"dominik@dominikschuermann.de\", \"surname\": \"Schürmann\" }, { \"email\": \"look@my.amazin.horse\", \"firstname\": \"Vincent\", \"jid\": \"valodim@stratum0.org\", \"surname\": \"Breitmoser\" } ], \"dependencies\": { \"spec\": [ \"XMPP Core\", \"XEP-0030\", \"XEP-0373\" ] }, \"legal\": { \"conformance\": { \"#text\": \"This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/about/xsf/ipr-policy\", \"-url\": \"https://xmpp.org/about/xsf/ipr-policy\" } }, \"copyright\": { \"#text\": \"This XMPP Extension Protocol is copyright © 1999 – 2024 by the\", \"link\": { \"#text\": \"XMPP Standards Foundation\", \"-url\": \"https://xmpp.org/\" } }, \"liability\": \"In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.\", \"permissions\": \"Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \\\"Specification\\\"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.\", \"warranty\": \"## NOTE WELL: This Specification is provided on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##\" }, \"number\": \"0374\", \"revision\": [ { \"date\": \"2018-01-25\", \"initials\": \"XEP Editor (jwi)\", \"remark\": \"Defer due to lack of activity.\", \"version\": \"0.2.0\" }, { \"date\": \"2017-01-20\", \"initials\": \"fs\", \"remark\": { \"p\": \"Make use of XEP-0380: Explicit Message Encryption.\" }, \"version\": \"0.1.2\" }, { \"date\": \"2016-06-04\", \"initials\": \"fs\", \"remark\": { \"p\": \"Minior editorial fixes.\" }, \"version\": \"0.1.1\" }, { \"date\": \"2016-05-10\", \"initials\": \"XEP Editor (ssw)\", \"remark\": { \"p\": \"Initial published version approved by the XMPP Council.\" }, \"version\": \"0.1\" }, { \"date\": \"2016-03-25\", \"initials\": \"fs\", \"remark\": { \"p\": \"First draft.\" }, \"version\": \"0.0.1\" } ], \"shortname\": \"oxim\", \"sig\": \"Standards\", \"status\": \"Deferred\", \"supersededby\": \"\", \"supersedes\": \"\", \"title\": \"OpenPGP for XMPP Instant Messaging\", \"type\": \"Standards Track\" }, \"section1\": [ { \"-anchor\": \"intro\", \"-topic\": \"Introduction\", \"p\": [ { \"#text\": \"This XMPP extension protocol specifies a profile of\", \"note\": { \"#text\": \"XEP-0373: OpenPGP for XMPP \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0373.html\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"OpenPGP for XMPP (XEP-0373)\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html\" } } }, { \"#text\": \"Unlike similar XEPs, e.g.,\", \"em\": \"does not\", \"note\": { \"#text\": \"XEP-0384: OMEMO Encryption \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0384.html\", \"-url\": \"https://xmpp.org/extensions/xep-0384.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"OMEMO Encryption (XEP-0384)\", \"-url\": \"https://xmpp.org/extensions/xep-0384.html\" } } } ] }, { \"-anchor\": \"ox-im-profile\", \"-topic\": \"OX Instant Messaging Profile\", \"section2\": [ { \"-anchor\": \"disco\", \"-topic\": \"Discovering Support\", \"example\": [ { \"#text\": \"\\u003ciq type='get'\\n from='juliet@example.org/balcony'\\n to='romeo@example.org/orchard'\\n id='disco1'\\u003e\\n \\u003cquery xmlns='http://jabber.org/protocol/disco#info'/\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Service Discovery information request\" }, { \"#text\": \"\\u003ciq type='result'\\n from='romeo@example.org/orchard'\\n to='juliet@example.org/balcony'\\n id='disco1'\\u003e\\n \\u003cquery xmlns='http://jabber.org/protocol/disco#info'\\u003e\\n ...\\n \\u003cfeature var='urn:xmpp:openpgp:im:0'/\\u003e\\n ...\\n \\u003c/query\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Service Discovery information response\" } ], \"p\": [ { \"#text\": \"If an entity supports exchanging OpenPGP encrypted and signed\\n instant messages over XMPP, i.e., what is specified herein, it MUST\\n advertise that fact by announcing a\", \"note\": { \"#text\": \"XEP-0030: Service Discovery \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0030.html\", \"-url\": \"https://xmpp.org/extensions/xep-0030.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Service Discovery (XEP-0030)\", \"-url\": \"https://xmpp.org/extensions/xep-0030.html\" } } }, \"Because of possible downgrade attacks, users should be given an\\n option to force the usage of the protocol defined herein no matter\\n if the remote announces support or not.\" ] }, { \"-anchor\": \"openpgp-secured-im\", \"-topic\": \"OpenPGP Secured Instant Messaging\", \"p\": [ { \"#text\": \"In order to establish an OpenPGP secured IM communication, IM\\n clients first need to determine the public key of their\\n interlocutor(s). OpenPGP historically provides public keyservers\\n which can be used for key retrieval. Additional there are methods\\n to store OpenPGP key information in the Domain Name\\n System (DNS). This specification does not restrict the mechanism\\n of key discovery and retrieval, but compliant clients MUST support\\n the public key announcement as described in\", \"cite\": \"XEP-0373\", \"link\": { \"#text\": \"§ 4\", \"-url\": \"./xep-0373.html#announcing-discover-pubkey\" } }, { \"#text\": \"After the required public keys have been discovered, XMPP\\n clients engage in an OpenPGP secured IM\\n conversation by exchanging \\u003copenpgp/\\u003e extension elements. They MUST\\n use the \\u003csigncrypt/\\u003e OpenPGP content element specified in\", \"cite\": \"XEP-0373\", \"link\": { \"#text\": \"§ 3.1\", \"-url\": \"./xep-0373.html#exchange\" } }, \"The child elements of the OpenPGP content element's \\u003cpayload/\\u003e\\n can be seen as stanza extension elements which are encrypted and\\n signed. After the \\u003copenpgp/\\u003e element and the including \\u003csigncrypt/\\u003e,\\n element was verified, they SHOULD be processed similar as if they\\n had been direct extension elements of the stanza. For example,\\n direct child elements found in \\u003cpayload/\\u003e in the context of IM\\n could be:\", \"But just as with stanza extension elements, child elements of\\n \\u003cpayload/\\u003e can be any extension element. The example above uses\\n the \\u003cbody/\\u003e element as defined in RFC 6121. Note that it\\n uses 'jabber:client' as namespace, but since the same\\n \\u003cbody/\\u003e element is also defined in the 'jabber:server'\\n namespace, recipients MUST accept both.\" ], \"ul\": { \"li\": [ { \"#text\": \"Message bodies (\", \"note\": { \"#text\": \"RFC 6121: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence \\u003c\", \"link\": { \"#text\": \"http://tools.ietf.org/html/rfc6121\", \"-url\": \"http://tools.ietf.org/html/rfc6121\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"RFC 6121\", \"-url\": \"http://tools.ietf.org/html/rfc6121\" } } }, { \"#text\": \": \\u003cactive xmlns='http://jabber.org/protocol/chatstates'/\\u003e\", \"note\": { \"#text\": \"XEP-0085: Chat State Notifications \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0085.html\", \"-url\": \"https://xmpp.org/extensions/xep-0085.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Chat State Notifications (XEP-0085)\", \"-url\": \"https://xmpp.org/extensions/xep-0085.html\" } } }, { \"#text\": \": \\u003chtml xmlns='http://jabber.org/protocol/xhtml-im'/\\u003e\", \"note\": { \"#text\": \"XEP-0071: XHTML-IM \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0071.html\", \"-url\": \"https://xmpp.org/extensions/xep-0071.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"XHTML-IM (XEP-0071)\", \"-url\": \"https://xmpp.org/extensions/xep-0071.html\" } } } ] } }, { \"-anchor\": \"openpgp-key-handling\", \"-topic\": \"OpenPGP Key Handling\", \"section3\": [ { \"-anchor\": \"choose-pubkey\", \"-topic\": \"Choosing Public Keys\", \"p\": \"Clients MUST expect multiple public keys to be announced for a single remote entity. In this case all keys MUST be used for encryption.\" }, { \"-anchor\": \"openpgp-secret-key-sync\", \"-topic\": \"OpenPGP Secret Key Synchronization\", \"p\": { \"#text\": \"Clients MAY want to use the mechanism in\", \"cite\": \"XEP-0373 § 5\" } } ] } ] }, { \"-anchor\": \"rules\", \"-topic\": \"Business Rules\", \"section2\": [ { \"-anchor\": \"signcrypt-im-use-case\", \"-topic\": \"Always Use \\u003csigncrypt/\\u003e\", \"p\": \"Only \\u003csigncrypt/\\u003e MUST be used for the IM\\n use case. Encrypted but unsigned messages (\\u003ccrypt/\\u003e) do not provide\\n an advantage over unencrypted ones since the sender can not be\\n verified. As result of this rule, the user interface of\\n IM clients implementing the protocol defined herein MUST NOT\\n provide an option for the user to select between sign+crypt, sign\\n or crypt. This also increases the usability.\" }, { \"-anchor\": \"hint-im-use-case\", \"-topic\": \"Provide Hints\", \"example\": { \"#text\": \"\\u003cmessage to='juliet@example.org'\\u003e\\n \\u003cbody\\u003eThis message is encrypted using OpenPGP.\\u003c/body\\u003e\\n \\u003cstore xmlns='urn:xmpp:hints'/\\u003e\\n \\u003cencryption xmlns='urn:xmpp:eme:0' namespace='urn:xmpp:openpgp:0'/\\u003e\\n \\u003copenpgp xmlns='urn:xmpp:openpgp:0'\\u003e\\n BASE64_OPENPGP_MESSAGE_CONTAINING_CONTENT_ELEMENT\\n \\u003c/openpgp\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"An encrypted and signed message with hints.\" }, \"p\": { \"#text\": \"In the IM use case every \\u003cmessage/\\u003e equipped with \\u003copenpgp/\\u003e\\n SHOULD include an unencrypted \\u003cbody/\\u003e explaining that the actual\\n message is encrypted. Furthermore the message SHOULD contain a\\n 'store' hint as defined in\", \"link\": { \"#text\": \"§\\n 4.4\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html#sect-idp1502160\" }, \"note\": [ { \"#text\": \"XEP-0334: Message Processing Hints \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0334.html\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html\" } }, { \"#text\": \"XEP-0380: Explicit Message Encryption \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0380.html\", \"-url\": \"https://xmpp.org/extensions/xep-0380.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"Message Processing Hints (XEP-0334)\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Explicit Message Encryption (XEP-0380)\", \"-url\": \"https://xmpp.org/extensions/xep-0380.html\" } } ] } } ] }, { \"-anchor\": \"iana\", \"-topic\": \"IANA Considerations\", \"p\": { \"#text\": \"This document requires no interaction with the\", \"note\": { \"#text\": \"The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see \\u003c\", \"link\": { \"#text\": \"http://www.iana.org/\", \"-url\": \"http://www.iana.org/\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Internet Assigned Numbers Authority (IANA)\", \"-url\": \"http://www.iana.org/\" } } } }, { \"-anchor\": \"registrar\", \"-topic\": \"XMPP Registrar Considerations\", \"section2\": { \"-anchor\": \"registrar-ns\", \"-topic\": \"Protocol Namespaces\", \"p\": { \"#text\": \"The\", \"link\": { \"#text\": \"https://xmpp.org/registrar/namespaces.html\", \"-url\": \"https://xmpp.org/registrar/namespaces.html\" }, \"note\": { \"#text\": \"The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/registrar/\", \"-url\": \"https://xmpp.org/registrar/\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"XMPP Registrar\", \"-url\": \"https://xmpp.org/registrar/\" } } } } }, { \"-anchor\": \"schema\", \"-topic\": \"XML Schema\", \"p\": { \"#text\": \"This XEP does not define a Schema, since it exclusively uses elements from\", \"cite\": \"XEP-0373\" } }, { \"-anchor\": \"acknowledgements\", \"-topic\": \"Acknowledgements\", \"p\": { \"#text\": \"Please refer to the\", \"cite\": \"XEP-0373\", \"link\": { \"#text\": \"Acknowledgements section\", \"-url\": \"./xep-0373.html#acknowledgements\" } } } ] } planned xep-0386: { \"-xmlns\": \"\", \"header\": { \"abstract\": \"This specification provides a single-request replacement for several activities an XMPP client needs to do at startup.\", \"approver\": \"Council\", \"author\": [ { \"email\": \"kevin.smith@isode.com\", \"firstname\": \"Kevin\", \"jid\": \"kevin.smith@isode.com\", \"surname\": \"Smith\" }, { \"email\": \"mwild1@gmail.com\", \"firstname\": \"Matthew\", \"jid\": \"me@matthewwild.co.uk\", \"surname\": \"Wild\" } ], \"dependencies\": { \"spec\": [ \"XMPP Core\", \"XMPP IM\", \"XEP-0313\", \"XEP-0280\" ] }, \"lastcall\": \"2024-04-01\", \"legal\": { \"conformance\": { \"#text\": \"This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/about/xsf/ipr-policy\", \"-url\": \"https://xmpp.org/about/xsf/ipr-policy\" } }, \"copyright\": { \"#text\": \"This XMPP Extension Protocol is copyright © 1999 – 2024 by the\", \"link\": { \"#text\": \"XMPP Standards Foundation\", \"-url\": \"https://xmpp.org/\" } }, \"liability\": \"In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.\", \"permissions\": \"Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \\\"Specification\\\"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.\", \"warranty\": \"## NOTE WELL: This Specification is provided on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##\" }, \"number\": \"0386\", \"revision\": [ { \"date\": \"2024-07-02\", \"initials\": \"egp\", \"remark\": { \"p\": \"Add an XML Schema.\" }, \"version\": \"1.0.1\" }, { \"date\": \"2024-04-04\", \"initials\": \"XEP Editor (dg)\", \"remark\": \"Accept as Stable as per Council Vote from 2024-04-02.\", \"version\": \"1.0.0\" }, { \"date\": \"2022-10-07\", \"initials\": \"mw\", \"remark\": { \"p\": [ \"Various changes, made in parallel with working client and server implementation experience, and SASL2 updates.\", \"More tightly define the integration with XEP-0388 and several session feature XEPs: XEP-0198, XEP-0280, XEP-0352.\", \"Replace the custom latest-id element with the new metadata element from XEP-0313, which also provides richer information.\", \"Drop unread tracking, as this is a deep topic not directly related to resource binding. Instead the details of integration with other extensions have been better defined and demonstrated, to allow such functionality when it is fully defined and exists.\", \"Adjust proposed namespace on aesthetic grounds and consistency with SASL2's approach. As this protocol may become part of the new preferred connection flow for a long time to come, it makes no sense to include the redundant and potentially confusing '2' when there is no conflict without it. Similarly, the '.0' has been dropped from the XEP's title, as it isn't really a version number.\", \"Allow the client some influence over the resulting resource identifier, and define a standard format for these combined identifiers.\", \"Specify that servers should terminate old sessions from a client when it binds a new resource.\" ] }, \"version\": \"0.4.0\" }, { \"date\": \"2019-01-31\", \"initials\": \"kis\", \"remark\": \"Begrudingly allow non-unread-tracking servers, mention SASL2.\", \"version\": \"0.3.0\" }, { \"date\": \"2018-02-08\", \"initials\": \"XEP Editor (jc)\", \"remark\": \"Defer due to lack of activity.\", \"version\": \"0.2.0\" }, { \"date\": \"2017-02-08\", \"initials\": \"XEP Editor: ssw\", \"remark\": { \"p\": \"First draft accepted by the XMPP Council.\" }, \"version\": \"0.1.0\" } ], \"shortname\": \"bind2\", \"sig\": \"Standards\", \"status\": \"Draft\", \"supersededby\": \"\", \"supersedes\": \"\", \"title\": \"Bind 2\", \"type\": \"Standards Track\" }, \"section1\": [ { \"-anchor\": \"intro\", \"-topic\": \"Introduction\", \"p\": [ { \"#text\": \"Every session on XMPP generally has a unique routable identifier, known as a \\\"resource\\\". Many details and rules about resources in XMPP can be found in\", \"note\": [ { \"#text\": \"RFC 6120: Extensible Messaging and Presence Protocol (XMPP): Core \\u003c\", \"link\": { \"#text\": \"http://tools.ietf.org/html/rfc6120\", \"-url\": \"http://tools.ietf.org/html/rfc6120\" } }, { \"#text\": \"XEP-0388: Extensible SASL Profile \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0388.html\", \"-url\": \"https://xmpp.org/extensions/xep-0388.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"RFC 6120\", \"-url\": \"http://tools.ietf.org/html/rfc6120\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Extensible SASL Profile (XEP-0388)\", \"-url\": \"https://xmpp.org/extensions/xep-0388.html\" } } ] }, \"As XMPP has grown more feature-rich over time, more steps have been introduced that clients are likely to perform at startup, e.g. resource binding, archive synchronisation, enabling Carbons. Some of these introduce race conditions - e.g. if a client synchronises the archive before enabling Carbons, it can miss stanzas sent between these events, or if it enables Carbons before synchronising the archive it can receive duplicate messages. It may also cause duplicate messages by combining archive synchronisation and receipt of offline messages, or by receipt of messages addressed to the full JID between resource binding and archive synchronisation. Therefore, this document provides a mechanism for atomically performing these operations to avoid these race conditions. It also allows the server to provide information to a client that is generally useful about the state of the user's account.\" ] }, { \"-anchor\": \"reqs\", \"-topic\": \"Requirements\", \"ul\": { \"li\": [ { \"#text\": \"Reduce round-trips and race conditions by providing a single atomic session establishment operation, with support for common session features such as\", \"note\": [ { \"#text\": \"XEP-0280: Message Carbons \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0280.html\", \"-url\": \"https://xmpp.org/extensions/xep-0280.html\" } }, { \"#text\": \"XEP-0313: Message Archive Management \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0313.html\", \"-url\": \"https://xmpp.org/extensions/xep-0313.html\" } }, { \"#text\": \"XEP-0198: Stream Management \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0198.html\", \"-url\": \"https://xmpp.org/extensions/xep-0198.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"Message Carbons (XEP-0280)\", \"-url\": \"https://xmpp.org/extensions/xep-0280.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Message Archive Management (XEP-0313)\", \"-url\": \"https://xmpp.org/extensions/xep-0313.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Stream Management (XEP-0198)\", \"-url\": \"https://xmpp.org/extensions/xep-0198.html\" } } ] }, \"Integrate with SASL2 (XEP-0388) for further round-trip reduction and simpler session establishment.\" ] } }, { \"-anchor\": \"usecases\", \"-topic\": \"Use Cases\", \"section2\": [ { \"-topic\": \"Discovering support\", \"example\": { \"#text\": \"\\u003cstream:features\\u003e\\n \\u003cauthentication xmlns='urn:xmpp:sasl:2'\\u003e\\n \\u003cmechanism\\u003eSCRAM-SHA-1\\u003c/mechanism\\u003e\\n \\u003cmechanism\\u003eSCRAM-SHA-1-PLUS\\u003c/mechanism\\u003e\\n \\u003cinline\\u003e\\n \\u003cbind xmlns='urn:xmpp:bind:0'\\u003e\\n \\u003cinline\\u003e\\n \\u003cfeature var=\\\"urn:xmpp:carbons:2\\\" /\\u003e\\n \\u003cfeature var=\\\"urn:xmpp:csi:0\\\" /\\u003e\\n \\u003cfeature var=\\\"urn:xmpp:sm:3\\\" /\\u003e\\n \\u003c/inline\\u003e\\n \\u003c/bind\\u003e\\n \\u003csm xmlns='urn:xmpp:sm:3'/\\u003e\\n \\u003c/inline\\u003e\\n \\u003c/authentication\\u003e\\n\\u003c/stream:features\\u003e\", \"-caption\": \"Server advertises support in stream features\" }, \"p\": [ \"If a server supports Bind 2, it MUST advertise this within the SASL2 \\u003cinline/\\u003e element in the stream features, with a feature named 'bind' in the namespace 'urn:xmpp:bind:0'.\", \"Clients do not advertise support for Bind 2.\", \"Bind 2 supports inline negotiation of certain features specific to a session. The features supported by the server for such inline negotiation MUST be included in an \\u003cinline/\\u003e child element within the bind feature element. Each feature is listed as a \\u003cfeature/\\u003e child element with a 'var' attribute indicating the extension's defined service discovery feature name or namespace.\", \"Bind 2 is never supported without SASL2, and so servers without support for SASL2 MUST NOT advertise the feature. Servers supporting SASL2 and Bind 2 may continue to offer legacy resource binding to clients.\" ] }, { \"-anchor\": \"bind-request\", \"-topic\": \"Performing the bind\", \"example\": [ { \"#text\": \"\\u003cauthenticate xmlns='urn:xmpp:sasl:2' mechanism='SCRAM-SHA-1'\\u003e\\n \\u003cinitial-response\\u003e[base64 encoded SASL data]\\u003c/initial-response\\u003e\\n \\u003cbind xmlns='urn:xmpp:bind:0'\\u003e\\n \\u003ctag\\u003eAwesomeXMPP\\u003c/tag\\u003e\\n \\u003c/bind\\u003e\\n\\u003c/authenticate\\u003e\", \"-caption\": \"Client provides a resource bind request\" }, { \"#text\": \"\\u003cauthenticate xmlns='urn:xmpp:sasl:2' mechanism='SCRAM-SHA-1'\\u003e\\n \\u003cinitial-response\\u003e[base64 encoded SASL data]\\u003c/initial-response\\u003e\\n \\u003cbind xmlns='urn:xmpp:bind:0'\\u003e\\n \\u003ctag\\u003eAwesomeXMPP\\u003c/tag\\u003e\\n \\u003cenable xmlns='urn:xmpp:carbons:2'/\\u003e\\n \\u003cenable xmlns='urn:xmpp:sm:3'/\\u003e\\n \\u003cinactive xmlns='urn:xmpp:csi:0'/\\u003e\\n \\u003c/bind\\u003e\\n\\u003c/authenticate\\u003e\", \"-caption\": \"Client provides a resource bind request, additionally requesting some session features\" }, { \"#text\": \"\\u003csuccess xmlns='urn:xmpp:sasl:2'\\u003e\\n \\u003cauthorization-identity\\u003euser@example.com/AwesomeXMPP.4232f4d4\\u003c/authorization-identity\\u003e\\n \\u003cbound xmlns='urn:xmpp:bind:0'\\u003e\\n \\u003cmetadata xmlns='urn:xmpp:mam:2'\\u003e\\n \\u003cstart id='YWxwaGEg' timestamp='2008-08-22T21:09:04Z' /\\u003e\\n \\u003cend id='b21lZ2Eg' timestamp='2020-04-20T14:34:21Z' /\\u003e\\n \\u003c/metadata\\u003e\\n \\u003c/bound\\u003e\\n\\u003c/success\\u003e\", \"-caption\": \"Server responds after processing the bind\" } ], \"p\": [ \"To request resource binding, the client MUST include a \\u003cbind/\\u003e element, qualified by the 'urn:xmpp:bind:0' namespace, in its SASL2 \\u003cauthenticate/\\u003e request.\", \"The \\u003cbind/\\u003e element MAY contain the following child elements:\", \"Additionally, the \\u003cbind/\\u003e element MAY contain one or more child elements in other namespaces, representing features that the client requests to be automatically enabled for its new session.\", \"If the client included a \\u003cbind/\\u003e element in its SASL2 \\u003cauthenticate/\\u003e then the server MUST process the bind request after authentication is successful (including any necessary subsequent SASL2 tasks), but before sending the \\u003csuccess/\\u003e response. Following the usual rules of SASL2, the bind request MUST NOT be processed (i.e. it should be ignored) if the authentication is not successful.\", { \"#text\": \"Note: If the client included a \\u003cresume/\\u003e element in its SASL2 negotiation, that MUST be processed first by the server. If that resumption is successful, the server MUST skip resource binding (a resumed session already has a resource bound) and MUST entirely ignore the \\u003cbind/\\u003e request. If resumption of the previous stream fails, the server MUST include the XEP-0198 failure in the response, and then MUST proceed to process the bind request to establish a new session for the client.\", \"-class\": \"box\" }, \"Upon processing the bind request, the server MUST perform several operations, including:\", \"Upon successful binding of a resource, the server SHOULD terminate any earlier sessions from the same client (identified by the \\u003cuser-agent\\u003e 'id' attribute in its SASL2 authentication request).\", \"After processing the bind request as described above, the server MUST respond with the SASL \\u003csuccess/\\u003e element, including the client's full JID in the \\u003cauthorization-identity/\\u003e element, and a \\u003cbound/\\u003e element qualified by the 'urn:xmpp:bind:0' namespace, as in the following example:\", \"The server SHOULD include a \\u003cmetadata/\\u003e element as defined by XEP-0313, describing the state of the user's message archive at the precise time of resource binding. This helps the client determine what queries it may need to perform to synchronise messages.\", \"Interactions with certain other extensions are hereby defined in this document:\", \"The \\u003cbound/\\u003e response MUST also contain any defined responses to other enabled features, if any, though details of these are beyond the scope of this specification.\" ], \"section3\": { \"-anchor\": \"identifiers\", \"-topic\": \"Resource identifier generation\", \"p\": [ { \"#text\": \"If the client provided a \\u003ctag/\\u003e element in its bind request, the text content of that element SHOULD be included as-is in the final resource identifier, subject to the necessary validation for resource identifiers. This tag can help with client identification and debugging. The RECOMMENDED format is to include the client tag as a prefix of the server-generated identifier, separated by a single '/' character:\", \"tt\": [ \"[client tag]/[server generated identifier]\", \"AwesomeXMPP/rQ7Lwut0CcxW6\" ] }, \"Servers MAY choose to assign stable resource identifiers to clients, i.e. ensuring the same client will receive the same resource identifier for every bind request it makes. If a server or deployment provides resource identifier stability, the generated identifier SHOULD remain stable for every bind request with the same \\u003ctag/\\u003e and SASL2 \\u003cuser-agent\\u003e id. The SASL2 \\u003cuser-agent\\u003e id itself MUST NOT be exposed by the server in the generated resource identifier.\" ] }, \"ul\": [ { \"li\": { \"#text\": \"\\u003ctag/\\u003e: This element contains a short text string that typically identifies the software the user is using, mostly useful for diagnostic purposes for users, operators and developers. This tag may be visible to other entities on the XMPP network (see\", \"link\": { \"#text\": \"Security Considerations\", \"-url\": \"#security\" } } }, { \"li\": [ \"Clear the offline messages for this user, if any, without sending them (as they will be provided by MAM).\", \"Generate a resource identifier (per the rules below) and bind it to the current stream\", \"Get the archive id of the newest stanza in the user's MAM archive\", \"Enable any additional features requested by the client for this session\" ] }, { \"li\": [ \"If the client included a XEP-0198 \\u003cenable/\\u003e element in the requested features, Stream Management should be enabled at this point. The \\u003cbound/\\u003e response MUST contain the resulting XEP-0198 \\u003cenabled/\\u003e (or \\u003cfailed/\\u003e) element. For full business rules, syntax and examples, see XEP-0198.\", \"If the client included a XEP-0280 \\u003cenable/\\u003e element in the requested features, Message Carbons MUST be enabled at this point. As this operation MUST succeed, no response is necessary.\", \"If the client included a XEP-0352 \\u003cactive/\\u003e or \\u003cinactive/\\u003e element, the session must begin in that state.\" ] } ] } ] }, { \"-anchor\": \"security\", \"-topic\": \"Security Considerations\", \"p\": [ \"This specification mostly combines existing protocols together. Security considerations defined in those XEPs should be heeded as normal.\", \"The additional facility provided here to provide information on the user's archive is provided post-authentication and is only providing the user's data to the user.\", \"Implementations must adhere to the security considerations defined in XEP-0388 regarding the inclusion of SASL2 requests and inline feature negotiation in TLS 0-RTT (\\\"early data\\\") extensions. That is, they MUST NOT be sent or processed, except when appropriate mitigations are in place (which are beyond the scope of this document, but may be defined by others).\", \"As it forms part of the resource identifier and therefore the full JID of the session, the 'tag' value provided by the client (if any), may be visible to other XMPP entities on the network that the client communicates with or that have access to the user's presence. The simple name of the client can provide value to users, operators and developers diagnosing issues, and it generally will not reveal more information than would be already available through service discovery. Unless they are operating in fully trusted environments, clients MUST NOT use identifiers that might reveal private information about a user or their system (such as hostnames).\" ] }, { \"-anchor\": \"iana\", \"-topic\": \"IANA Considerations\", \"p\": \"None.\" }, { \"-anchor\": \"registrar\", \"-topic\": \"XMPP Registrar Considerations\", \"p\": \"The urn:xmpp:bind:0 namespace must be registered..\" }, { \"-anchor\": \"schema\", \"-topic\": \"XML Schema\", \"code\": \"\\u003c?xml version='1.0' encoding='UTF-8'?\\u003e\\n\\n\\u003cxs:schema\\n xmlns:xs='http://www.w3.org/2001/XMLSchema'\\n xmlns:mam='urn:xmpp:mam:2'\\n xmlns='urn:xmpp:bind:0'\\n targetNamespace='urn:xmpp:bind:0'\\n elementFormDefault='qualified'\\u003e\\n\\n \\u003cxs:annotation\\u003e\\n \\u003cxs:documentation\\u003e\\n The protocol documented by this schema is defined in\\n XEP-0386: https://xmpp.org/extensions/xep-0386.html\\n \\u003c/xs:documentation\\u003e\\n \\u003c/xs:annotation\\u003e\\n\\n \\u003cxs:import namespace='urn:xmpp:mam:2'\\n schemaLocation='xep-0313.xsd'/\\u003e\\n\\n \\u003cxs:element name='bind'\\u003e\\n \\u003cxs:complexType\\u003e\\n \\u003cxs:choice\\u003e\\n \\u003cxs:element ref='inline'/\\u003e\\n \\u003cxs:sequence\\u003e\\n \\u003cxs:element ref='tag' minOccurs='0'/\\u003e\\n \\u003cxs:any namespace='##other' minOccurs='0' maxOccurs='unbounded' processContents='lax'/\\u003e\\n \\u003c/xs:sequence\\u003e\\n \\u003c/xs:choice\\u003e\\n \\u003c/xs:complexType\\u003e\\n \\u003c/xs:element\\u003e\\n\\n \\u003cxs:element name='inline'\\u003e\\n \\u003cxs:complexType\\u003e\\n \\u003cxs:sequence\\u003e\\n \\u003cxs:element ref='feature' maxOccurs='unbounded'/\\u003e\\n \\u003c/xs:sequence\\u003e\\n \\u003c/xs:complexType\\u003e\\n \\u003c/xs:element\\u003e\\n\\n \\u003cxs:element name='feature'\\u003e\\n \\u003cxs:complexType\\u003e\\n \\u003cxs:attribute name='var' type='xs:string'/\\u003e\\n \\u003c/xs:complexType\\u003e\\n \\u003c/xs:element\\u003e\\n\\n \\u003cxs:element name='tag' type='xs:string'/\\u003e\\n\\n \\u003cxs:element name='bound'\\u003e\\n \\u003cxs:complexType\\u003e\\n \\u003cxs:sequence\\u003e\\n \\u003cxs:element ref='mam:metadata' minOccurs='0'/\\u003e\\n \\u003c/xs:sequence\\u003e\\n \\u003c/xs:complexType\\u003e\\n \\u003c/xs:element\\u003e\\n\\n\\u003c/xs:schema\\u003e\" }, { \"-anchor\": \"acknowledgements\", \"-topic\": \"Acknowledgements\", \"p\": \"Thanks to Daniel Gultsch, Philipp Hörist, Thilo Molitor and Andrzej Wójcik for their valuable support with feedback, suggestions and implementations.\" } ] } XEP-0386: Bind 2.0 planned xep-0420: { \"-xmlns\": \"\", \"header\": { \"abstract\": \"The Stanza Content Encryption (SCE) protocol is intended as a way to allow clients to securely exchange arbitrary extension elements using different end-to-end encryption schemes.\", \"approver\": \"Council\", \"author\": { \"email\": \"vanitasvitae@riseup.net\", \"firstname\": \"Paul\", \"jid\": \"vanitasvitae@jabberhead.tk\", \"surname\": \"Schaub\" }, \"dependencies\": { \"spec\": [ \"XMPP Core\", \"XEP-0001\", \"Etc.\" ] }, \"legal\": { \"conformance\": { \"#text\": \"This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/about/xsf/ipr-policy\", \"-url\": \"https://xmpp.org/about/xsf/ipr-policy\" } }, \"copyright\": { \"#text\": \"This XMPP Extension Protocol is copyright © 1999 – 2024 by the\", \"link\": { \"#text\": \"XMPP Standards Foundation\", \"-url\": \"https://xmpp.org/\" } }, \"liability\": \"In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.\", \"permissions\": \"Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \\\"Specification\\\"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.\", \"warranty\": \"## NOTE WELL: This Specification is provided on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##\" }, \"number\": \"0420\", \"revision\": [ { \"date\": \"2021-11-18\", \"initials\": \"melvo\", \"remark\": { \"p\": \"Clarify bare JID usage and improve sentences:\", \"ul\": { \"li\": [ \"Clarify usage of bare JIDs for affix elements\", \"Improve and correct sentences about affix elements\" ] } }, \"version\": \"0.4.1\" }, { \"date\": \"2021-04-07\", \"initials\": \"melvo\", \"remark\": { \"p\": [ \"Use 'envelope' and 'content' consistently by renaming elements\", { \"#text\": \"Update namespace to\", \"tt\": \"urn:xmpp:sce:1\" } ] }, \"version\": \"0.4.0\" }, { \"date\": \"2021-03-04\", \"initials\": \"mw\", \"remark\": { \"p\": \"Cross-document editorial adjustments for inclusive language.\" }, \"version\": \"0.3.2\" }, { \"date\": \"2020-11-03\", \"initials\": \"melvo\", \"remark\": { \"p\": \"Fix misspelling of 'whose'\" }, \"version\": \"0.3.1\" }, { \"date\": \"2020-07-03\", \"initials\": \"ps\", \"remark\": { \"p\": [ \"Allow origin-id elements, disallow stanza-id and extended stanza addressing elements inside the payload element\", \"Clarify wording on stanza processed elements and improve XEP formatting\", \"Remove limitation of random padding content to base64 characters alone\", \"Chat messages MUST contain message processing store hint\", \"Credit where credit is due\" ] }, \"version\": \"0.3.0\" }, { \"date\": \"2019-10-04\", \"initials\": \"ps\", \"remark\": { \"p\": [ \"Specify IQ encryption\", \"Add examples and addenda\" ] }, \"version\": \"0.2.0\" }, { \"date\": \"2019-07-30\", \"initials\": \"XEP Editor (jsc)\", \"remark\": \"Accepted by vote of Council on 2019-06-26.\", \"version\": \"0.1.0\" }, { \"date\": \"2019-06-03\", \"initials\": \"ps\", \"remark\": { \"p\": \"First draft.\" }, \"version\": \"0.0.1\" } ], \"shortname\": \"SCE\", \"sig\": \"Standards\", \"status\": \"Experimental\", \"supersededby\": \"\", \"supersedes\": \"\", \"title\": \"Stanza Content Encryption\", \"type\": \"Standards Track\" }, \"section1\": [ { \"-anchor\": \"intro\", \"-topic\": \"Introduction\", \"p\": [ { \"#text\": \"There is a number of different end-to-end encryption mechanisms that can be used to secure user communication against unauthorized access from malicious third parties. Popular examples for this are\", \"note\": [ { \"#text\": \"XEP-0384: OMEMO Encryption \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0384.html\", \"-url\": \"https://xmpp.org/extensions/xep-0384.html\" } }, { \"#text\": \"XEP-0373: OpenPGP for XMPP \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0373.html\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"OMEMO Encryption (XEP-0384)\", \"-url\": \"https://xmpp.org/extensions/xep-0384.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"OpenPGP for XMPP (XEP-0373)\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html\" } } ] }, { \"#text\": \"While the latter allows for encryption of arbitrary extension elements, protocols such as\", \"note\": [ { \"#text\": \"XEP-0384: OMEMO Encryption \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0384.html\", \"-url\": \"https://xmpp.org/extensions/xep-0384.html\" } }, { \"#text\": \"XEP-0385: Stateless Inline Media Sharing (SIMS) \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0385.html\", \"-url\": \"https://xmpp.org/extensions/xep-0385.html\" } }, { \"#text\": \"XEP-0308: Last Message Correction \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0308.html\", \"-url\": \"https://xmpp.org/extensions/xep-0308.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"OMEMO Encryption (XEP-0384)\", \"-url\": \"https://xmpp.org/extensions/xep-0384.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Stateless Inline Media Sharing (XEP-0385)\", \"-url\": \"https://xmpp.org/extensions/xep-0385.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Last Message Correction (XEP-0308)\", \"-url\": \"https://xmpp.org/extensions/xep-0308.html\" } } ] }, { \"#text\": \"This extension protocol proposes a solution to aforementioned issues by generalizing the OpenPGP Content Elements (eg.\", \"link\": { \"#text\": \"\\u003csigncrypt\\u003e\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html#example-2\" }, \"note\": { \"#text\": \"XEP-0373: OpenPGP for XMPP \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0373.html\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"OpenPGP for XMPP (XEP-0373)\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html\" } } } ] }, { \"-anchor\": \"reqs\", \"-topic\": \"Requirements\", \"p\": [ \"This proposal widens the scope of the security guarantees given by the used encryption mechanism from just the body of the message to various extension elements. It is intended to serve as a \\\"one size fits all\\\" solution for extension element encryption in XMPP.\", \"In order to achieve its goal, Stanza Content Encryption does the following:\" ], \"ul\": { \"li\": [ \"Define elements that hold sensitive information\", \"Speficy rules about how extension elements are encrypted and embedded in the message\", \"Specify rules about which elements are allowed inside and outside the protected domain\" ] } }, { \"-anchor\": \"glossary\", \"-topic\": \"Glossary\", \"dl\": { \"di\": [ { \"dd\": \"An XMPP extension element which is used to hold the \\u003ccontent/\\u003e element and the affix elements.\\n The XML representation of this element is encrypted and then embedded as the payload of the message being sent.\", \"dt\": \"Envelope Element \\u003cenvelope/\\u003e\" }, { \"dd\": \"An element which is used to contain all extension elements which need to be encrypted.\", \"dt\": \"Content Element \\u003ccontent/\\u003e\" } ] } }, { \"-anchor\": \"affix_elements\", \"-topic\": \"Affix Elements\", \"example\": { \"#text\": \"\\u003ctime stamp='2004-01-25T06:05:00+01:00'/\\u003e\\n\\u003cto jid='missioncontrol@houston.nasa.gov'/\\u003e\\n\\u003cfrom jid='opportunity@mars.planet'/\\u003e\\n\\u003crpad\\u003eC1DHN9HK-9A25tSmwK4hU!Jji9%GKYK^syIlHJT9TnI4\\u003c/rpad\\u003e\", \"-caption\": \"Examples of Affix Elements\" }, \"p\": [ \"In order to prevent certain attacks, different affix elements MAY be added as direct child elements of the \\u003cenvelope/\\u003e element.\", \"Encryption protocols that make use of Stanza Content Encryption MUST define their own profiles that describe mandatory behaviour of which of these elements are used. They MAY also define and add their own specific affix elements.\" ], \"table\": { \"-caption\": \"Overview about different crypto property elements\", \"tr\": [ { \"th\": [ \"Element\", \"Description\", \"Usage\", \"Verification\" ] }, { \"td\": [ \"\\u003crpad/\\u003e\", \"Random-length random-content padding\", \"Prevent known ciphertext and message length correlation attacks. The content of this element is a randomly generated sequence of random length between 0 and 200 characters. TODO: sane boundaries?\", \"None. This element is only used to change the length of the ciphertext and doesn't need to be verified\" ] }, { \"td\": [ \"\\u003ctime/\\u003e\", \"Timestamp\", { \"#text\": \"Prevent replay attacks using old messages. This element MUST have one attribute 'stamp', whose value is a timestamp following the format described in\", \"note\": { \"#text\": \"XEP-0082: XMPP Date and Time Profiles \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0082.html\", \"-url\": \"https://xmpp.org/extensions/xep-0082.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"XMPP Date and Time Profiles (XEP-0082)\", \"-url\": \"https://xmpp.org/extensions/xep-0082.html\" } } }, \"Receiving clients MUST check whether the difference between the timestamp and the sending time derived from the stanza itself lays within a reasonable margin. The client SHOULD use the content of the timestamp element when displaying the send date of the message\" ] }, { \"td\": [ \"\\u003cto/\\u003e\", \"Recipient of the message\", \"Prevent spoofing of the recipient. This element MUST have one attribute 'jid' whose value is the bare JID of the message's recipient.\", \"Receiving clients MUST check if the JID matches the to attribute of the enclosing stanza and otherwise alert the user/reject the message\" ] }, { \"td\": [ \"\\u003cfrom/\\u003e\", \"Sender of the message\", \"Prevent spoofing of the sender. This element MUST have one attribute 'jid' whose value is the bare JID of the message's sender.\", \"Receiving clients MUST check if the value matches the from attribute of the enclosing stanza and otherwise alert the user/reject the message\" ] } ] } }, { \"-anchor\": \"motivation\", \"-topic\": \"Motivation\", \"example\": [ { \"#text\": \"\\u003cmessage from='narrator@jabber.org'\\n to='viewer@jabber.org'\\u003e\\n \\u003cencrypted xmlns='eu.siacs.conversations.axolotl'\\u003e\\n \\u003cheader sid='27183'\\u003e\\n ...\\n \\u003c/header\\u003e\\n \\u003cpayload\\u003e\\n SSBnb3QgaW4gZXZlcnlvbmUncyBob3N0aWxlIGxpdHRsZSBmYWNlLiBZZXMsIHRoZXNlIGFyZSBi\\n cnVpc2VzIGZyb20gZmlnaHRpbmcuIFllcywgSSdtIGNvbWZvcnRhYmxlIHdpdGggdGhhdC4gSSBh\\n bSBlbmxpZ2h0ZW5lZC4=\\n \\u003c/payload\\u003e\\n \\u003c/encrypted\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttps://en.wikipedia.org/wiki/Fight_Club#Plot\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"An imperfectly encrypted message which leaks dangerous information about the conversation through the plaintext OOB extension element\" }, { \"#text\": \"\\u003ciq from='doctor@shakespeare.lit/pda'\\n id='get-data-1'\\n to='ladymacbeth@shakespeare.lit/castle'\\n type='get'\\u003e\\n \\u003cdata xmlns='urn:xmpp:bob'\\n cid='sha1+8f35fef110ffc5df08d579a50083ff9308fb6242@bob.xmpp.org'/\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Unencrypted IQ request\" }, { \"#text\": \"\\u003ciq from='ladymacbeth@shakespeare.lit/castle'\\n id='get-data-1'\\n to='doctor@shakespeare.lit/pda'\\n type='result'\\u003e\\n \\u003cdata xmlns='urn:xmpp:bob'\\n cid='sha1+8f35fef110ffc5df08d579a50083ff9308fb6242@bob.xmpp.org'\\n max-age='86400'\\n type='image/png'\\u003e\\n iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABGdBTUEAALGP\\n C/xhBQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9YGARc5KB0XV+IA\\n AAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAF1J\\n REFUGNO9zL0NglAAxPEfdLTs4BZM4DIO4C7OwQg2JoQ9LE1exdlYvBBeZ7jq\\n ch9//q1uH4TLzw4d6+ErXMMcXuHWxId3KOETnnXXV6MJpcq2MLaI97CER3N0\\n vr4MkhoXe0rZigAAAABJRU5ErkJggg==\\n \\u003c/data\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Likewise unencrypted reply\" } ], \"p\": [ { \"#text\": \"Some end-to-end encryption protocols like\", \"note\": { \"#text\": \"XEP-0384: OMEMO Encryption \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0384.html\", \"-url\": \"https://xmpp.org/extensions/xep-0384.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"OMEMO Encryption (XEP-0384)\", \"-url\": \"https://xmpp.org/extensions/xep-0384.html\" } } }, \"The example above obviously leaks information about the communication through the unencrypted OOB extension element.\", \"Most end-to-end encryption mechanisms are also focussed solely on message content encryption and do not tackle \\u003ciq/\\u003e requests/replies at all. Stanza Content Encryption can be applied to those as well.\" ] }, { \"-anchor\": \"usecases\", \"-topic\": \"Use Cases\", \"section2\": [ { \"-anchor\": \"use-case-message\", \"-topic\": \"Use in \\u003cmessage/\\u003e stanzas\", \"example\": [ { \"#text\": \"\\u003cenvelope xmlns='urn:xmpp:sce:1'\\u003e\\n \\u003ccontent\\u003e\\n \\u003cbody xmlns='jabber:client'\\u003e[...]\\u003c/body\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttps://en.wikipedia.org/wiki/Fight_Club#Plot\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n \\u003c/content\\u003e\\n\\u003c/envelope\\u003e\", \"-caption\": \"Envelope element containing the messages body and the OBB element.\" }, { \"#text\": \"\\u003cmessage from='narrator@jabber.org'\\n to='viewer@jabber.org'\\u003e\\n \\u003cencrypted xmlns='urn:xmpp:encryption:stub:sce:1'\\u003e\\n \\u003cpayload\\u003e\\n PGNvbnRlbnQgeG1sbnM9J3Vybjp4bXBwOnNjZTowJz48cGF5bG9hZD48Ym9keSB4bWxucz0namFi\\n YmVyOmNsaWVudCc+SSBnb3QgaW4gZXZlcnlvbmUncyBob3N0aWxlIGxpdHRsZSBmYWNlLiBZZXMs\\n IHRoZXNlIGFyZSBicnVpc2VzIGZyb20gZmlnaHRpbmcuIFllcywgSSdtIGNvbWZvcnRhYmxlIHdp\\n dGggdGhhdC4gSSBhbSBlbmxpZ2h0ZW5lZC48L2JvZHk+PHggeG1sbnM9J2phYmJlcjp4Om9vYic+\\n PHVybD5odHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaWdodF9DbHViI1Bsb3Q8L3VybD48\\n L3g+PC9wYXlsb2FkPjwvY29udGVudD4=\\n \\u003c/payload\\u003e\\n \\u003c/encrypted\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Finished message stanza containing the \\u003cenvelope/\\u003e element from the previous example, inside of its payload element, encrypted using a hypothetical encryption protocol and SCE.\" } ], \"p\": [ \"The main use case of Stanza Content Encryption is the use of end-to-end encryption protocols in combination with extension protocols that store sensitive information in other places than the message body.\", { \"#text\": \"This applies to many extension elements that add additional information to \\u003cmessage/\\u003e stanzas, such as those of\", \"note\": { \"#text\": \"XEP-0066: Out of Band Data \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0066.html\", \"-url\": \"https://xmpp.org/extensions/xep-0066.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Out-of-Band Data (XEP-0066)\", \"-url\": \"https://xmpp.org/extensions/xep-0066.html\" } } } ] }, { \"-anchor\": \"use-case-iq\", \"-topic\": \"Use in \\u003ciq/\\u003e stanzas\", \"example\": [ { \"#text\": \"\\u003cenvelope xmlns='urn:xmpp:sce:1'\\u003e\\n \\u003ccontent\\u003e\\n \\u003cdata xmlns='urn:xmpp:bob'\\n cid='sha1+8f35fef110ffc5df08d579a50083ff9308fb6242@bob.xmpp.org'/\\u003e\\n \\u003c/content\\u003e\\n \\u003cfrom jid='doctor@shakespeare.lit/pda'/\\u003e\\n \\u003cto jid='ladymacbeth@shakespear.lit/castle'/\\u003e\\n\\u003c/envelope\\u003e\", \"-caption\": \"Sender prepares a \\u003ccontent/\\u003e element containing the query subject.\" }, { \"#text\": \"\\u003ciq from='doctor@shakespeare.lit/pda'\\n id='get-data-1'\\n to='ladymacbeth@shakespeare.lit/castle'\\n type='get'\\u003e\\n \\u003cencrypted xmlns='urn:xmpp:encryption:stub:sce:1'\\u003e\\n \\u003cpayload\\u003e\\n V2FpdCwgd2hhdD8gQXJlIHlvdSBzZXJpb3VzPyBEaWQgeW91IHJlYWxseSBqdXN0IGdyYWIgeW91\\n ciBmYXZvdXJpdGUgYmFzZTY0IGRlY29kZXIganVzdCB0byBjaGVjayB0aGlzIGRvY3VtZW50IGZv\\n ciBoaWRkZW4gbWVzc2FnZXM/IFdoYXQgYXJlIHlvdSBzb21lIGtpbmQgb2YgbmVyZD8gU29tZSBn\\n ZWVrIHdpdGggYSBiaW5hcnkgd3Jpc3Qgd2F0Y2g/\\n \\u003c/payload\\u003e\\n \\u003c/encrypted\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"The sender then encrypts the \\u003cenvelope/\\u003e element for the recipient and sends the \\u003ciq/\\u003e containing the result of the encryption.\" }, { \"#text\": \"\\u003cenvelope xmlns='urn:xmpp:sce:1'\\u003e\\n \\u003ccontent\\u003e\\n \\u003cdata xmlns='urn:xmpp:bob'\\n cid='sha1+8f35fef110ffc5df08d579a50083ff9308fb6242@bob.xmpp.org'\\n max-age='86400'\\n type='image/png'\\u003e\\n iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAclBMVEUAAADYZArfaA9GIAoBAAGN\\n QA3MXgniaAiEOgZMIATDXRXZZhHUZBHIXhDrbQ6sUQ7OYA2TRAubRwqMQQq7VQlKHgMAAAK5WRfJ\\n YBOORBFoMBCwUQ/ycA6FPgvbZQpeKglNJQmrTQeOPgQyFwR6MwACAABRPE/oAAAAW0lEQVQI1xXI\\n Rw6EMBTAUP8kJKENnaF37n9FQPLCekAgzklhgCwfrlNHEXhrvCsxaU/SwLGAFuIWZFpBERtKm9Xf\\n JqH+vVWh4POqgHrsAtht095b+geYRSl57QHSPgP3+CwvAAAAAABJRU5ErkJggg==\\n \\u003c/data\\u003e\\n \\u003c/content\\u003e\\n \\u003cfrom jid='ladymacbeth@shakespear.lit/castle'/\\u003e\\n \\u003cto jid='doctor@shakespeare.lit/pda'/\\u003e\\n\\u003c/envelope\\u003e\", \"-caption\": \"The recipient prepares the reply to the request by assembling the \\u003cenvelope/\\u003e element.\" }, { \"#text\": \"\\u003ciq from='ladymacbeth@shakespeare.lit/castle'\\n id='get-data-1'\\n to='doctor@shakespeare.lit/pda'\\n type='result'\\u003e\\n \\u003cencrypted xmlns='urn:xmpp:encryption:stub:sce:1'\\u003e\\n \\u003cpayload\\u003e\\n PGNvbnRlbnQgeG1sbnM9J3Vybjp4bXBwOnNjZTowJz4KICA8cGF5bG9hZD4KICAgIDxkYXRhIHht\\n bG5zPSd1cm46eG1wcDpib2InCiAgICAgICAgY2lkPSdzaGExKzhmMzVmZWYxMTBmZmM1ZGYwOGQ1\\n NzlhNTAwODNmZjkzMDhmYjYyNDJAYm9iLnhtcHAub3JnJwogICAgICAgIG1heC1hZ2U9Jzg2NDAw\\n JwogICAgICAgIHR5cGU9J2ltYWdlL3BuZyc+CiAgICBpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFB\\n QW9BQUFBS0NBTUFBQUM2N0QrUEFBQUFjbEJNVkVVQUFBRFlaQXJmYUE5R0lBb0JBQUdOCiAgICBR\\n QTNNWGduaWFBaUVPZ1pNSUFURFhSWFpaaEhVWkJISVhoRHJiUTZzVVE3T1lBMlRSQXViUndxTVFR\\n cTdWUWxLSGdNQUFBSzVXUmZKCiAgICBZQk9PUkJGb01CQ3dVUS95Y0E2RlBndmJaUXBlS2dsTkpR\\n bXJUUWVPUGdReUZ3UjZNd0FDQUFCUlBFL29BQUFBVzBsRVFWUUkxeFhJCiAgICBSdzZFTUJUQVVQ\\n OGtKS0VObmFGMzduOUZRUExDZWtBZ3prbGhnQ3dmcmxOSEVYaHJ2Q3N4YVUvU3dMR0FGdUlXWkZw\\n QkVSdEttOVhmCiAgICBKcUgrdlZXaDRQT3FnSHJzQXRodDA5NWIrZ2VZUlNsNTdRSFNQZ1AzK0N3\\n dkFBQUFBQUJKUlU1RXJrSmdnZz09CiAgICA8L2RhdGE+CiAgPC9wYXlsb2FkPgogIDxmcm9tIGpp\\n ZD0nbGFkeW1hY2JldGhAc2hha2VzcGVhci5saXQvY2FzdGxlJy8+CiAgPHRvIGppZD0nZG9jdG9y\\n QHNoYWtlc3BlYXJlLmxpdC9wZGEnLz4KPC9jb250ZW50Pgo=\\n \\u003c/payload\\u003e\\n \\u003c/encrypted\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"The \\u003cenvelope/\\u003e element is then encrypted and sent as a reply to the initiator of the request.\" } ], \"p\": \"Stanza Content Encryption thrives not only to allow for rich content encryption in \\u003cmessage/\\u003e stanzas, but is also applicable to \\u003ciq/\\u003e queries. A resource might want to query sensitive information from another resource capable of Stanza Content Encryption.\" } ] }, { \"-anchor\": \"sending\", \"-topic\": \"Sending an encrypted stanza\", \"p\": [ \"In order to send an encrypted message without leaking extension elements, the sender prepares the message by placing the sensitive extension elements inside a \\u003ccontent/\\u003e element and that inside an \\u003cenvelope/\\u003e element.\", \"Depending on the encryption-specific SCE-profile, some affix elements are added as child elements of the \\u003cenvelope/\\u003e element.\", \"The \\u003cenvelope/\\u003e element is then serialized into XML and encrypted using the SCE-specific profile of the encryption mechanism in place. The result is appended to the message.\", { \"#text\": \"Since the outer message element does not contain a \\u003cbody/\\u003e element the sender appends an unencrypted \\u003cstore/\\u003e hint as specified in\", \"note\": { \"#text\": \"XEP-0334: Message Processing Hints \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0334.html\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Message Processing Hints (XEP-0334)\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html\" } } }, \"The message can then be sent to the recipient.\" ] }, { \"-anchor\": \"receiving\", \"-topic\": \"Receiving an encrypted stanza\", \"p\": [ \"The recipient of the message decrypts its encrypted payload. The result is the \\u003cenvelope/\\u003e element containing the \\u003ccontent/\\u003e element and the affix elements as direct child elements. Depending on the affix profiles specified by the used encryption protocol, the affix elements are verified to prevent certain attacks from taking place.\", \"Afterwards, the extension elements inside the \\u003ccontent/\\u003e element are checked against the permitted list and any disallowed elements are discarded.\", \"As a last step, the original unencrypted stanza is recreated by replacing the \\u003cenvelope/\\u003e element of the stanza with the elements inside of the \\u003ccontent/\\u003e element.\" ] }, { \"-anchor\": \"server-processed\", \"-topic\": \"Server-processed Elements\", \"p\": [ \"There are certain extension elements which are required to be available to the server in order to do message routing and processing.\\n Additionally there are some elements that MUST be filtered by the server.\\n Allowing for those elements to be included in, and parsed from the encrypted payload would allow a malicious client to perform a number of attacks.\", \"Contrary to this, other elements are considered sensitive and MUST NOT be available in plaintext outside the \\u003cenvelope/\\u003e element.\", \"It is hard to come up with a complete list of exceptional elements at this point, as there is no practical implementation experience.\", \"Below is a non-exhaustive list of elements that are definitely forbidden inside the \\u003cenvelope/\\u003e element and permitted as direct child elements of the message.\" ], \"table\": { \"-caption\": \"Examples for exceptional elements that MUST NOT be included in, or read from the \\u003cenvelope/\\u003e element and MUST instead be sent traditionally as direct child elements of the stanza.\", \"tr\": [ { \"th\": [ \"Element\", \"Reason\" ] }, { \"td\": [ { \"#text\": \"Elements of\", \"note\": { \"#text\": \"XEP-0334: Message Processing Hints \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0334.html\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Message Processing Hints (XEP-0334)\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html\" } } }, \"Message Processing Hints are addressed to the server and MUST therefore be accessible in plaintext. A receiving client MUST ignore any message processing hints encountered inside the encrypted \\u003cenvelope/\\u003e element\" ] }, { \"td\": [ { \"#text\": \"Stanza-ID elements of\", \"note\": { \"#text\": \"XEP-0359: Unique and Stable Stanza IDs \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0359.html\", \"-url\": \"https://xmpp.org/extensions/xep-0359.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Unique and Stable Stanza IDs (XEP-0359)\", \"-url\": \"https://xmpp.org/extensions/xep-0359.html\" } } }, \"Sending clients MUST NOT include Stanza-ID elements inside the \\u003cenvelope/\\u003e element, as this would prevent the server from filtering it.\\n A client MUST ignore Stanza-ID elements encountered inside the \\u003cenvelope/\\u003e element\" ] }, { \"td\": [ { \"#text\": \"Elements of\", \"note\": { \"#text\": \"XEP-0033: Extended Stanza Addressing \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0033.html\", \"-url\": \"https://xmpp.org/extensions/xep-0033.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Extended Stanza Addressing (XEP-0033)\", \"-url\": \"https://xmpp.org/extensions/xep-0033.html\" } } }, \"The server MUST be able to access the \\u003caddresses/\\u003e and \\u003caddress/\\u003e elements in order to do message routing, so they MUST NOT be encrypted.\" ] }, { \"td\": [ \"TODO: Other elements?\", \"\" ] } ] } }, { \"-anchor\": \"rules\", \"-topic\": \"Business Rules\", \"p\": [ \"Unencrypted \\u003cenvelope/\\u003e elements are NOT ALLOWED as child elements of the stanza and MUST be dropped.\", \"Elements in the \\u003ccontent/\\u003e element MUST be identified using an element name and namespace.\\n Notably the \\u003cbody/\\u003e element MUST contain a valid namespace (i.e. \\\"jabber:client\\\").\", \"The recipient MUST verify that the decrypted \\u003cenvelope/\\u003e element contains valid XML before processing it any further. Invalid XML must be rejected.\", \"After verifying the integrity of the \\u003cenvelope/\\u003e element, the recipient needs to make sure that no server-processed elements are found inside of it.\\n Any forbidden elements MUST be dropped before the message is processed any further.\", \"Furthermore the receiving client MUST ignore any extension elements considered as sensitive which are found outside of the \\u003cenvelope/\\u003e element,\\n especially as direct unencrypted child elements of the enclosing stanza.\", { \"#text\": \"Since a chat message encrypted with SCE MUST NOT contain a \\u003cbody/\\u003e element, it is not eligible for MAM message storage (\", \"note\": [ { \"#text\": \"XEP-0313: Message Archive Management \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0313.html\", \"-url\": \"https://xmpp.org/extensions/xep-0313.html\" } }, { \"#text\": \"XEP-0334: Message Processing Hints \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0334.html\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"Message Archive Management (XEP-0313)\", \"-url\": \"https://xmpp.org/extensions/xep-0313.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Message Processing Hints (XEP-0334)\", \"-url\": \"https://xmpp.org/extensions/xep-0334.html\" } } ] } ] }, { \"-anchor\": \"impl\", \"-topic\": \"Implementation Notes\", \"p\": [ \"As a first, naïve approach a recipient of a message containing an \\u003cenvelope/\\u003e element could simply reinject the reassambled unencrypted stanza into the XML stream.\\n This might introduce some security issues.\\n Most notably, depending on the clients implementation it may become ambiguous which elements were received end-to-end encrypted and which were received unencrypted.\", \"Implementations should rather handle encrypted elements explicitly.\" ] }, { \"-anchor\": \"security\", \"-topic\": \"Security Considerations\", \"p\": \"For the sake of simplicity, the examples in this document are not encrypted. A real-world implementation MUST make use of real cryptographic protocols.\", \"section2\": { \"-anchor\": \"security_profiles\", \"-topic\": \"Encryption Profiles\", \"p\": [ \"This specification presents a set of affix elements which can be used to counter certain attacks. However it does not dictate any behaviour regarding what elements MUST be used/verified or when.\", \"Different cryptographic protocols come with different possible attack scenarios which must be taken into consideration, so it is left up to those cryptographic protocols to define profiles that describe the use of affix elements.\" ] } }, { \"-anchor\": \"registrar\", \"-topic\": \"XMPP Registrar Considerations\", \"p\": \"TODO: Maybe the Registrar should handle a list of elements that are forbidden as child elements of the \\u003ccontent/\\u003e element?\" }, { \"-anchor\": \"schema\", \"-topic\": \"XML Schema\", \"p\": \"TODO.\" }, { \"-anchor\": \"acknowledgements\", \"-topic\": \"Acknowledgements\", \"p\": [ { \"#text\": \"Big thanks to the authors of\", \"note\": { \"#text\": \"XEP-0373: OpenPGP for XMPP \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0373.html\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"OpenPGP for XMPP (XEP-0373)\", \"-url\": \"https://xmpp.org/extensions/xep-0373.html\" } } }, \"Also thanks to Marvin Wißfeld, Tim Henkes, Daniel Gultsch, Melvin Keskin and Andreas Straub for their feedback.\" ] } ] } planned xep-0158: { \"-xmlns\": \"\", \"header\": { \"abstract\": \"This document specifies an XMPP protocol extension that entities may use to discover whether the sender of an XML stanza is a human user or a robot.\", \"approver\": \"Council\", \"author\": [ { \"email\": \"ian.paterson@clientside.co.uk\", \"firstname\": \"Ian\", \"jid\": \"ian@zoofy.com\", \"surname\": \"Paterson\" }, { \"email\": \"stpeter@stpeter.im\", \"firstname\": \"Peter\", \"jid\": \"stpeter@jabber.org\", \"surname\": \"Saint-Andre\", \"uri\": \"https://stpeter.im/\" } ], \"dependencies\": { \"spec\": [ \"XMPP Core\", \"XMPP IM\", \"XEP-0004\", \"XEP-0066\", \"XEP-0221\" ] }, \"legal\": { \"conformance\": { \"#text\": \"This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/about/xsf/ipr-policy\", \"-url\": \"https://xmpp.org/about/xsf/ipr-policy\" } }, \"copyright\": { \"#text\": \"This XMPP Extension Protocol is copyright © 1999 – 2024 by the\", \"link\": { \"#text\": \"XMPP Standards Foundation\", \"-url\": \"https://xmpp.org/\" } }, \"liability\": \"In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.\", \"permissions\": \"Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \\\"Specification\\\"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.\", \"warranty\": \"## NOTE WELL: This Specification is provided on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##\" }, \"number\": \"0158\", \"revision\": [ { \"date\": \"2019-11-07\", \"initials\": \"egp, mb\", \"remark\": { \"p\": \"Use the correct FORM_TYPE for extended IBR, and use a proper MUC join as an example. Also fix typos.\" }, \"version\": \"1.0.1\" }, { \"date\": \"2008-09-03\", \"initials\": \"psa\", \"remark\": { \"p\": \"Per a vote of the XMPP Council, advanced status to Draft; concurrently, the XMPP Registrar issued the urn:xmpp:captcha namespace; also changed element name from challenge to captcha in order to match the namespace name.\" }, \"version\": \"1.0\" }, { \"date\": \"2008-08-06\", \"initials\": \"psa\", \"remark\": { \"p\": \"Further modified examples to track changes to XEP-0231.\" }, \"version\": \"0.11\" }, { \"date\": \"2008-08-06\", \"initials\": \"psa\", \"remark\": { \"p\": \"Modified examples to track changes to XEP-0231; to avoid confusion with cid URIs, changed name of challenge ID form field from cid to challenge.\" }, \"version\": \"0.10\" }, { \"date\": \"2008-05-12\", \"initials\": \"psa\", \"remark\": { \"p\": \"Specified that cid field is required; more clearly defined structure of challenge stanza; added several security considerations; corrected several errors in the text and examples.\" }, \"version\": \"0.9\" }, { \"date\": \"2008-05-12\", \"initials\": \"psa\", \"remark\": { \"p\": \"Moved text regarding labels to new internationalization considerations section; removed necessity that ID of IQ-set shall match ID of challenge, since this is not consistent with existing usage that IDs are generated by the sender of an IQ.\" }, \"version\": \"0.8\" }, { \"date\": \"2008-04-28\", \"initials\": \"psa\", \"remark\": { \"p\": \"Generalized text to cover abuse rather than just spim; modified temporary namespace to adhere to XMPP Registrar procedures; added use case for joining multi-user chat rooms.\" }, \"version\": \"0.7\" }, { \"date\": \"2007-07-11\", \"initials\": \"psa/ip\", \"remark\": { \"p\": \"Moved media element definition to XEP-0221; consistently used the terms sender and challenger rather than client and entity; modified provisional namespaces to adhere to XMPP Registrar policies; completed editorial review.\" }, \"version\": \"0.6\" }, { \"date\": \"2006-10-30\", \"initials\": \"ip\", \"remark\": { \"p\": \"Added reference to SPIM Reporting.\" }, \"version\": \"0.5\" }, { \"date\": \"2005-09-30\", \"initials\": \"ip\", \"remark\": { \"p\": \"Required WAV instead of MP3 for audio CAPTCHAs; minor corrections.\" }, \"version\": \"0.4\" }, { \"date\": \"2005-09-28\", \"initials\": \"ip\", \"remark\": { \"p\": \"Added more CAPTCHA types and the legacy question and answer section.\" }, \"version\": \"0.3\" }, { \"date\": \"2005-09-14\", \"initials\": \"ip\", \"remark\": { \"p\": \"Minor fixes.\" }, \"version\": \"0.2\" }, { \"date\": \"2005-09-14\", \"initials\": \"ip\", \"remark\": { \"p\": \"Initial version.\" }, \"version\": \"0.1\" }, { \"date\": \"2005-09-07\", \"initials\": \"ip\", \"remark\": { \"p\": \"First draft.\" }, \"version\": \"0.0.1\" } ], \"schemaloc\": { \"url\": \"http://xmpp.org/schemas/captcha.xsd\" }, \"shortname\": \"captcha\", \"sig\": \"Standards\", \"status\": \"Draft\", \"supersededby\": \"\", \"supersedes\": \"\", \"title\": \"CAPTCHA Forms\", \"type\": \"Standards Track\" }, \"section1\": [ { \"-anchor\": \"intro\", \"-topic\": \"Introduction\", \"p\": [ { \"#text\": \"The appearance of large public IM services based on\", \"em\": \"discourage\", \"note\": [ { \"#text\": \"RFC 6120: Extensible Messaging and Presence Protocol (XMPP): Core \\u003c\", \"link\": { \"#text\": \"http://tools.ietf.org/html/rfc6120\", \"-url\": \"http://tools.ietf.org/html/rfc6120\" } }, { \"#text\": \"RFC 6121: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence \\u003c\", \"link\": { \"#text\": \"http://tools.ietf.org/html/rfc6121\", \"-url\": \"http://tools.ietf.org/html/rfc6121\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"XMPP Core\", \"-url\": \"http://tools.ietf.org/html/rfc6120\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"XMPP IM\", \"-url\": \"http://tools.ietf.org/html/rfc6121\" } } ] }, { \"#text\": \"One technique developed to combat abusive messages and behavior via non-XMPP technologies requires humans to be differentiated from bots using a \\\"Completely Automated Public Turing Test to Tell Computers and Humans Apart\\\" or CAPTCHA (see \\u003c\", \"link\": { \"#text\": \"http://www.captcha.net/\", \"-url\": \"http://www.captcha.net/\" } }, { \"#text\": \"An alternative technique to CAPTCHAs requires Desktop PC clients to undertake a\", \"note\": { \"#text\": \"Hashcash \\u003c\", \"link\": { \"#text\": \"http://hashcash.org/\", \"-url\": \"http://hashcash.org/\" } }, \"span\": { \"#text\": \"Hashcash\", \"-class\": \"ref\" } }, \"Both CAPTCHAs and hashcash have been criticized regarding their effectiveness (or lack thereof). Therefore, the challenge protocol specified herein provides a great deal of flexibility, so that challenges can include CAPTCHAs, hashcash, word puzzles, so-called kitten authentication, and any other mechanism that may be developed in the future.\", { \"#text\": \"The generic challenge protocol described in this document is designed for incorporation into protocols such as\", \"note\": [ { \"#text\": \"XEP-0077: In-Band Registration \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0077.html\", \"-url\": \"https://xmpp.org/extensions/xep-0077.html\" } }, { \"#text\": \"XEP-0045: Multi-User Chat \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0045.html\", \"-url\": \"https://xmpp.org/extensions/xep-0045.html\" } }, { \"#text\": \"XEP-0016: Privacy Lists \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0016.html\", \"-url\": \"https://xmpp.org/extensions/xep-0016.html\" } }, { \"#text\": \"XEP-0159: SPIM-Blocking Control \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0159.html\", \"-url\": \"https://xmpp.org/extensions/xep-0159.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"In-Band Registration (XEP-0077)\", \"-url\": \"https://xmpp.org/extensions/xep-0077.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Multi-User Chat (XEP-0045)\", \"-url\": \"https://xmpp.org/extensions/xep-0045.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Privacy Lists (XEP-0016)\", \"-url\": \"https://xmpp.org/extensions/xep-0016.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"SPIM-Blocking Control (XEP-0159)\", \"-url\": \"https://xmpp.org/extensions/xep-0159.html\" } } ] } ] }, { \"-anchor\": \"require\", \"-topic\": \"Requirements\", \"section2\": [ { \"-anchor\": \"require-extend\", \"-topic\": \"Extensibility\", \"p\": \"The CAPTCHAs in most common use today are Optical Character Recognition (OCR) challenges where an image containing deformed text is presented and the human enters the characters they can read. However, if OCR software advances more rapidly than the techniques used to disguise text from Artificial Intelligence (AI) then very different CAPTCHAs will need to be deployed. This protocol must be extensible enough to allow the incorporation of CAPTCHA techniques that may not have been envisaged.\" }, { \"-anchor\": \"require-variety\", \"-topic\": \"Variety\", \"p\": { \"#text\": \"Several common CAPTCHA techniques present major problems to users with disabilities (see\", \"note\": { \"#text\": \"Inaccessibility of Visually-Oriented Anti-Robot Tests \\u003c\", \"link\": { \"#text\": \"http://www.w3.org/TR/turingtest/\", \"-url\": \"http://www.w3.org/TR/turingtest/\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Inaccessibility of Visually-Oriented Anti-Robot Tests\", \"-url\": \"http://www.w3.org/TR/turingtest/\" } } } } ] }, { \"-anchor\": \"protocol\", \"-topic\": \"Protocol\", \"section2\": [ { \"-anchor\": \"protocol-simple\", \"-topic\": \"Simple Challenge\", \"section3\": [ { \"-anchor\": \"protocol-trigger\", \"-topic\": \"Triggering Stanza\", \"example\": { \"#text\": \"\\u003cmessage from='robot@abuser.com/zombie'\\n to='innocent@victim.com'\\n xml:lang='en'\\n id='spam1'\\u003e\\n \\u003cbody\\u003eLove pills - 75% OFF\\u003c/body\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttp://www.abuser.com/lovepills.html\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Sender Generates Triggering Stanza\" }, \"p\": \"A \\\"triggering stanza\\\" is an XMPP \\u003cmessage/\\u003e, \\u003cpresence/\\u003e, or \\u003ciq/\\u003e stanza that is deemed abusive by the receiving entity (e.g., a client) or an intermediate router (e.g., a server). The entity that generates a triggering stanza is called a \\\"sender\\\".\" }, { \"-anchor\": \"protocol-challenge\", \"-topic\": \"Challenge Stanza\", \"example\": { \"#text\": \"\\u003cmessage from='victim.com'\\n to='robot@abuser.com/zombie'\\n xml:lang='en'\\n id='F3A6292C'\\u003e\\n \\u003cbody\\u003e\\n Your messages to innocent@victim.com are being blocked. To unblock\\n them, visit http://www.victim.com/challenge.html?F3A6292C\\n \\u003c/body\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttp://www.victim.com/challenge.html?F3A6292C\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='sid'\\u003e\\u003cvalue\\u003espam1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr' label='Enter the text you see'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='80'\\n width='290'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/ocr.jpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n cid:sha1+f24030b8d91d233bac14777be5ab531ca3b9f102@bob.xmpp.org\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='picture_recog' label='Identify the picture'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='150'\\n width='150'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/picture.jpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n cid:sha1+f2377f3a3287eac81028243079e1aa9905c466bc@bob.xmpp.org\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='speech_recog' label='Enter the words you hear'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\u003e\\n \\u003curi type='audio/x-wav'\\u003e\\n http://www.victim.com/challenges/speech.wav?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003curi type='audio/ogg-speex'\\u003e\\n http://www.victim.com/challenges/speech.ogg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='video_recog' label='Identity the video'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='150'\\n width='150'\\u003e\\n \\u003curi type='video/mpeg'\\u003e\\n http://www.victim.com/challenges/video.mpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='Type the color of a stop light' type='text-single' var='qa'/\\u003e\\n \\u003cfield label='93C7A' type='text-single' var='SHA-256'/\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Offers a Choice of Challenges to Sender\" }, \"ol\": { \"li\": [ \"The challenge stanza MUST include an 'id' attribute set to the challenge ID (i.e., a unique identifier for this challenge within the challenger's application).\", \"The challenge stanza SHOULD include a \\u003cbody/\\u003e element that provides an explanation of the challenge for clients that do not yet support CAPTCHA forms.\", { \"#text\": \"The challenge stanza MAY include a URL (typically a Web page with instructions) using\", \"note\": { \"#text\": \"XEP-0066: Out of Band Data \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0066.html\", \"-url\": \"https://xmpp.org/extensions/xep-0066.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Out-of-Band Data (XEP-0066)\", \"-url\": \"https://xmpp.org/extensions/xep-0066.html\" } } }, \"The 'xml:lang' attribute of the challenge stanza SHOULD be the same as the one received from the sender, if any.\", { \"#text\": \"The challenge stanza MUST include a CAPTCHA form, i.e., a data form of type \\\"form\\\" containing one or more challenges.\", \"note\": \"Inclusion of a CAPTCHA form not only makes it possible to flexibly support or require a large number of challenge types, but also enables constrained clients to respond to challenges (e.g., mobile phone clients that cannot present web pages, or clients on XMPP-only networks).\" }, { \"#text\": \"The CAPTCHA form MUST include a hidden field named \\\"FORM_TYPE\\\" (in accordance with\", \"note\": { \"#text\": \"XEP-0068: Field Data Standardization for Data Forms \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0068.html\", \"-url\": \"https://xmpp.org/extensions/xep-0068.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Field Standardization for Data Forms (XEP-0068)\", \"-url\": \"https://xmpp.org/extensions/xep-0068.html\" } } }, \"The CAPTCHA form MUST include a hidden field named \\\"challenge\\\" set to the challenge ID.\", \"The CAPTCHA form MUST include a hidden field named \\\"from\\\" set to the value of the 'to' attribute from the triggering stanza.\", \"If the triggering stanza included an 'id' attribute, then the CAPTCHA form MUST include a hidden field named \\\"sid\\\" set to that value.\", \"Each of the CAPTCHA form's non-hidden \\u003cfield/\\u003e elements MAY contain a different challenge.\", { \"#text\": \"Each CAPTCHA field MAY contain a media element (see\", \"note\": { \"#text\": \"XEP-0221: Data Forms Media Element \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0221.html\", \"-url\": \"https://xmpp.org/extensions/xep-0221.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Data Forms Media Element (XEP-0221)\", \"-url\": \"https://xmpp.org/extensions/xep-0221.html\" } } } ] }, \"p\": [ \"Upon receiving a triggering stanza, an entity MAY send a \\\"challenge stanza\\\". An entity MUST NOT send a challenge stanza under any other circumstances. The entity that generates the challenge stanza is called the \\\"challenger\\\".\", { \"#text\": \"The challenge stanza consists of an XMPP \\u003cmessage/\\u003e stanza containing a data form for the sender to fill out, formatted according to\", \"note\": { \"#text\": \"XEP-0004: Data Forms \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0004.html\", \"-url\": \"https://xmpp.org/extensions/xep-0004.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Data Forms (XEP-0004)\", \"-url\": \"https://xmpp.org/extensions/xep-0004.html\" } } }, { \"#text\": \"The sender then would retrieve the media data via HTTP or (for the cid: URIs) via XMPP as described in\", \"note\": { \"#text\": \"XEP-0231: Bits of Binary \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0231.html\", \"-url\": \"https://xmpp.org/extensions/xep-0231.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Bits of Binary (XEP-0231)\", \"-url\": \"https://xmpp.org/extensions/xep-0231.html\" } } } ] }, { \"-anchor\": \"protocol-response\", \"-topic\": \"Response Stanza\", \"example\": [ { \"#text\": \"\\u003cmessage type='error'\\n from='robot@abuser.com/zombie'\\n to='victim.com'\\n xml:lang='en'\\n id='F3A6292C'\\u003e\\n \\u003cerror type='modify'\\u003e\\n \\u003cnot-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/\\u003e\\n \\u003c/error\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Sender Reports Challenge Not Acceptable\" }, { \"#text\": \"\\u003ciq type='set'\\n from='robot@abuser.com/zombie'\\n to='victim.com'\\n xml:lang='en'\\n id='z140r0s'\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='submit'\\u003e\\n \\u003cfield var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='sid'\\u003e\\u003cvalue\\u003espam1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr'\\u003e\\u003cvalue\\u003e7nHL3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Sender Sends One Response to Challenger\" } ], \"p\": [ \"The sender's client SHOULD ignore the challenge stanza in either of the following cases:\", { \"#text\": \"Otherwise, if the challenger provided a URL using\", \"cite\": \"Out-of-Band Data\" }, \"Otherwise, the sender's client MUST respond to the challenge.\", \"The sender's client MUST respond with a \\u003cnot-acceptable/\\u003e error in any of the following cases:\", \"Otherwise, it MUST select one challenge according to the sender's preferences and submit the sender's response form to the challenger.\" ], \"ul\": [ { \"li\": [ { \"#text\": \"If it has not recently sent (e.g., in the last two minutes) a stanza to the JID specified in the 'from' field of the form with the 'id' specified in the 'sid' field (or with no 'id' if no 'sid' field is included).\", \"note\": \"Otherwise the user's presence would be disclosed, or a robot might dupe the user into providing answers to other people's challenges!\" }, \"If the 'from' attribute of the challenge stanza does not match the 'from' field of the form. (If the values are different, then they still match if the bare JIDs are the same, or if the 'from' attribute is the domain of the other JID.)\" ] }, { \"li\": [ \"if it does not understand the CAPTCHA form\", { \"#text\": \"if it does not support all of the\", \"em\": \"required\", \"link\": { \"#text\": \"Multiple Challenges\", \"-url\": \"#protocol-multiple\" } }, { \"#text\": \"if it does not support enough of the challenges (see\", \"link\": { \"#text\": \"Multiple Challenges\", \"-url\": \"#protocol-multiple\" } } ] }, { \"li\": [ { \"#text\": \"if it does not support all of the required challenges (see\", \"link\": { \"#text\": \"Multiple Challenges\", \"-url\": \"#protocol-multiple\" } }, { \"#text\": \"if it does not support enough of the challenges (see\", \"link\": { \"#text\": \"Multiple Challenges\", \"-url\": \"#protocol-multiple\" } }, \"if the sender declines the challenge\" ] } ] }, { \"-anchor\": \"protocol-result\", \"-topic\": \"Result Stanza\", \"example\": [ { \"#text\": \"\\u003ciq type='error'\\n from='victim.com'\\n to='robot@abuser.com/zombie'\\n id='z140r0s'\\u003e\\n \\u003cerror type='cancel'\\u003e\\n \\u003cservice-unavailable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/\\u003e\\n \\u003c/error\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Challenger Indicates Challenge Not Found\" }, { \"#text\": \"\\u003ciq type='result'\\n from='victim.com'\\n to='robot@abuser.com/zombie'\\n id='z140r0s'/\\u003e\", \"-caption\": \"Challenger Tells Sender it Passed\" }, { \"#text\": \"\\u003ciq type='error'\\n from='victim.com'\\n to='robot@abuser.com/zombie'\\n id='z140r0s'\\u003e\\n \\u003cerror type='cancel'\\u003e\\n \\u003cnot-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/\\u003e\\n \\u003c/error\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Challenger Tells Sender it Failed\" } ], \"p\": [ \"The challenger SHOULD send a \\u003cservice-unavailable/\\u003e error to the sender if:\", \"Note: This error MAY be sent even in cases where the challenge became unnecessary while the challenger was waiting for the response.\", \"After receiving a correct response to its challenge, the challenger SHOULD inform the sender that it was successful.\", { \"#text\": \"However, if the sender submits an incorrect response the challenger SHOULD send it a \\u003cnot-acceptable/\\u003e error with type \\\"cancel\\\":\", \"note\": { \"#text\": \"If a large proportion of the responses a server is receiving from another IP are incorrect then it SHOULD inform the administrator of the other server using the protocol specified in\", \"note\": [ { \"#text\": \"XEP-0161: Abuse Reporting \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0161.html\", \"-url\": \"https://xmpp.org/extensions/xep-0161.html\" } }, { \"#text\": \"XEP-0236: Abuse Reporting \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0236.html\", \"-url\": \"https://xmpp.org/extensions/xep-0236.html\" } } ], \"span\": [ { \"-class\": \"ref\", \"link\": { \"#text\": \"Abuse Reporting (XEP-0161)\", \"-url\": \"https://xmpp.org/extensions/xep-0161.html\" } }, { \"-class\": \"ref\", \"link\": { \"#text\": \"Abuse Reporting (XEP-0236)\", \"-url\": \"https://xmpp.org/extensions/xep-0236.html\" } } ] } } ], \"ul\": { \"li\": [ { \"#text\": \"The challenger did not send the specified challenge.\", \"note\": \"If the challenger is a client then it SHOULD be careful not to leak information about the presence of the sender and reply to potentially bogus challenge responses with exactly the same XML that its server would send if the sender were offline.\" }, \"The sender already submitted its response to this challenge.\", \"The sender took too long to submit its response.\" ] } } ] }, { \"-anchor\": \"protocol-multiple\", \"-topic\": \"Multiple Challenges\", \"example\": [ { \"#text\": \"\\u003cmessage from='victim.com'\\n to='robot@abuser.com/zombie'\\n xml:lang='en'\\n id='73DE28A2'\\u003e\\n \\u003cbody\\u003eYour messages to innocent@victim.com are being blocked.\\n To unblock them, ask innocent@victim.com to send you a message.\\u003c/body\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003e73DE28A2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='sid'\\u003e\\u003cvalue\\u003espam2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='answers'\\u003e\\u003cvalue\\u003e2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr' label='Enter the text you see'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='80'\\n width='290'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/ocr.jpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n cid:sha1+f24030b8d91d233bac14777be5ab531ca3b9f102@bob.xmpp.org\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='audio_recog' label='Describe the sound you hear'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\u003e\\n \\u003curi type='audio/x-wav'\\u003e\\n http://www.victim.com/challenges/audio.wav?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='Type the color of a stop light' type='text-single' var='qa'\\u003e\\n \\u003crequired/\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='e03d7' type='text-single' var='SHA-256'/\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Sets Multiple Challenges\" }, { \"#text\": \"\\u003ciq type='set'\\n from='robot@abuser.com/zombie'\\n to='victim.com'\\n xml:lang='en'\\n id='73DE28A2'\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='submit'\\u003e\\n \\u003cfield var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='challenge'\\u003e\\u003cvalue\\u003e73DE28A2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='sid'\\u003e\\u003cvalue\\u003espam2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='answers'\\u003e\\u003cvalue\\u003e2\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='qa'\\u003e\\u003cvalue\\u003ered\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='SHA-256'\\u003e\\u003cvalue\\u003einnocent@victim.com2450F06C173B05E3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Sender Sends Multiple Responses to the Challenger\" } ], \"p\": [ \"The challenger MAY demand responses to more than one of the challenges it is offering; this is done by including an 'answers' \\u003cfield/\\u003e element in the form, which specifies how many answers the sender needs to include. The challenger also MAY require responses to particular challenges; this is done by including a \\u003crequired/\\u003e element in the compulsory fields.\", { \"#text\": \"If the sender finds the request acceptable, it MUST answer all challenges that include a \\u003crequired/\\u003e element. If the total number of answers was specified and it is greater than the number of \\u003crequired/\\u003e elements then the sender MUST also answer one or more of the challenges without a \\u003crequired/\\u003e element. In the example above, the sender should respond to the 'qa' challenge\", \"em\": \"and\" }, \"The challenger MAY decide the sender has passed a challenge even if the responses are not all perfectly correct.\" ] } ] }, { \"-anchor\": \"register\", \"-topic\": \"Extended In-Band Registration\", \"example\": [ { \"#text\": \"\\u003ciq type='get' xml:lang='en' id='reg1'\\u003e\\n \\u003cquery xmlns='jabber:iq:register'/\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Entity Requests Registration Fields from Host\" }, { \"#text\": \"\\u003ciq type='result' xml:lang='en' id='reg1'\\u003e\\n \\u003cquery xmlns='jabber:iq:register'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003ejabber:iq:register\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='sid'\\u003e\\u003cvalue\\u003ereg1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='answers'\\u003e\\u003cvalue\\u003e3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr' label='Enter the text you see'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='80'\\n width='290'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/ocr.jpeg?F3A6292C\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='93C7A' type='text-single' var='SHA-256'/\\u003e\\n \\u003cfield type='text-single' var='username'\\u003e\\n \\u003crequired/\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='text-private' var='password'\\u003e\\n \\u003crequired/\\u003e\\n \\u003c/field\\u003e\\n \\u003c/x\\u003e\\n \\u003cinstructions\\u003e\\n To register, visit http://www.victim.com/register.html\\n \\u003c/instructions\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttp://www.victim.com/register.html\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n \\u003c/query\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Host Returns Registration and Challenge Fields to Entity\" }, { \"#text\": \"\\u003ciq type='set' xml:lang='en' id='reg2'\\u003e\\n \\u003cquery xmlns='jabber:iq:register'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='submit'\\u003e\\n \\u003cfield var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003ejabber:iq:register\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='sid'\\u003e\\u003cvalue\\u003ereg1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='answers'\\u003e\\u003cvalue\\u003e3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr'\\u003e\\u003cvalue\\u003e7nHL3\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='username'\\u003e\\u003cvalue\\u003ebill\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='password'\\u003e\\u003cvalue\\u003eCalliope\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003c/x\\u003e\\n \\u003c/query\\u003e\\n\\u003c/iq\\u003e\", \"-caption\": \"Entity Provides Required Information In-Band\" } ], \"p\": [ { \"#text\": \"This section shows how challenges SHOULD be combined with the existing In-Band Registration protocol according to the rules defined in the Extensibility section of\", \"cite\": \"XEP-0077\" }, { \"#text\": \"Note: The \\u003cchallenge/\\u003e wrapper element is not included, because\", \"cite\": \"XEP-0077\" }, \"Note that the CAPTCHA form MUST be inside the \\u003cquery/\\u003e element, and the server's challenge ID is specified within the form:\", { \"#text\": \"The server MAY include an \\u003cinstructions/\\u003e element and a URL using\", \"cite\": [ \"Out-of-Band Data\", \"In-Band Registration\" ] } ] }, { \"-anchor\": \"muc\", \"-topic\": \"Multi-User Chat\", \"example\": [ { \"#text\": \"\\u003cpresence from='robot@abuser.com/zombie'\\n to='friendly-chat@muc.victim.com/robot101'\\u003e\\n \\u003cx xmlns='http://jabber.org/protocol/muc'/\\u003e\\n\\u003c/presence\\u003e\", \"-caption\": \"Sender Attempts to Join Chat Room\" }, { \"#text\": \"\\u003cmessage from='friendly-chat@muc.victim.com'\\n to='robot@abuser.com/zombie'\\n id='A4C7303D'\\u003e\\n \\u003cbody\\u003e\\n Your messages to friendly-chat@muc.victim.com are being blocked. To unblock\\n them, visit http://www.victim.com/challenge.html?A4C7303D\\n \\u003c/body\\u003e\\n \\u003cx xmlns='jabber:x:oob'\\u003e\\n \\u003curl\\u003ehttp://www.victim.com/challenge.html?A4C7303D\\u003c/url\\u003e\\n \\u003c/x\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='from'\\u003e\\u003cvalue\\u003efriendly-chat@muc.victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003eA4C7303D\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield var='ocr' label='Enter the text you see'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='80'\\n width='290'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/ocr.jpeg?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='picture_recog' label='Identify the picture'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='150'\\n width='150'\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n http://www.victim.com/challenges/picture.jpeg?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003curi type='image/jpeg'\\u003e\\n cid:sha1+f2377f3a3287eac81028243079e1aa9905c466bc@bob.xmpp.org\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='speech_recog' label='Enter the words you hear'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\u003e\\n \\u003curi type='audio/x-wav'\\u003e\\n http://www.victim.com/challenges/speech.wav?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003curi type='audio/ogg-speex'\\u003e\\n http://www.victim.com/challenges/speech.ogg?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield var='video_recog' label='Identity the video'\\u003e\\n \\u003cmedia xmlns='urn:xmpp:media-element'\\n height='150'\\n width='150'\\u003e\\n \\u003curi type='video/mpeg'\\u003e\\n http://www.victim.com/challenges/video.mpeg?A4C7303D\\n \\u003c/uri\\u003e\\n \\u003c/media\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield label='Type the color of a stop light' type='text-single' var='qa'/\\u003e\\n \\u003cfield label='93C7A' type='text-single' var='SHA-256'/\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Offers a Choice of Challenges to Sender\" } ], \"p\": { \"#text\": \"A service that hosts multi-user chat rooms in accordance with\", \"cite\": \"XEP-0045\" } }, { \"-anchor\": \"challenge\", \"-topic\": \"Challenge Types\", \"section2\": [ { \"-anchor\": \"challenge-intro\", \"-topic\": \"Introduction\", \"p\": [ \"Entities MUST address the needs of disabled people and CPU-constrained clients by offering senders a reasonable choice of different types of challenges.\", { \"#text\": \"Desktop clients running on modern PCs will typically be configured to automatically perform a specified 'SHA-256' Hashcash challenge (see below) whenever it is below a certain level of difficulty, with the result that many people may not even notice challenges most of the time. However, people using CPU-constrained clients (e.g. Web or mobile clients) would notice the performance hit. They might prefer to take a CAPTCHA challenge instead.\", \"note\": \"A CPU-constrained client could ask a faster computer (e.g., its server) to perform a Hashcash challenge for it.\" }, \"Visually disabled people using a CPU-constrained client could configure their client to always present them with an audio CAPTCHA challenge.\", \"Most of the challenges below are language sensitive. However, the evaluation of the OCR and Hashcash responses does not depend on the language the sender is using.\", { \"#text\": \"Challenge types are distinguished by the 'var' attribute of each \\u003cfield/\\u003e element. Several types of challenges are described below. More challenges MAY be documented elsewhere and registered with the XMPP Registrar (see\", \"link\": { \"#text\": \"Field Standardization\", \"-url\": \"#registrar-formtypes\" } } ] }, { \"-anchor\": \"challenge-hashcash\", \"-topic\": \"SHA-256 Hashcash\", \"code\": \"innocent@victim.com2450F06C173B05E3\", \"p\": [ { \"#text\": \"The SHA-256 Hashcash challenge is transparent to average PC users. It is indicated when the value of the 'var' attribute is 'SHA-256'. It forces clients to perform CPU-intensive work, making it difficult to send large amounts of abusive traffic. This significantly reduces abusive traffic, but alone it will not completely stop abusive stanzas from being sent through large collections of 'zombie' computers.\", \"note\": \"The hope is that the extra CPU usage will often be noticed by the owners of the zombie machines, who will be more likely to fix them.\" }, { \"#text\": \"The challenger MUST set the 'label' attribute of the \\u003cfield/\\u003e element to a hexadecimal random number containing a configured number of bits (e.g., 2\", \"span\": [ { \"#text\": \"20\", \"-class\": \"super\" }, { \"#text\": \"21\", \"-class\": \"super\" } ] }, { \"#text\": \"To pass the test, the sender MUST return a text string that starts with the JID the sender sent the first stanza to (i.e., the stanza that triggered the challenge). The least significant bits of the SHA-256 hash (see\", \"note\": { \"#text\": \"Secure Hash Standard: Federal Information Processing Standards Publication 180-2 \\u003c\", \"link\": { \"#text\": \"http://csrc.nist.gov/publications/fips/fips180-2/fips186-2withchangenotice.pdf\", \"-url\": \"http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"SHA\", \"-url\": \"http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf\" } } }, \"Note: When configuring the number of bits to be specified by a challenger in the 'label' attribute values, administrators MUST balance the need to make mass abuse as difficult as possible, with the inconvenience that may be caused to the users of less powerful computers. (Most clients will be challenged only very occasionally, so the consumption of 70% of a typical desktop CPU for 4 seconds might be considered appropriate.) Administrators SHOULD increment the configured number of bits from time to time to match increases in the performance of typical desktop PCs. If an administrator notices that abusive robots never attempt the Hashcash challenge, then he SHOULD consider reducing the number of bits, to avoid inconveniencing people unnecessarily.\" ] }, { \"-anchor\": \"challenge-captcha\", \"-topic\": \"CAPTCHAs\", \"p\": [ \"Note: It may be profitable to send abusive stanzas even if less than one percent of CAPTCHA responses are successful. The effectiveness of a CAPTCHA challenge needs to be close to perfect, unless it is used in combination with other anti-abuse techniques.\", { \"#text\": \"If a media type is specified (see table below) then the \\u003cfield/\\u003e element MUST contain a \\u003cmedia/\\u003e element that includes a \\u003curi/\\u003e element of that type. Clients that support the CAPTCHA type MUST be able to play or render the specified MIME-types (see table below). They MAY also support other formats.\", \"note\": \"Audio CAPTCHAs typically require challengers to provide at least the 'audio/x-wav' MIME-type (with the PCM codec) because more efficient patent-free formats are often not supported by constrained clients. It is RECOMMENDED that challengers provide more compact formats (like Ogg Speex or MP3) too.\" }, { \"#text\": \"The 'type' attribute of the \\u003cfield/\\u003e element SHOULD be 'text-single', 'text-private', or 'text-multi' (if no 'type' is specified, the default is 'text-single').\", \"note\": \"The 'boolean' and 'list-single' field types would make it trivial for a robot to provide a correct response at least some of the time.\" }, { \"#text\": \"* See the\", \"link\": { \"#text\": \"Internationalization Considerations\", \"-url\": \"#i18n\" } }, { \"#text\": \"** The image portrays random characters that humans can read but OCR software cannot.\", \"note\": { \"#text\": \"See PWNtcha \\u003c\", \"link\": { \"#text\": \"http://sam.zoy.org/pwntcha/\", \"-url\": \"http://sam.zoy.org/pwntcha/\" } } } ], \"table\": { \"-caption\": \"CAPTCHAs\", \"tr\": [ { \"th\": [ \"'var'\", \"Name\", \"Media type\", \"MIME-type\", \"Suggested generic instructions *\" ] }, { \"td\": [ \"audio_recog\", \"Audio Recognition\", \"audio\", \"audio/x-wav\", \"Describe the sound you hear\" ] }, { \"td\": [ \"ocr **\", \"Optical Character Recognition\", \"image\", \"image/jpeg\", \"Enter the text you see\" ] }, { \"td\": [ \"picture_q\", \"Picture Question\", \"image\", \"image/jpeg\", \"Answer the question you see\" ] }, { \"td\": [ \"picture_recog\", \"Picture Recognition\", \"image\", \"image/jpeg\", \"Identify the picture\" ] }, { \"td\": [ \"qa\", \"Text Question and Answer\", \"-\", \"-\", \"-\" ] }, { \"td\": [ \"speech_q\", \"Speech Question\", \"audio\", \"audio/x-wav\", \"Answer the question you hear\" ] }, { \"td\": [ \"speech_recog\", \"Speech Recognition\", \"audio\", \"audio/x-wav\", \"Enter the words you hear\" ] }, { \"td\": [ \"video_q\", \"Video Question\", \"video\", \"video/mpeg\", \"Answer the question in the video\" ] }, { \"td\": [ \"video_recog\", \"Video Recognition\", \"video\", \"video/mpeg\", \"Identify the video\" ] } ] } } ] }, { \"-anchor\": \"legacy\", \"-topic\": \"Question and Answer for Legacy Clients\", \"example\": [ { \"#text\": \"\\u003cmessage from='innocent@victim.com/pda'\\n to='robot@abuser.com/zombie'\\n xml:lang='en'\\n id='F3A6292C'\\u003e\\n \\u003cbody\\u003eYour messages to me are being blocked. To unblock them,\\n reply with the color of a stop light followed by 'F3A6292C'.\\u003c/body\\u003e\\n \\u003ccaptcha xmlns='urn:xmpp:captcha'\\u003e\\n \\u003cx xmlns='jabber:x:data' type='form'\\u003e\\n \\u003cfield type='hidden' var='FORM_TYPE'\\u003e\\n \\u003cvalue\\u003eurn:xmpp:captcha\\u003c/value\\u003e\\n \\u003c/field\\u003e\\n \\u003cfield type='hidden' var='from'\\u003e\\u003cvalue\\u003einnocent@victim.com\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='challenge'\\u003e\\u003cvalue\\u003eF3A6292C\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield type='hidden' var='sid'\\u003e\\u003cvalue\\u003espam1\\u003c/value\\u003e\\u003c/field\\u003e\\n \\u003cfield label='Type the color of a stop light' type='text-single' var='qa'/\\u003e\\n \\u003cfield label='93C7A' type='text-single' var='SHA-256'/\\u003e\\n \\u003c/x\\u003e\\n \\u003c/captcha\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Includes a Legacy Challenge\" }, { \"#text\": \"\\u003cmessage from='robot@abuser.com/zombie' to='innocent@victim.com/pda'\\u003e\\n \\u003cbody\\u003ered F3A6292C\\u003c/body\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Legacy Sender Responds\" }, { \"#text\": \"\\u003cmessage from='innocent@victim.com/pda' to='robot@abuser.com/zombie'\\u003e\\n \\u003cbody\\u003eYour message was delivered. Your messages\\n to me are no longer being blocked.\\u003c/body\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Tells Legacy Sender it Passed\" }, { \"#text\": \"\\u003cmessage type='error'\\n from='innocent@victim.com/pda'\\n to='robot@abuser.com/zombie'\\u003e\\n \\u003cerror type='cancel'\\u003e\\n \\u003cnot-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/\\u003e\\n \\u003ctext xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'\\u003e\\n Your message to me was not delivered.\\n \\u003c/text\\u003e\\n \\u003c/error\\u003e\\n\\u003c/message\\u003e\", \"-caption\": \"Challenger Tells Legacy Sender it Failed\" } ], \"p\": [ { \"#text\": \"A challenger MAY provide a text question in the \\u003cbody/\\u003e element of a challenge stanza for clients that do not support CAPTCHA forms. Entities that cannot serve\", \"cite\": \"Out-of-Band Data\" }, \"Note: Robots always attempt the easiest challenge they are offered. So the question MUST be at least as difficult for a robot as the CAPTCHA form.\", \"Note: Even if it provides a text question in the \\u003cbody/\\u003e element, a challenger MUST always provide a CAPTCHA form.\", \"Legacy clients respond to the challenger using a \\u003cmessage/\\u003e stanza (not an \\u003ciq/\\u003e).\", \"The challenger SHOULD treat the stanza as a normal message (instead of as a response to its challenge) if the legacy client either takes too long to submit it or has already responded to the challenge. The challenger MAY treat the response as a normal message even in cases where the challenge became unnecessary while the challenger was waiting for the response.\", \"Otherwise the challenger MUST report the result of the challenge to the legacy client using a \\u003cmessage/\\u003e stanza (not an \\u003ciq/\\u003e).\" ] }, { \"-anchor\": \"stop\", \"-topic\": \"Discontinuation Policy\", \"p\": [ { \"#text\": \"It is RECOMMENDED that entities employ other techniques to combat abusive stanzas in addition to those described in this document (e.g., see\", \"cite\": \"XEP-0161\", \"note\": { \"#text\": \"XEP-0205: Best Practices to Discourage Denial of Service Attacks \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/extensions/xep-0205.html\", \"-url\": \"https://xmpp.org/extensions/xep-0205.html\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Best Practices to Discourage Denial of Service Attacks (XEP-0205)\", \"-url\": \"https://xmpp.org/extensions/xep-0205.html\" } } }, \"It is expected that this protocol will be an important and successful tool for discouraging abusive traffic. However, much of its success is dependent on the quality of the CAPTCHAs and other puzzles employed by a particular implementation.\", \"The administrator of an application that functions as a challenger SHOULD discontinue the use of CAPTCHA forms under the following circumstances:\" ], \"ul\": { \"li\": [ \"If he realises that the challenger's challenges are largely ineffective in combating abusive traffic, and that the reduction in abuse does not compensate for the inconvenience to humans of responding to the challenger's challenges.\", { \"#text\": \"If other,\", \"em\": \"more transparent\" }, \"If the challenger needs no protection at all because it receives only a negligible amount of abusive traffic.\" ] } }, { \"-anchor\": \"i18n\", \"-topic\": \"Internationalization Considerations\", \"p\": { \"#text\": \"Each form field SHOULD include a 'label' attribute. If the sender did not include an 'xml:lang' attribute, then the challenger may not know the correct language for the labels. Therefore, depending on user preferences, the client that receives a challenge MAY present generic but localized text instead of label text that would not be understood by the user. Suggested generic text (to be suitably localized) is provided by\", \"link\": [ { \"#text\": \"Table 1\", \"-url\": \"#table-1\" }, { \"#text\": \"CAPTCHAs\", \"-url\": \"#challenge-captcha\" } ] } }, { \"-anchor\": \"sec\", \"-topic\": \"Security Considerations\", \"p\": { \"#text\": \"The use of CAPTCHAs is not a panacea, and should be combined with other anti-abuse mechanisms, such as those described in\", \"cite\": [ \"XEP-0161\", \"XEP-0205\" ] } }, { \"-anchor\": \"iana\", \"-topic\": \"IANA Considerations\", \"p\": { \"#text\": \"This document requires no interaction with the\", \"note\": { \"#text\": \"The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see \\u003c\", \"link\": { \"#text\": \"http://www.iana.org/\", \"-url\": \"http://www.iana.org/\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"Internet Assigned Numbers Authority (IANA)\", \"-url\": \"http://www.iana.org/\" } } } }, { \"-anchor\": \"registrar\", \"-topic\": \"XMPP Registrar Considerations\", \"section2\": [ { \"-anchor\": \"ns\", \"-topic\": \"Protocol Namespaces\", \"p\": { \"#text\": \"The\", \"link\": { \"#text\": \"https://xmpp.org/registrar/namespaces.html\", \"-url\": \"https://xmpp.org/registrar/namespaces.html\" }, \"note\": { \"#text\": \"The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see \\u003c\", \"link\": { \"#text\": \"https://xmpp.org/registrar/\", \"-url\": \"https://xmpp.org/registrar/\" } }, \"span\": { \"-class\": \"ref\", \"link\": { \"#text\": \"XMPP Registrar\", \"-url\": \"https://xmpp.org/registrar/\" } } } }, { \"-anchor\": \"registrar-formtypes\", \"-topic\": \"Field Standardization\", \"section3\": [ { \"-anchor\": \"registrar-formtypes-captcha\", \"-topic\": \"CAPTCHA FORM_TYPE\", \"code\": \"\\u003cform_type\\u003e\\n \\u003cname\\u003eurn:xmpp:captcha\\u003c/name\\u003e\\n \\u003cdoc\\u003eXEP-0158\\u003c/doc\\u003e\\n \\u003cdesc\\u003eForms enabling the use of CAPTCHAs.\\u003c/desc\\u003e\\n \\u003cfield\\n var='answers'\\n type='hidden'\\n label='number of answers required'/\\u003e\\n \\u003cfield\\n var='audio_recog'\\n type='text-single'\\n label='text associated with a sound'/\\u003e\\n \\u003cfield\\n var='challenge'\\n type='hidden'\\n label='challenge ID'/\\u003e\\n \\u003cfield\\n var='from'\\n type='hidden'\\n label='to attribute of stanza that triggered challenge'/\\u003e\\n \\u003cfield\\n var='ocr'\\n type='text-single'\\n label='code appearing in an image'/\\u003e\\n \\u003cfield\\n var='picture_q'\\n type='text-single'\\n label='answer associated with a picture'/\\u003e\\n \\u003cfield\\n var='picture_recog'\\n type='text-single'\\n label='text associated with a picture'/\\u003e\\n \\u003cfield\\n var='qa'\\n type='text-single'\\n label='answer to a question'/\\u003e\\n \\u003cfield\\n var='SHA-256'\\n type='text-single'\\n label='least significant bits of SHA-256 hash of text should equal hexadecimal label'/\\u003e\\n \\u003cfield\\n var='sid'\\n type='hidden'\\n label='stanza ID'/\\u003e\\n \\u003cfield\\n var='speech_q'\\n type='text-single'\\n label='answer associated with speech'/\\u003e\\n \\u003cfield\\n var='speech_recog'\\n type='text-single'\\n label='text associated with speech'/\\u003e\\n \\u003cfield\\n var='video_q'\\n type='text-single'\\n label='answer associated with a video'/\\u003e\\n \\u003cfield\\n var='video_recog'\\n type='text-single'\\n label='text associated with a video'/\\u003e\\n\\u003c/form_type\\u003e\", \"p\": { \"#text\": \"The\", \"cite\": \"XMPP Registrar\" } }, { \"-anchor\": \"registrar-formtypes-register\", \"-topic\": \"jabber:iq:register FORM_TYPE\", \"code\": \"\\u003cform_type\\u003e\\n \\u003cname\\u003ejabber:iq:register\\u003c/name\\u003e\\n \\u003cdoc\\u003eXEP-0077\\u003c/doc\\u003e\\n \\u003cfield\\n var='answers'\\n type='hidden'\\n label='number of answers required'/\\u003e\\n \\u003cfield\\n var='audio_recog'\\n type='text-single'\\n label='text associated with a sound'/\\u003e\\n \\u003cfield\\n var='challenge'\\n type='hidden'\\n label='challenge ID'/\\u003e\\n \\u003cfield\\n var='ocr'\\n type='text-single'\\n label='code appearing in an image'/\\u003e\\n \\u003cfield\\n var='picture_q'\\n type='text-single'\\n label='answer associated with a picture'/\\u003e\\n \\u003cfield\\n var='picture_recog'\\n type='text-single'\\n label='text associated with a picture'/\\u003e\\n \\u003cfield\\n var='qa'\\n type='text-single'\\n label='answer to a question'/\\u003e\\n \\u003cfield\\n var='SHA-256'\\n type='text-single'\\n label='least significant bits of SHA-256 hash of text should equal hexadecimal label'/\\u003e\\n \\u003cfield\\n var='sid'\\n type='hidden'\\n label='stanza ID'/\\u003e\\n \\u003cfield\\n var='speech_q'\\n type='text-single'\\n label='answer associated with speech'/\\u003e\\n \\u003cfield\\n var='speech_recog'\\n type='text-single'\\n label='text associated with speech'/\\u003e\\n \\u003cfield\\n var='video_q'\\n type='text-single'\\n label='answer associated with a video'/\\u003e\\n \\u003cfield\\n var='video_recog'\\n type='text-single'\\n label='text associated with a video'/\\u003e\\n\\u003c/form_type\\u003e\", \"p\": { \"#text\": \"The\", \"cite\": \"XMPP Registrar\" } } ] } ] }, { \"-anchor\": \"schema\", \"-topic\": \"XML Schema\", \"code\": \"\\u003c?xml version='1.0' encoding='UTF-8'?\\u003e\\n\\n\\u003cxs:schema\\n xmlns:xs='http://www.w3.org/2001/XMLSchema'\\n targetNamespace='urn:xmpp:captcha'\\n xmlns='urn:xmpp:captcha'\\n elementFormDefault='qualified'\\u003e\\n\\n \\u003cxs:annotation\\u003e\\n \\u003cxs:documentation\\u003e\\n The protocol documented by this schema is defined in\\n XEP-0158: http://xmpp.org/extensions/xep-0158.html\\n \\u003c/xs:documentation\\u003e\\n \\u003c/xs:annotation\\u003e\\n\\n \\u003cxs:import namespace='jabber:x:data'\\n schemaLocation='http://xmpp.org/schemas/x-data.xsd'/\\u003e\\n\\n \\u003cxs:element name='captcha'\\u003e\\n \\u003cxs:complexType\\u003e\\n \\u003cxs:sequence xmlns:xdata='jabber:x:data'\\u003e\\n \\u003cxs:element ref='xdata:x' minOccurs='1' maxOccurs='1'/\\u003e\\n \\u003c/xs:sequence\\u003e\\n \\u003c/xs:complexType\\u003e\\n \\u003c/xs:element\\u003e\\n\\n\\u003c/xs:schema\\u003e\" }, { \"-anchor\": \"open\", \"-topic\": \"Open Issues\", \"p\": \"Another protocol could allow users to edit the challenges their server will make on their behalf. For example, the number of SHA-256 bits, a personal or original question and answer, a picture, a video, or a sound recording. Of course Aunt Tillie would typically use this feature only if she was plagued by abusive traffic.\" } ] } planned ","wordCount":"19232","inLanguage":"en","datePublished":"2022-03-12T08:09:44+01:00","dateModified":"2024-05-26T05:01:17+02:00","author":{"@type":"Person","name":"Monal"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://monal-im.github.io/monal-im.org/site/install/"},"publisher":{"@type":"Organization","name":"Monal","logo":{"@type":"ImageObject","url":"https://monal-im.github.io/monal-im.org/site/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://monal-im.github.io/monal-im.org/site/ accesskey=h title="Monal (Alt + H)">Monal</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li class=menu-item><a href=/monal-im.org/site/install/ title=Install><span class=active>Install</span></a></li><li class=menu-item><a href=/monal-im.org/site/support/ title=Support><span>Support</span></a></li><li class=menu-item><a href=/monal-im.org/site/post/ title=Blog><span>Blog</span></a></li><li class=menu-item><a href=/monal-im.org/site/publications/ title=Publications><span>Publications</span></a></li><li class=menu-item><a href=/monal-im.org/site/privacy/ title=Privacy><span>Privacy</span></a></li><li class=menu-item><a href=/monal-im.org/site/about/ title=About><span>About</span></a></li><li class=menu-item><a href=https://github.com/monal-im/Monal/wiki/FAQ---Frequently-Asked-Questions title=FAQ><span>FAQ</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li class=menu-item><a href=/monal-im.org/site/search/ title="Search 🔍 (Alt + /)" accesskey=/><span>Search 🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Install</h1><div class=post-meta><span title='2022-03-12 08:09:44 +0100 +0100'>12.03.2022</span>&nbsp;·&nbsp;91 min&nbsp;·&nbsp;Monal<a href=/index.xml rel="noopener noreferrer" target=_blank>&nbsp;RSS</a>&nbsp;|&nbsp;<a href=https://github.com/monal-im/monal-im.org/tree/staging/content/install.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><table><thead><tr><th></th><th>iOS</th><th>macOS</th><th>macOS (homebrew)</th></tr></thead><tbody><tr><td>Stable</td><td><a href=https://apps.apple.com/app/id317711500>App Store</a></td><td><a href=https://apps.apple.com/app/id1637078500>App Store</a></td><td>brew install --cask monal</td></tr><tr><td>Beta</td><td><a href=https://testflight.apple.com/join/lLLlgHpB>Testflight Invitation</a></td><td><a href=https://testflight.apple.com/join/tGH2m5vf>Testflight Invitation</a></td><td>brew install --cask monal@beta</td></tr><tr><td>Alpha</td><td>upon request to <a href=mailto:info@monal-im.org>info@monal-im.org</a><br>Then download from our <a href=https://downloads.monal-im.org/monal-im/alpha/>alpha download site</a></td><td></td><td>brew tap monal-im/homebrew-monal-alpha<br>brew install --cask monal-alpha</td></tr></tbody></table><h1 id=features>Features<a hidden class=anchor aria-hidden=true href=#features>#</a></h1><p>Monal currently covers the following chat features:</p><ul><li>Decentralised and federated chat standard <a href=https://xmpp.org/>XMPP</a></li><li>Private and group messaging</li><li>Privacy-respecting push notifications</li><li>Encrypted private and group chats (state-of-the-art encryption (<a href=https://conversations.im/omemo/>OMEMO</a>)</li><li>Message history</li><li>Free selection of your XMPP account provider</li><li>Voice messaging</li><li>Message archiving</li><li>Upload of files, videos and images (HTTP Upload)</li><li>Audio and Video calls</li><li>Many settings and a design to offer privacy settings in the app to the need of the user</li><li>A detailed and technical listing of your supported features (so called XMPP Extensions) can be found in our <a href=https://github.com/monal-im/Monal/blob/develop/monal.doap>DOAP file</a>.</li></ul><h2 id=planned-features>Planned features<a hidden class=anchor aria-hidden=true href=#planned-features>#</a></h2><ul><li>User-interface overhaul</li></ul><h2 id=implemented-xeps>Implemented XEPs<a hidden class=anchor aria-hidden=true href=#implemented-xeps>#</a></h2><table><thead><tr><th>XEP</th><th>Status</th><th>Since</th></tr></thead><tr><td><a href=https://xmpp.org/extensions/xep-0004.html>xep-0004</a></td><td>complete</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0030.html>xep-0030</a></td><td>complete</td><td>4.6</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0045.html>xep-0045</a></td><td>partial</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0048.html>xep-0048</a></td><td>complete</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0054.html>xep-0054</a><br>Implemented only for MUC profiles</td><td>complete</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0059.html>xep-0059</a></td><td>complete</td><td>4.8</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0060.html>xep-0060</a><br>Used mainly for Pep</td><td>partial</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0066.html>xep-0066</a><br>Used to mark XEP-0363 filetransfers only</td><td>partial</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0077.html>xep-0077</a></td><td>partial</td><td>4.7</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0084.html>xep-0084</a></td><td>complete</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0085.html>xep-0085</a><br>Only typing notifications, use XEP-0319 to publish interactions</td><td>partial</td><td>4.7</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0092.html>xep-0092</a></td><td>complete</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0115.html>xep-0115</a></td><td>complete</td><td>4.7</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0153.html>xep-0153</a><br>XEP-0153: vCard-Based Avatars (implemented only for MUC profiles)</td><td>partial</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0162.html>xep-0162</a></td><td>partial</td><td>5.4</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0163.html>xep-0163</a></td><td>complete</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0167.html>xep-0167</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0176.html>xep-0176</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0172.html>xep-0172</a></td><td>complete</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0184.html>xep-0184</a></td><td>complete</td><td>4.7</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0191.html>xep-0191</a></td><td>complete</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0198.html>xep-0198</a></td><td>complete</td><td>4.6</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0199.html>xep-0199</a></td><td>complete</td><td>4.7</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0215.html>xep-0215</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0223.html>xep-0223</a><br>XEP-0223: Persistent Storage of Private Data via PubSub</td><td>complete</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0237.html>xep-0237</a></td><td>complete</td><td>4.6</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0245.html>xep-0245</a></td><td>complete</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0249.html>xep-0249</a><br>XEP-0249: Direct MUC Invitations</td><td>complete</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0280.html>xep-0280</a></td><td>complete</td><td>4.5</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0286.html>xep-0286</a></td><td>complete</td><td>4.7</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0293.html>xep-0293</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0294.html>xep-0294</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0305.html>xep-0305</a></td><td>complete</td><td>5.1.1</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0308.html>xep-0308</a></td><td>complete</td><td>4.8</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0313.html>xep-0313</a></td><td>complete</td><td>4.8</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0319.html>xep-0319</a></td><td>complete</td><td>4.7</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0320.html>xep-0320</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0333.html>xep-0333</a></td><td>complete</td><td>4.8</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0338.html>xep-0338</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0339.html>xep-0339</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0352.html>xep-0352</a></td><td>complete</td><td>4.7</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0353.html>xep-0353</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0357.html>xep-0357</a></td><td>complete</td><td>4.8</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0359.html>xep-0359</a></td><td>complete</td><td>4.8</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0363.html>xep-0363</a></td><td>complete</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0368.html>xep-0368</a></td><td>complete</td><td>4.6</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0379.html>xep-0379</a><br>No automatic approval if server does not support subscription pre-approval; No checking of tokens, if server does not do so (XEP-0401)</td><td>partial</td><td>4.9</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0380.html>xep-0380</a></td><td>complete</td><td>5.1</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0384.html>xep-0384</a></td><td>complete</td><td>4.8</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0388.html>xep-0388</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0392.html>xep-0392</a></td><td>complete</td><td>5.1</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0398.html>xep-0398</a><br>Used for MUC avatars</td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0401.html>xep-0401</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0402.html>xep-0402</a></td><td>complete</td><td>5.4</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0410.html>xep-0410</a></td><td>complete</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0423.html>xep-0423</a><br>Check this XEP to see what's missing</td><td>partial</td><td></td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0424.html>xep-0424</a></td><td>complete</td><td>6.3</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0425.html>xep-0425</a></td><td>complete</td><td>6.3</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0440.html>xep-0440</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0441.html>xep-0441</a><br>Only to automatically turn on archiving if possible (setting: always)</td><td>complete</td><td>4.8</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0445.html>xep-0445</a></td><td>complete</td><td>5.2</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0454.html>xep-0454</a><br>No support for embedded thumbnails</td><td>partial</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0474.html>xep-0474</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0480.html>xep-0480</a></td><td>complete</td><td>6.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0486.html>xep-0486</a></td><td>complete</td><td>5.0</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0490.html>xep-0490</a></td><td>complete</td><td>6.3</td><tr></table><h2 id=planned-xeps>Planned XEPs<a hidden class=anchor aria-hidden=true href=#planned-xeps>#</a></h2><table><thead><tr><th>XEP</th><th>Status</th></tr></thead><tr><td><a href=https://xmpp.org/extensions/xep-0158.html>xep-0158:<pre>{
  &#34;-xmlns&#34;: &#34;&#34;,
  &#34;header&#34;: {
    &#34;abstract&#34;: &#34;This document specifies an XMPP protocol extension that entities may use to discover whether the sender of an XML stanza is a human user or a robot.&#34;,
    &#34;approver&#34;: &#34;Council&#34;,
    &#34;author&#34;: [
      {
        &#34;email&#34;: &#34;ian.paterson@clientside.co.uk&#34;,
        &#34;firstname&#34;: &#34;Ian&#34;,
        &#34;jid&#34;: &#34;ian@zoofy.com&#34;,
        &#34;surname&#34;: &#34;Paterson&#34;
      },
      {
        &#34;email&#34;: &#34;stpeter@stpeter.im&#34;,
        &#34;firstname&#34;: &#34;Peter&#34;,
        &#34;jid&#34;: &#34;stpeter@jabber.org&#34;,
        &#34;surname&#34;: &#34;Saint-Andre&#34;,
        &#34;uri&#34;: &#34;https://stpeter.im/&#34;
      }
    ],
    &#34;dependencies&#34;: {
      &#34;spec&#34;: [
        &#34;XMPP Core&#34;,
        &#34;XMPP IM&#34;,
        &#34;XEP-0004&#34;,
        &#34;XEP-0066&#34;,
        &#34;XEP-0221&#34;
      ]
    },
    &#34;legal&#34;: {
      &#34;conformance&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol has been contributed in full conformance with the XSF&#39;s Intellectual Property Rights Policy (a copy of which can be found at \u003c&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;
        }
      },
      &#34;copyright&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol is copyright © 1999 – 2024 by the&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;XMPP Standards Foundation&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/&#34;
        }
      },
      &#34;liability&#34;: &#34;In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.&#34;,
      &#34;permissions&#34;: &#34;Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \&#34;Specification\&#34;), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.&#34;,
      &#34;warranty&#34;: &#34;## NOTE WELL: This Specification is provided on an \&#34;AS IS\&#34; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##&#34;
    },
    &#34;number&#34;: &#34;0158&#34;,
    &#34;revision&#34;: [
      {
        &#34;date&#34;: &#34;2019-11-07&#34;,
        &#34;initials&#34;: &#34;egp, mb&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Use the correct FORM_TYPE for extended IBR, and use a proper MUC join as an example. Also fix typos.&#34;
        },
        &#34;version&#34;: &#34;1.0.1&#34;
      },
      {
        &#34;date&#34;: &#34;2008-09-03&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Per a vote of the XMPP Council, advanced status to Draft; concurrently, the XMPP Registrar issued the urn:xmpp:captcha namespace; also changed element name from challenge to captcha in order to match the namespace name.&#34;
        },
        &#34;version&#34;: &#34;1.0&#34;
      },
      {
        &#34;date&#34;: &#34;2008-08-06&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Further modified examples to track changes to XEP-0231.&#34;
        },
        &#34;version&#34;: &#34;0.11&#34;
      },
      {
        &#34;date&#34;: &#34;2008-08-06&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Modified examples to track changes to XEP-0231; to avoid confusion with cid URIs, changed name of challenge ID form field from cid to challenge.&#34;
        },
        &#34;version&#34;: &#34;0.10&#34;
      },
      {
        &#34;date&#34;: &#34;2008-05-12&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Specified that cid field is required; more clearly defined structure of challenge stanza; added several security considerations; corrected several errors in the text and examples.&#34;
        },
        &#34;version&#34;: &#34;0.9&#34;
      },
      {
        &#34;date&#34;: &#34;2008-05-12&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Moved text regarding labels to new internationalization considerations section; removed necessity that ID of IQ-set shall match ID of challenge, since this is not consistent with existing usage that IDs are generated by the sender of an IQ.&#34;
        },
        &#34;version&#34;: &#34;0.8&#34;
      },
      {
        &#34;date&#34;: &#34;2008-04-28&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Generalized text to cover abuse rather than just spim; modified temporary namespace to adhere to XMPP Registrar procedures; added use case for joining multi-user chat rooms.&#34;
        },
        &#34;version&#34;: &#34;0.7&#34;
      },
      {
        &#34;date&#34;: &#34;2007-07-11&#34;,
        &#34;initials&#34;: &#34;psa/ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Moved media element definition to XEP-0221; consistently used the terms sender and challenger rather than client and entity; modified provisional namespaces to adhere to XMPP Registrar policies; completed editorial review.&#34;
        },
        &#34;version&#34;: &#34;0.6&#34;
      },
      {
        &#34;date&#34;: &#34;2006-10-30&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Added reference to SPIM Reporting.&#34;
        },
        &#34;version&#34;: &#34;0.5&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-30&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Required WAV instead of MP3 for audio CAPTCHAs; minor corrections.&#34;
        },
        &#34;version&#34;: &#34;0.4&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-28&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Added more CAPTCHA types and the legacy question and answer section.&#34;
        },
        &#34;version&#34;: &#34;0.3&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-14&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Minor fixes.&#34;
        },
        &#34;version&#34;: &#34;0.2&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-14&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Initial version.&#34;
        },
        &#34;version&#34;: &#34;0.1&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-07&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;First draft.&#34;
        },
        &#34;version&#34;: &#34;0.0.1&#34;
      }
    ],
    &#34;schemaloc&#34;: {
      &#34;url&#34;: &#34;http://xmpp.org/schemas/captcha.xsd&#34;
    },
    &#34;shortname&#34;: &#34;captcha&#34;,
    &#34;sig&#34;: &#34;Standards&#34;,
    &#34;status&#34;: &#34;Draft&#34;,
    &#34;supersededby&#34;: &#34;&#34;,
    &#34;supersedes&#34;: &#34;&#34;,
    &#34;title&#34;: &#34;CAPTCHA Forms&#34;,
    &#34;type&#34;: &#34;Standards Track&#34;
  },
  &#34;section1&#34;: [
    {
      &#34;-anchor&#34;: &#34;intro&#34;,
      &#34;-topic&#34;: &#34;Introduction&#34;,
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;The appearance of large public IM services based on&#34;,
          &#34;em&#34;: &#34;discourage&#34;,
          &#34;note&#34;: [
            {
              &#34;#text&#34;: &#34;RFC 6120: Extensible Messaging and Presence Protocol (XMPP): Core \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;RFC 6121: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;
              }
            }
          ],
          &#34;span&#34;: [
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;XMPP Core&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;XMPP IM&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;
              }
            }
          ]
        },
        {
          &#34;#text&#34;: &#34;One technique developed to combat abusive messages and behavior via non-XMPP technologies requires humans to be differentiated from bots using a \&#34;Completely Automated Public Turing Test to Tell Computers and Humans Apart\&#34; or CAPTCHA (see \u003c&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;http://www.captcha.net/&#34;,
            &#34;-url&#34;: &#34;http://www.captcha.net/&#34;
          }
        },
        {
          &#34;#text&#34;: &#34;An alternative technique to CAPTCHAs requires Desktop PC clients to undertake a&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;Hashcash \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;http://hashcash.org/&#34;,
              &#34;-url&#34;: &#34;http://hashcash.org/&#34;
            }
          },
          &#34;span&#34;: {
            &#34;#text&#34;: &#34;Hashcash&#34;,
            &#34;-class&#34;: &#34;ref&#34;
          }
        },
        &#34;Both CAPTCHAs and hashcash have been criticized regarding their effectiveness (or lack thereof). Therefore, the challenge protocol specified herein provides a great deal of flexibility, so that challenges can include CAPTCHAs, hashcash, word puzzles, so-called kitten authentication, and any other mechanism that may be developed in the future.&#34;,
        {
          &#34;#text&#34;: &#34;The generic challenge protocol described in this document is designed for incorporation into protocols such as&#34;,
          &#34;note&#34;: [
            {
              &#34;#text&#34;: &#34;XEP-0077: In-Band Registration \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0077.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0077.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0045: Multi-User Chat \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0045.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0045.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0016: Privacy Lists \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0016.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0016.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0159: SPIM-Blocking Control \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0159.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0159.html&#34;
              }
            }
          ],
          &#34;span&#34;: [
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;In-Band Registration (XEP-0077)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0077.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Multi-User Chat (XEP-0045)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0045.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Privacy Lists (XEP-0016)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0016.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;SPIM-Blocking Control (XEP-0159)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0159.html&#34;
              }
            }
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;require&#34;,
      &#34;-topic&#34;: &#34;Requirements&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;require-extend&#34;,
          &#34;-topic&#34;: &#34;Extensibility&#34;,
          &#34;p&#34;: &#34;The CAPTCHAs in most common use today are Optical Character Recognition (OCR) challenges where an image containing deformed text is presented and the human enters the characters they can read. However, if OCR software advances more rapidly than the techniques used to disguise text from Artificial Intelligence (AI) then very different CAPTCHAs will need to be deployed. This protocol must be extensible enough to allow the incorporation of CAPTCHA techniques that may not have been envisaged.&#34;
        },
        {
          &#34;-anchor&#34;: &#34;require-variety&#34;,
          &#34;-topic&#34;: &#34;Variety&#34;,
          &#34;p&#34;: {
            &#34;#text&#34;: &#34;Several common CAPTCHA techniques present major problems to users with disabilities (see&#34;,
            &#34;note&#34;: {
              &#34;#text&#34;: &#34;Inaccessibility of Visually-Oriented Anti-Robot Tests \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;http://www.w3.org/TR/turingtest/&#34;,
                &#34;-url&#34;: &#34;http://www.w3.org/TR/turingtest/&#34;
              }
            },
            &#34;span&#34;: {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Inaccessibility of Visually-Oriented Anti-Robot Tests&#34;,
                &#34;-url&#34;: &#34;http://www.w3.org/TR/turingtest/&#34;
              }
            }
          }
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;protocol&#34;,
      &#34;-topic&#34;: &#34;Protocol&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;protocol-simple&#34;,
          &#34;-topic&#34;: &#34;Simple Challenge&#34;,
          &#34;section3&#34;: [
            {
              &#34;-anchor&#34;: &#34;protocol-trigger&#34;,
              &#34;-topic&#34;: &#34;Triggering Stanza&#34;,
              &#34;example&#34;: {
                &#34;#text&#34;: &#34;\u003cmessage from=&#39;robot@abuser.com/zombie&#39;\n    to=&#39;innocent@victim.com&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;spam1&#39;\u003e\n  \u003cbody\u003eLove pills - 75% OFF\u003c/body\u003e\n  \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n    \u003curl\u003ehttp://www.abuser.com/lovepills.html\u003c/url\u003e\n  \u003c/x\u003e\n\u003c/message\u003e&#34;,
                &#34;-caption&#34;: &#34;Sender Generates Triggering Stanza&#34;
              },
              &#34;p&#34;: &#34;A \&#34;triggering stanza\&#34; is an XMPP \u003cmessage/\u003e, \u003cpresence/\u003e, or \u003ciq/\u003e stanza that is deemed abusive by the receiving entity (e.g., a client) or an intermediate router (e.g., a server). The entity that generates a triggering stanza is called a \&#34;sender\&#34;.&#34;
            },
            {
              &#34;-anchor&#34;: &#34;protocol-challenge&#34;,
              &#34;-topic&#34;: &#34;Challenge Stanza&#34;,
              &#34;example&#34;: {
                &#34;#text&#34;: &#34;\u003cmessage from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;F3A6292C&#39;\u003e\n  \u003cbody\u003e\n    Your messages to innocent@victim.com are being blocked. To unblock\n    them, visit http://www.victim.com/challenge.html?F3A6292C\n  \u003c/body\u003e\n  \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n    \u003curl\u003ehttp://www.victim.com/challenge.html?F3A6292C\u003c/url\u003e\n  \u003c/x\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;sid&#39;\u003e\u003cvalue\u003espam1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39; label=&#39;Enter the text you see&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;80&#39;\n               width=&#39;290&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/ocr.jpeg?F3A6292C\n          \u003c/uri\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            cid:sha1&#43;f24030b8d91d233bac14777be5ab531ca3b9f102@bob.xmpp.org\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;picture_recog&#39; label=&#39;Identify the picture&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;150&#39;\n               width=&#39;150&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/picture.jpeg?F3A6292C\n          \u003c/uri\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            cid:sha1&#43;f2377f3a3287eac81028243079e1aa9905c466bc@bob.xmpp.org\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;speech_recog&#39; label=&#39;Enter the words you hear&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\u003e\n          \u003curi type=&#39;audio/x-wav&#39;\u003e\n            http://www.victim.com/challenges/speech.wav?F3A6292C\n          \u003c/uri\u003e\n          \u003curi type=&#39;audio/ogg-speex&#39;\u003e\n            http://www.victim.com/challenges/speech.ogg?F3A6292C\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;video_recog&#39; label=&#39;Identity the video&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;150&#39;\n               width=&#39;150&#39;\u003e\n          \u003curi type=&#39;video/mpeg&#39;\u003e\n            http://www.victim.com/challenges/video.mpeg?F3A6292C\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;Type the color of a stop light&#39; type=&#39;text-single&#39; var=&#39;qa&#39;/\u003e\n      \u003cfield label=&#39;93C7A&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/message\u003e&#34;,
                &#34;-caption&#34;: &#34;Challenger Offers a Choice of Challenges to Sender&#34;
              },
              &#34;ol&#34;: {
                &#34;li&#34;: [
                  &#34;The challenge stanza MUST include an &#39;id&#39; attribute set to the challenge ID (i.e., a unique identifier for this challenge within the challenger&#39;s application).&#34;,
                  &#34;The challenge stanza SHOULD include a \u003cbody/\u003e element that provides an explanation of the challenge for clients that do not yet support CAPTCHA forms.&#34;,
                  {
                    &#34;#text&#34;: &#34;The challenge stanza MAY include a URL (typically a Web page with instructions) using&#34;,
                    &#34;note&#34;: {
                      &#34;#text&#34;: &#34;XEP-0066: Out of Band Data \u003c&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;
                      }
                    },
                    &#34;span&#34;: {
                      &#34;-class&#34;: &#34;ref&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Out-of-Band Data (XEP-0066)&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;
                      }
                    }
                  },
                  &#34;The &#39;xml:lang&#39; attribute of the challenge stanza SHOULD be the same as the one received from the sender, if any.&#34;,
                  {
                    &#34;#text&#34;: &#34;The challenge stanza MUST include a CAPTCHA form, i.e., a data form of type \&#34;form\&#34; containing one or more challenges.&#34;,
                    &#34;note&#34;: &#34;Inclusion of a CAPTCHA form not only makes it possible to flexibly support or require a large number of challenge types, but also enables constrained clients to respond to challenges (e.g., mobile phone clients that cannot present web pages, or clients on XMPP-only networks).&#34;
                  },
                  {
                    &#34;#text&#34;: &#34;The CAPTCHA form MUST include a hidden field named \&#34;FORM_TYPE\&#34; (in accordance with&#34;,
                    &#34;note&#34;: {
                      &#34;#text&#34;: &#34;XEP-0068: Field Data Standardization for Data Forms \u003c&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0068.html&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0068.html&#34;
                      }
                    },
                    &#34;span&#34;: {
                      &#34;-class&#34;: &#34;ref&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Field Standardization for Data Forms (XEP-0068)&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0068.html&#34;
                      }
                    }
                  },
                  &#34;The CAPTCHA form MUST include a hidden field named \&#34;challenge\&#34; set to the challenge ID.&#34;,
                  &#34;The CAPTCHA form MUST include a hidden field named \&#34;from\&#34; set to the value of the &#39;to&#39; attribute from the triggering stanza.&#34;,
                  &#34;If the triggering stanza included an &#39;id&#39; attribute, then the CAPTCHA form MUST include a hidden field named \&#34;sid\&#34; set to that value.&#34;,
                  &#34;Each of the CAPTCHA form&#39;s non-hidden \u003cfield/\u003e elements MAY contain a different challenge.&#34;,
                  {
                    &#34;#text&#34;: &#34;Each CAPTCHA field MAY contain a media element (see&#34;,
                    &#34;note&#34;: {
                      &#34;#text&#34;: &#34;XEP-0221: Data Forms Media Element \u003c&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0221.html&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0221.html&#34;
                      }
                    },
                    &#34;span&#34;: {
                      &#34;-class&#34;: &#34;ref&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Data Forms Media Element (XEP-0221)&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0221.html&#34;
                      }
                    }
                  }
                ]
              },
              &#34;p&#34;: [
                &#34;Upon receiving a triggering stanza, an entity MAY send a \&#34;challenge stanza\&#34;. An entity MUST NOT send a challenge stanza under any other circumstances. The entity that generates the challenge stanza is called the \&#34;challenger\&#34;.&#34;,
                {
                  &#34;#text&#34;: &#34;The challenge stanza consists of an XMPP \u003cmessage/\u003e stanza containing a data form for the sender to fill out, formatted according to&#34;,
                  &#34;note&#34;: {
                    &#34;#text&#34;: &#34;XEP-0004: Data Forms \u003c&#34;,
                    &#34;link&#34;: {
                      &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0004.html&#34;,
                      &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0004.html&#34;
                    }
                  },
                  &#34;span&#34;: {
                    &#34;-class&#34;: &#34;ref&#34;,
                    &#34;link&#34;: {
                      &#34;#text&#34;: &#34;Data Forms (XEP-0004)&#34;,
                      &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0004.html&#34;
                    }
                  }
                },
                {
                  &#34;#text&#34;: &#34;The sender then would retrieve the media data via HTTP or (for the cid: URIs) via XMPP as described in&#34;,
                  &#34;note&#34;: {
                    &#34;#text&#34;: &#34;XEP-0231: Bits of Binary \u003c&#34;,
                    &#34;link&#34;: {
                      &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0231.html&#34;,
                      &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0231.html&#34;
                    }
                  },
                  &#34;span&#34;: {
                    &#34;-class&#34;: &#34;ref&#34;,
                    &#34;link&#34;: {
                      &#34;#text&#34;: &#34;Bits of Binary (XEP-0231)&#34;,
                      &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0231.html&#34;
                    }
                  }
                }
              ]
            },
            {
              &#34;-anchor&#34;: &#34;protocol-response&#34;,
              &#34;-topic&#34;: &#34;Response Stanza&#34;,
              &#34;example&#34;: [
                {
                  &#34;#text&#34;: &#34;\u003cmessage type=&#39;error&#39;\n    from=&#39;robot@abuser.com/zombie&#39;\n    to=&#39;victim.com&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;F3A6292C&#39;\u003e\n  \u003cerror type=&#39;modify&#39;\u003e\n    \u003cnot-acceptable xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;/\u003e\n  \u003c/error\u003e\n\u003c/message\u003e&#34;,
                  &#34;-caption&#34;: &#34;Sender Reports Challenge Not Acceptable&#34;
                },
                {
                  &#34;#text&#34;: &#34;\u003ciq type=&#39;set&#39;\n    from=&#39;robot@abuser.com/zombie&#39;\n    to=&#39;victim.com&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;z140r0s&#39;\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;submit&#39;\u003e\n      \u003cfield var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;sid&#39;\u003e\u003cvalue\u003espam1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39;\u003e\u003cvalue\u003e7nHL3\u003c/value\u003e\u003c/field\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/iq\u003e&#34;,
                  &#34;-caption&#34;: &#34;Sender Sends One Response to Challenger&#34;
                }
              ],
              &#34;p&#34;: [
                &#34;The sender&#39;s client SHOULD ignore the challenge stanza in either of the following cases:&#34;,
                {
                  &#34;#text&#34;: &#34;Otherwise, if the challenger provided a URL using&#34;,
                  &#34;cite&#34;: &#34;Out-of-Band Data&#34;
                },
                &#34;Otherwise, the sender&#39;s client MUST respond to the challenge.&#34;,
                &#34;The sender&#39;s client MUST respond with a \u003cnot-acceptable/\u003e error in any of the following cases:&#34;,
                &#34;Otherwise, it MUST select one challenge according to the sender&#39;s preferences and submit the sender&#39;s response form to the challenger.&#34;
              ],
              &#34;ul&#34;: [
                {
                  &#34;li&#34;: [
                    {
                      &#34;#text&#34;: &#34;If it has not recently sent (e.g., in the last two minutes) a stanza to the JID specified in the &#39;from&#39; field of the form with the &#39;id&#39; specified in the &#39;sid&#39; field (or with no &#39;id&#39; if no &#39;sid&#39; field is included).&#34;,
                      &#34;note&#34;: &#34;Otherwise the user&#39;s presence would be disclosed, or a robot might dupe the user into providing answers to other people&#39;s challenges!&#34;
                    },
                    &#34;If the &#39;from&#39; attribute of the challenge stanza does not match the &#39;from&#39; field of the form. (If the values are different, then they still match if the bare JIDs are the same, or if the &#39;from&#39; attribute is the domain of the other JID.)&#34;
                  ]
                },
                {
                  &#34;li&#34;: [
                    &#34;if it does not understand the CAPTCHA form&#34;,
                    {
                      &#34;#text&#34;: &#34;if it does not support all of the&#34;,
                      &#34;em&#34;: &#34;required&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Multiple Challenges&#34;,
                        &#34;-url&#34;: &#34;#protocol-multiple&#34;
                      }
                    },
                    {
                      &#34;#text&#34;: &#34;if it does not support enough of the challenges (see&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Multiple Challenges&#34;,
                        &#34;-url&#34;: &#34;#protocol-multiple&#34;
                      }
                    }
                  ]
                },
                {
                  &#34;li&#34;: [
                    {
                      &#34;#text&#34;: &#34;if it does not support all of the required challenges (see&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Multiple Challenges&#34;,
                        &#34;-url&#34;: &#34;#protocol-multiple&#34;
                      }
                    },
                    {
                      &#34;#text&#34;: &#34;if it does not support enough of the challenges (see&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Multiple Challenges&#34;,
                        &#34;-url&#34;: &#34;#protocol-multiple&#34;
                      }
                    },
                    &#34;if the sender declines the challenge&#34;
                  ]
                }
              ]
            },
            {
              &#34;-anchor&#34;: &#34;protocol-result&#34;,
              &#34;-topic&#34;: &#34;Result Stanza&#34;,
              &#34;example&#34;: [
                {
                  &#34;#text&#34;: &#34;\u003ciq type=&#39;error&#39;\n    from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    id=&#39;z140r0s&#39;\u003e\n  \u003cerror type=&#39;cancel&#39;\u003e\n    \u003cservice-unavailable xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;/\u003e\n  \u003c/error\u003e\n\u003c/iq\u003e&#34;,
                  &#34;-caption&#34;: &#34;Challenger Indicates Challenge Not Found&#34;
                },
                {
                  &#34;#text&#34;: &#34;\u003ciq type=&#39;result&#39;\n    from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    id=&#39;z140r0s&#39;/\u003e&#34;,
                  &#34;-caption&#34;: &#34;Challenger Tells Sender it Passed&#34;
                },
                {
                  &#34;#text&#34;: &#34;\u003ciq type=&#39;error&#39;\n    from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    id=&#39;z140r0s&#39;\u003e\n  \u003cerror type=&#39;cancel&#39;\u003e\n    \u003cnot-acceptable xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;/\u003e\n  \u003c/error\u003e\n\u003c/iq\u003e&#34;,
                  &#34;-caption&#34;: &#34;Challenger Tells Sender it Failed&#34;
                }
              ],
              &#34;p&#34;: [
                &#34;The challenger SHOULD send a \u003cservice-unavailable/\u003e error to the sender if:&#34;,
                &#34;Note: This error MAY be sent even in cases where the challenge became unnecessary while the challenger was waiting for the response.&#34;,
                &#34;After receiving a correct response to its challenge, the challenger SHOULD inform the sender that it was successful.&#34;,
                {
                  &#34;#text&#34;: &#34;However, if the sender submits an incorrect response the challenger SHOULD send it a \u003cnot-acceptable/\u003e error with type \&#34;cancel\&#34;:&#34;,
                  &#34;note&#34;: {
                    &#34;#text&#34;: &#34;If a large proportion of the responses a server is receiving from another IP are incorrect then it SHOULD inform the administrator of the other server using the protocol specified in&#34;,
                    &#34;note&#34;: [
                      {
                        &#34;#text&#34;: &#34;XEP-0161: Abuse Reporting \u003c&#34;,
                        &#34;link&#34;: {
                          &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0161.html&#34;,
                          &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0161.html&#34;
                        }
                      },
                      {
                        &#34;#text&#34;: &#34;XEP-0236: Abuse Reporting \u003c&#34;,
                        &#34;link&#34;: {
                          &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0236.html&#34;,
                          &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0236.html&#34;
                        }
                      }
                    ],
                    &#34;span&#34;: [
                      {
                        &#34;-class&#34;: &#34;ref&#34;,
                        &#34;link&#34;: {
                          &#34;#text&#34;: &#34;Abuse Reporting (XEP-0161)&#34;,
                          &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0161.html&#34;
                        }
                      },
                      {
                        &#34;-class&#34;: &#34;ref&#34;,
                        &#34;link&#34;: {
                          &#34;#text&#34;: &#34;Abuse Reporting (XEP-0236)&#34;,
                          &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0236.html&#34;
                        }
                      }
                    ]
                  }
                }
              ],
              &#34;ul&#34;: {
                &#34;li&#34;: [
                  {
                    &#34;#text&#34;: &#34;The challenger did not send the specified challenge.&#34;,
                    &#34;note&#34;: &#34;If the challenger is a client then it SHOULD be careful not to leak information about the presence of the sender and reply to potentially bogus challenge responses with exactly the same XML that its server would send if the sender were offline.&#34;
                  },
                  &#34;The sender already submitted its response to this challenge.&#34;,
                  &#34;The sender took too long to submit its response.&#34;
                ]
              }
            }
          ]
        },
        {
          &#34;-anchor&#34;: &#34;protocol-multiple&#34;,
          &#34;-topic&#34;: &#34;Multiple Challenges&#34;,
          &#34;example&#34;: [
            {
              &#34;#text&#34;: &#34;\u003cmessage from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;73DE28A2&#39;\u003e\n  \u003cbody\u003eYour messages to innocent@victim.com are being blocked.\n    To unblock them, ask innocent@victim.com to send you a message.\u003c/body\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003e73DE28A2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;sid&#39;\u003e\u003cvalue\u003espam2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;answers&#39;\u003e\u003cvalue\u003e2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39; label=&#39;Enter the text you see&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;80&#39;\n               width=&#39;290&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/ocr.jpeg?F3A6292C\n          \u003c/uri\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            cid:sha1&#43;f24030b8d91d233bac14777be5ab531ca3b9f102@bob.xmpp.org\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;audio_recog&#39; label=&#39;Describe the sound you hear&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\u003e\n          \u003curi type=&#39;audio/x-wav&#39;\u003e\n            http://www.victim.com/challenges/audio.wav?F3A6292C\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;Type the color of a stop light&#39; type=&#39;text-single&#39; var=&#39;qa&#39;\u003e\n        \u003crequired/\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;e03d7&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/message\u003e&#34;,
              &#34;-caption&#34;: &#34;Challenger Sets Multiple Challenges&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003ciq type=&#39;set&#39;\n    from=&#39;robot@abuser.com/zombie&#39;\n    to=&#39;victim.com&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;73DE28A2&#39;\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;submit&#39;\u003e\n      \u003cfield var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;challenge&#39;\u003e\u003cvalue\u003e73DE28A2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;sid&#39;\u003e\u003cvalue\u003espam2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;answers&#39;\u003e\u003cvalue\u003e2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;qa&#39;\u003e\u003cvalue\u003ered\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;SHA-256&#39;\u003e\u003cvalue\u003einnocent@victim.com2450F06C173B05E3\u003c/value\u003e\u003c/field\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/iq\u003e&#34;,
              &#34;-caption&#34;: &#34;Sender Sends Multiple Responses to the Challenger&#34;
            }
          ],
          &#34;p&#34;: [
            &#34;The challenger MAY demand responses to more than one of the challenges it is offering; this is done by including an &#39;answers&#39; \u003cfield/\u003e element in the form, which specifies how many answers the sender needs to include. The challenger also MAY require responses to particular challenges; this is done by including a \u003crequired/\u003e element in the compulsory fields.&#34;,
            {
              &#34;#text&#34;: &#34;If the sender finds the request acceptable, it MUST answer all challenges that include a \u003crequired/\u003e element. If the total number of answers was specified and it is greater than the number of \u003crequired/\u003e elements then the sender MUST also answer one or more of the challenges without a \u003crequired/\u003e element. In the example above, the sender should respond to the &#39;qa&#39; challenge&#34;,
              &#34;em&#34;: &#34;and&#34;
            },
            &#34;The challenger MAY decide the sender has passed a challenge even if the responses are not all perfectly correct.&#34;
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;register&#34;,
      &#34;-topic&#34;: &#34;Extended In-Band Registration&#34;,
      &#34;example&#34;: [
        {
          &#34;#text&#34;: &#34;\u003ciq type=&#39;get&#39; xml:lang=&#39;en&#39; id=&#39;reg1&#39;\u003e\n  \u003cquery xmlns=&#39;jabber:iq:register&#39;/\u003e\n\u003c/iq\u003e&#34;,
          &#34;-caption&#34;: &#34;Entity Requests Registration Fields from Host&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003ciq type=&#39;result&#39; xml:lang=&#39;en&#39; id=&#39;reg1&#39;\u003e\n  \u003cquery xmlns=&#39;jabber:iq:register&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003ejabber:iq:register\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;sid&#39;\u003e\u003cvalue\u003ereg1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;answers&#39;\u003e\u003cvalue\u003e3\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39; label=&#39;Enter the text you see&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;80&#39;\n               width=&#39;290&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/ocr.jpeg?F3A6292C\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;93C7A&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n      \u003cfield type=&#39;text-single&#39; var=&#39;username&#39;\u003e\n        \u003crequired/\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;text-private&#39; var=&#39;password&#39;\u003e\n        \u003crequired/\u003e\n      \u003c/field\u003e\n    \u003c/x\u003e\n    \u003cinstructions\u003e\n      To register, visit http://www.victim.com/register.html\n    \u003c/instructions\u003e\n    \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n      \u003curl\u003ehttp://www.victim.com/register.html\u003c/url\u003e\n    \u003c/x\u003e\n  \u003c/query\u003e\n\u003c/iq\u003e&#34;,
          &#34;-caption&#34;: &#34;Host Returns Registration and Challenge Fields to Entity&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003ciq type=&#39;set&#39; xml:lang=&#39;en&#39; id=&#39;reg2&#39;\u003e\n  \u003cquery xmlns=&#39;jabber:iq:register&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;submit&#39;\u003e\n      \u003cfield var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003ejabber:iq:register\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;sid&#39;\u003e\u003cvalue\u003ereg1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;answers&#39;\u003e\u003cvalue\u003e3\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39;\u003e\u003cvalue\u003e7nHL3\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;username&#39;\u003e\u003cvalue\u003ebill\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;password&#39;\u003e\u003cvalue\u003eCalliope\u003c/value\u003e\u003c/field\u003e\n    \u003c/x\u003e\n  \u003c/query\u003e\n\u003c/iq\u003e&#34;,
          &#34;-caption&#34;: &#34;Entity Provides Required Information In-Band&#34;
        }
      ],
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;This section shows how challenges SHOULD be combined with the existing In-Band Registration protocol according to the rules defined in the Extensibility section of&#34;,
          &#34;cite&#34;: &#34;XEP-0077&#34;
        },
        {
          &#34;#text&#34;: &#34;Note: The \u003cchallenge/\u003e wrapper element is not included, because&#34;,
          &#34;cite&#34;: &#34;XEP-0077&#34;
        },
        &#34;Note that the CAPTCHA form MUST be inside the \u003cquery/\u003e element, and the server&#39;s challenge ID is specified within the form:&#34;,
        {
          &#34;#text&#34;: &#34;The server MAY include an \u003cinstructions/\u003e element and a URL using&#34;,
          &#34;cite&#34;: [
            &#34;Out-of-Band Data&#34;,
            &#34;In-Band Registration&#34;
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;muc&#34;,
      &#34;-topic&#34;: &#34;Multi-User Chat&#34;,
      &#34;example&#34;: [
        {
          &#34;#text&#34;: &#34;\u003cpresence from=&#39;robot@abuser.com/zombie&#39;\n          to=&#39;friendly-chat@muc.victim.com/robot101&#39;\u003e\n  \u003cx xmlns=&#39;http://jabber.org/protocol/muc&#39;/\u003e\n\u003c/presence\u003e&#34;,
          &#34;-caption&#34;: &#34;Sender Attempts to Join Chat Room&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;friendly-chat@muc.victim.com&#39;\n         to=&#39;robot@abuser.com/zombie&#39;\n         id=&#39;A4C7303D&#39;\u003e\n  \u003cbody\u003e\n    Your messages to friendly-chat@muc.victim.com are being blocked. To unblock\n    them, visit http://www.victim.com/challenge.html?A4C7303D\n  \u003c/body\u003e\n  \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n    \u003curl\u003ehttp://www.victim.com/challenge.html?A4C7303D\u003c/url\u003e\n  \u003c/x\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;from&#39;\u003e\u003cvalue\u003efriendly-chat@muc.victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003eA4C7303D\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39; label=&#39;Enter the text you see&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;80&#39;\n               width=&#39;290&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/ocr.jpeg?A4C7303D\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;picture_recog&#39; label=&#39;Identify the picture&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;150&#39;\n               width=&#39;150&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/picture.jpeg?A4C7303D\n          \u003c/uri\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            cid:sha1&#43;f2377f3a3287eac81028243079e1aa9905c466bc@bob.xmpp.org\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;speech_recog&#39; label=&#39;Enter the words you hear&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\u003e\n          \u003curi type=&#39;audio/x-wav&#39;\u003e\n            http://www.victim.com/challenges/speech.wav?A4C7303D\n          \u003c/uri\u003e\n          \u003curi type=&#39;audio/ogg-speex&#39;\u003e\n            http://www.victim.com/challenges/speech.ogg?A4C7303D\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;video_recog&#39; label=&#39;Identity the video&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;150&#39;\n               width=&#39;150&#39;\u003e\n          \u003curi type=&#39;video/mpeg&#39;\u003e\n            http://www.victim.com/challenges/video.mpeg?A4C7303D\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;Type the color of a stop light&#39; type=&#39;text-single&#39; var=&#39;qa&#39;/\u003e\n      \u003cfield label=&#39;93C7A&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Challenger Offers a Choice of Challenges to Sender&#34;
        }
      ],
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;A service that hosts multi-user chat rooms in accordance with&#34;,
        &#34;cite&#34;: &#34;XEP-0045&#34;
      }
    },
    {
      &#34;-anchor&#34;: &#34;challenge&#34;,
      &#34;-topic&#34;: &#34;Challenge Types&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;challenge-intro&#34;,
          &#34;-topic&#34;: &#34;Introduction&#34;,
          &#34;p&#34;: [
            &#34;Entities MUST address the needs of disabled people and CPU-constrained clients by offering senders a reasonable choice of different types of challenges.&#34;,
            {
              &#34;#text&#34;: &#34;Desktop clients running on modern PCs will typically be configured to automatically perform a specified &#39;SHA-256&#39; Hashcash challenge (see below) whenever it is below a certain level of difficulty, with the result that many people may not even notice challenges most of the time. However, people using CPU-constrained clients (e.g. Web or mobile clients) would notice the performance hit. They might prefer to take a CAPTCHA challenge instead.&#34;,
              &#34;note&#34;: &#34;A CPU-constrained client could ask a faster computer (e.g., its server) to perform a Hashcash challenge for it.&#34;
            },
            &#34;Visually disabled people using a CPU-constrained client could configure their client to always present them with an audio CAPTCHA challenge.&#34;,
            &#34;Most of the challenges below are language sensitive. However, the evaluation of the OCR and Hashcash responses does not depend on the language the sender is using.&#34;,
            {
              &#34;#text&#34;: &#34;Challenge types are distinguished by the &#39;var&#39; attribute of each \u003cfield/\u003e element. Several types of challenges are described below. More challenges MAY be documented elsewhere and registered with the XMPP Registrar (see&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Field Standardization&#34;,
                &#34;-url&#34;: &#34;#registrar-formtypes&#34;
              }
            }
          ]
        },
        {
          &#34;-anchor&#34;: &#34;challenge-hashcash&#34;,
          &#34;-topic&#34;: &#34;SHA-256 Hashcash&#34;,
          &#34;code&#34;: &#34;innocent@victim.com2450F06C173B05E3&#34;,
          &#34;p&#34;: [
            {
              &#34;#text&#34;: &#34;The SHA-256 Hashcash challenge is transparent to average PC users. It is indicated when the value of the &#39;var&#39; attribute is &#39;SHA-256&#39;. It forces clients to perform CPU-intensive work, making it difficult to send large amounts of abusive traffic. This significantly reduces abusive traffic, but alone it will not completely stop abusive stanzas from being sent through large collections of &#39;zombie&#39; computers.&#34;,
              &#34;note&#34;: &#34;The hope is that the extra CPU usage will often be noticed by the owners of the zombie machines, who will be more likely to fix them.&#34;
            },
            {
              &#34;#text&#34;: &#34;The challenger MUST set the &#39;label&#39; attribute of the \u003cfield/\u003e element to a hexadecimal random number containing a configured number of bits (e.g., 2&#34;,
              &#34;span&#34;: [
                {
                  &#34;#text&#34;: &#34;20&#34;,
                  &#34;-class&#34;: &#34;super&#34;
                },
                {
                  &#34;#text&#34;: &#34;21&#34;,
                  &#34;-class&#34;: &#34;super&#34;
                }
              ]
            },
            {
              &#34;#text&#34;: &#34;To pass the test, the sender MUST return a text string that starts with the JID the sender sent the first stanza to (i.e., the stanza that triggered the challenge). The least significant bits of the SHA-256 hash (see&#34;,
              &#34;note&#34;: {
                &#34;#text&#34;: &#34;Secure Hash Standard: Federal Information Processing Standards Publication 180-2  \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;http://csrc.nist.gov/publications/fips/fips180-2/fips186-2withchangenotice.pdf&#34;,
                  &#34;-url&#34;: &#34;http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf&#34;
                }
              },
              &#34;span&#34;: {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;SHA&#34;,
                  &#34;-url&#34;: &#34;http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf&#34;
                }
              }
            },
            &#34;Note: When configuring the number of bits to be specified by a challenger in the &#39;label&#39; attribute values, administrators MUST balance the need to make mass abuse as difficult as possible, with the inconvenience that may be caused to the users of less powerful computers. (Most clients will be challenged only very occasionally, so the consumption of 70% of a typical desktop CPU for 4 seconds might be considered appropriate.) Administrators SHOULD increment the configured number of bits from time to time to match increases in the performance of typical desktop PCs. If an administrator notices that abusive robots never attempt the Hashcash challenge, then he SHOULD consider reducing the number of bits, to avoid inconveniencing people unnecessarily.&#34;
          ]
        },
        {
          &#34;-anchor&#34;: &#34;challenge-captcha&#34;,
          &#34;-topic&#34;: &#34;CAPTCHAs&#34;,
          &#34;p&#34;: [
            &#34;Note: It may be profitable to send abusive stanzas even if less than one percent of CAPTCHA responses are successful. The effectiveness of a CAPTCHA challenge needs to be close to perfect, unless it is used in combination with other anti-abuse techniques.&#34;,
            {
              &#34;#text&#34;: &#34;If a media type is specified (see table below) then the \u003cfield/\u003e element MUST contain a \u003cmedia/\u003e element that includes a \u003curi/\u003e element of that type. Clients that support the CAPTCHA type MUST be able to play or render the specified MIME-types (see table below). They MAY also support other formats.&#34;,
              &#34;note&#34;: &#34;Audio CAPTCHAs typically require challengers to provide at least the &#39;audio/x-wav&#39; MIME-type (with the PCM codec) because more efficient patent-free formats are often not supported by constrained clients. It is RECOMMENDED that challengers provide more compact formats (like Ogg Speex or MP3) too.&#34;
            },
            {
              &#34;#text&#34;: &#34;The &#39;type&#39; attribute of the \u003cfield/\u003e element SHOULD be &#39;text-single&#39;, &#39;text-private&#39;, or &#39;text-multi&#39; (if no &#39;type&#39; is specified, the default is &#39;text-single&#39;).&#34;,
              &#34;note&#34;: &#34;The &#39;boolean&#39; and &#39;list-single&#39; field types would make it trivial for a robot to provide a correct response at least some of the time.&#34;
            },
            {
              &#34;#text&#34;: &#34;* See the&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Internationalization Considerations&#34;,
                &#34;-url&#34;: &#34;#i18n&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;** The image portrays random characters that humans can read but OCR software cannot.&#34;,
              &#34;note&#34;: {
                &#34;#text&#34;: &#34;See PWNtcha \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;http://sam.zoy.org/pwntcha/&#34;,
                  &#34;-url&#34;: &#34;http://sam.zoy.org/pwntcha/&#34;
                }
              }
            }
          ],
          &#34;table&#34;: {
            &#34;-caption&#34;: &#34;CAPTCHAs&#34;,
            &#34;tr&#34;: [
              {
                &#34;th&#34;: [
                  &#34;&#39;var&#39;&#34;,
                  &#34;Name&#34;,
                  &#34;Media type&#34;,
                  &#34;MIME-type&#34;,
                  &#34;Suggested generic instructions *&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;audio_recog&#34;,
                  &#34;Audio Recognition&#34;,
                  &#34;audio&#34;,
                  &#34;audio/x-wav&#34;,
                  &#34;Describe the sound you hear&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;ocr **&#34;,
                  &#34;Optical Character Recognition&#34;,
                  &#34;image&#34;,
                  &#34;image/jpeg&#34;,
                  &#34;Enter the text you see&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;picture_q&#34;,
                  &#34;Picture Question&#34;,
                  &#34;image&#34;,
                  &#34;image/jpeg&#34;,
                  &#34;Answer the question you see&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;picture_recog&#34;,
                  &#34;Picture Recognition&#34;,
                  &#34;image&#34;,
                  &#34;image/jpeg&#34;,
                  &#34;Identify the picture&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;qa&#34;,
                  &#34;Text Question and Answer&#34;,
                  &#34;-&#34;,
                  &#34;-&#34;,
                  &#34;-&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;speech_q&#34;,
                  &#34;Speech Question&#34;,
                  &#34;audio&#34;,
                  &#34;audio/x-wav&#34;,
                  &#34;Answer the question you hear&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;speech_recog&#34;,
                  &#34;Speech Recognition&#34;,
                  &#34;audio&#34;,
                  &#34;audio/x-wav&#34;,
                  &#34;Enter the words you hear&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;video_q&#34;,
                  &#34;Video Question&#34;,
                  &#34;video&#34;,
                  &#34;video/mpeg&#34;,
                  &#34;Answer the question in the video&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;video_recog&#34;,
                  &#34;Video Recognition&#34;,
                  &#34;video&#34;,
                  &#34;video/mpeg&#34;,
                  &#34;Identify the video&#34;
                ]
              }
            ]
          }
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;legacy&#34;,
      &#34;-topic&#34;: &#34;Question and Answer for Legacy Clients&#34;,
      &#34;example&#34;: [
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;innocent@victim.com/pda&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;F3A6292C&#39;\u003e\n  \u003cbody\u003eYour messages to me are being blocked. To unblock them,\n    reply with the color of a stop light followed by &#39;F3A6292C&#39;.\u003c/body\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;sid&#39;\u003e\u003cvalue\u003espam1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield label=&#39;Type the color of a stop light&#39; type=&#39;text-single&#39; var=&#39;qa&#39;/\u003e\n      \u003cfield label=&#39;93C7A&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Challenger Includes a Legacy Challenge&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;robot@abuser.com/zombie&#39; to=&#39;innocent@victim.com/pda&#39;\u003e\n  \u003cbody\u003ered F3A6292C\u003c/body\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Legacy Sender Responds&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;innocent@victim.com/pda&#39; to=&#39;robot@abuser.com/zombie&#39;\u003e\n  \u003cbody\u003eYour message was delivered. Your messages\n        to me are no longer being blocked.\u003c/body\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Challenger Tells Legacy Sender it Passed&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003cmessage type=&#39;error&#39;\n         from=&#39;innocent@victim.com/pda&#39;\n         to=&#39;robot@abuser.com/zombie&#39;\u003e\n  \u003cerror type=&#39;cancel&#39;\u003e\n    \u003cnot-acceptable xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;/\u003e\n    \u003ctext xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;\u003e\n      Your message to me was not delivered.\n    \u003c/text\u003e\n  \u003c/error\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Challenger Tells Legacy Sender it Failed&#34;
        }
      ],
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;A challenger MAY provide a text question in the \u003cbody/\u003e element of a challenge stanza for clients that do not support CAPTCHA forms. Entities that cannot serve&#34;,
          &#34;cite&#34;: &#34;Out-of-Band Data&#34;
        },
        &#34;Note: Robots always attempt the easiest challenge they are offered. So the question MUST be at least as difficult for a robot as the CAPTCHA form.&#34;,
        &#34;Note: Even if it provides a text question in the \u003cbody/\u003e element, a challenger MUST always provide a CAPTCHA form.&#34;,
        &#34;Legacy clients respond to the challenger using a \u003cmessage/\u003e stanza (not an \u003ciq/\u003e).&#34;,
        &#34;The challenger SHOULD treat the stanza as a normal message (instead of as a response to its challenge) if the legacy client either takes too long to submit it or has already responded to the challenge. The challenger MAY treat the response as a normal message even in cases where the challenge became unnecessary while the challenger was waiting for the response.&#34;,
        &#34;Otherwise the challenger MUST report the result of the challenge to the legacy client using a \u003cmessage/\u003e stanza (not an \u003ciq/\u003e).&#34;
      ]
    },
    {
      &#34;-anchor&#34;: &#34;stop&#34;,
      &#34;-topic&#34;: &#34;Discontinuation Policy&#34;,
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;It is RECOMMENDED that entities employ other techniques to combat abusive stanzas in addition to those described in this document (e.g., see&#34;,
          &#34;cite&#34;: &#34;XEP-0161&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;XEP-0205: Best Practices to Discourage Denial of Service Attacks \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0205.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0205.html&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;Best Practices to Discourage Denial of Service Attacks (XEP-0205)&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0205.html&#34;
            }
          }
        },
        &#34;It is expected that this protocol will be an important and successful tool for discouraging abusive traffic. However, much of its success is dependent on the quality of the CAPTCHAs and other puzzles employed by a particular implementation.&#34;,
        &#34;The administrator of an application that functions as a challenger SHOULD discontinue the use of CAPTCHA forms under the following circumstances:&#34;
      ],
      &#34;ul&#34;: {
        &#34;li&#34;: [
          &#34;If he realises that the challenger&#39;s challenges are largely ineffective in combating abusive traffic, and that the reduction in abuse does not compensate for the inconvenience to humans of responding to the challenger&#39;s challenges.&#34;,
          {
            &#34;#text&#34;: &#34;If other,&#34;,
            &#34;em&#34;: &#34;more transparent&#34;
          },
          &#34;If the challenger needs no protection at all because it receives only a negligible amount of abusive traffic.&#34;
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;i18n&#34;,
      &#34;-topic&#34;: &#34;Internationalization Considerations&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;Each form field SHOULD include a &#39;label&#39; attribute. If the sender did not include an &#39;xml:lang&#39; attribute, then the challenger may not know the correct language for the labels. Therefore, depending on user preferences, the client that receives a challenge MAY present generic but localized text instead of label text that would not be understood by the user. Suggested generic text (to be suitably localized) is provided by&#34;,
        &#34;link&#34;: [
          {
            &#34;#text&#34;: &#34;Table 1&#34;,
            &#34;-url&#34;: &#34;#table-1&#34;
          },
          {
            &#34;#text&#34;: &#34;CAPTCHAs&#34;,
            &#34;-url&#34;: &#34;#challenge-captcha&#34;
          }
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;sec&#34;,
      &#34;-topic&#34;: &#34;Security Considerations&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;The use of CAPTCHAs is not a panacea, and should be combined with other anti-abuse mechanisms, such as those described in&#34;,
        &#34;cite&#34;: [
          &#34;XEP-0161&#34;,
          &#34;XEP-0205&#34;
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;iana&#34;,
      &#34;-topic&#34;: &#34;IANA Considerations&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;This document requires no interaction with the&#34;,
        &#34;note&#34;: {
          &#34;#text&#34;: &#34;The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see \u003c&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;http://www.iana.org/&#34;,
            &#34;-url&#34;: &#34;http://www.iana.org/&#34;
          }
        },
        &#34;span&#34;: {
          &#34;-class&#34;: &#34;ref&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;Internet Assigned Numbers Authority (IANA)&#34;,
            &#34;-url&#34;: &#34;http://www.iana.org/&#34;
          }
        }
      }
    },
    {
      &#34;-anchor&#34;: &#34;registrar&#34;,
      &#34;-topic&#34;: &#34;XMPP Registrar Considerations&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;ns&#34;,
          &#34;-topic&#34;: &#34;Protocol Namespaces&#34;,
          &#34;p&#34;: {
            &#34;#text&#34;: &#34;The&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/registrar/namespaces.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/registrar/namespaces.html&#34;
            },
            &#34;note&#34;: {
              &#34;#text&#34;: &#34;The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/registrar/&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/registrar/&#34;
              }
            },
            &#34;span&#34;: {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;XMPP Registrar&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/registrar/&#34;
              }
            }
          }
        },
        {
          &#34;-anchor&#34;: &#34;registrar-formtypes&#34;,
          &#34;-topic&#34;: &#34;Field Standardization&#34;,
          &#34;section3&#34;: [
            {
              &#34;-anchor&#34;: &#34;registrar-formtypes-captcha&#34;,
              &#34;-topic&#34;: &#34;CAPTCHA FORM_TYPE&#34;,
              &#34;code&#34;: &#34;\u003cform_type\u003e\n  \u003cname\u003eurn:xmpp:captcha\u003c/name\u003e\n  \u003cdoc\u003eXEP-0158\u003c/doc\u003e\n  \u003cdesc\u003eForms enabling the use of CAPTCHAs.\u003c/desc\u003e\n  \u003cfield\n      var=&#39;answers&#39;\n      type=&#39;hidden&#39;\n      label=&#39;number of answers required&#39;/\u003e\n  \u003cfield\n      var=&#39;audio_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a sound&#39;/\u003e\n  \u003cfield\n      var=&#39;challenge&#39;\n      type=&#39;hidden&#39;\n      label=&#39;challenge ID&#39;/\u003e\n  \u003cfield\n      var=&#39;from&#39;\n      type=&#39;hidden&#39;\n      label=&#39;to attribute of stanza that triggered challenge&#39;/\u003e\n  \u003cfield\n      var=&#39;ocr&#39;\n      type=&#39;text-single&#39;\n      label=&#39;code appearing in an image&#39;/\u003e\n  \u003cfield\n      var=&#39;picture_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with a picture&#39;/\u003e\n  \u003cfield\n      var=&#39;picture_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a picture&#39;/\u003e\n  \u003cfield\n      var=&#39;qa&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer to a question&#39;/\u003e\n  \u003cfield\n      var=&#39;SHA-256&#39;\n      type=&#39;text-single&#39;\n      label=&#39;least significant bits of SHA-256 hash of text should equal hexadecimal label&#39;/\u003e\n  \u003cfield\n      var=&#39;sid&#39;\n      type=&#39;hidden&#39;\n      label=&#39;stanza ID&#39;/\u003e\n  \u003cfield\n      var=&#39;speech_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with speech&#39;/\u003e\n  \u003cfield\n      var=&#39;speech_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with speech&#39;/\u003e\n  \u003cfield\n      var=&#39;video_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with a video&#39;/\u003e\n  \u003cfield\n      var=&#39;video_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a video&#39;/\u003e\n\u003c/form_type\u003e&#34;,
              &#34;p&#34;: {
                &#34;#text&#34;: &#34;The&#34;,
                &#34;cite&#34;: &#34;XMPP Registrar&#34;
              }
            },
            {
              &#34;-anchor&#34;: &#34;registrar-formtypes-register&#34;,
              &#34;-topic&#34;: &#34;jabber:iq:register FORM_TYPE&#34;,
              &#34;code&#34;: &#34;\u003cform_type\u003e\n  \u003cname\u003ejabber:iq:register\u003c/name\u003e\n  \u003cdoc\u003eXEP-0077\u003c/doc\u003e\n  \u003cfield\n      var=&#39;answers&#39;\n      type=&#39;hidden&#39;\n      label=&#39;number of answers required&#39;/\u003e\n  \u003cfield\n      var=&#39;audio_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a sound&#39;/\u003e\n  \u003cfield\n      var=&#39;challenge&#39;\n      type=&#39;hidden&#39;\n      label=&#39;challenge ID&#39;/\u003e\n  \u003cfield\n      var=&#39;ocr&#39;\n      type=&#39;text-single&#39;\n      label=&#39;code appearing in an image&#39;/\u003e\n  \u003cfield\n      var=&#39;picture_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with a picture&#39;/\u003e\n  \u003cfield\n      var=&#39;picture_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a picture&#39;/\u003e\n  \u003cfield\n      var=&#39;qa&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer to a question&#39;/\u003e\n  \u003cfield\n      var=&#39;SHA-256&#39;\n      type=&#39;text-single&#39;\n      label=&#39;least significant bits of SHA-256 hash of text should equal hexadecimal label&#39;/\u003e\n  \u003cfield\n      var=&#39;sid&#39;\n      type=&#39;hidden&#39;\n      label=&#39;stanza ID&#39;/\u003e\n  \u003cfield\n      var=&#39;speech_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with speech&#39;/\u003e\n  \u003cfield\n      var=&#39;speech_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with speech&#39;/\u003e\n  \u003cfield\n      var=&#39;video_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with a video&#39;/\u003e\n  \u003cfield\n      var=&#39;video_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a video&#39;/\u003e\n\u003c/form_type\u003e&#34;,
              &#34;p&#34;: {
                &#34;#text&#34;: &#34;The&#34;,
                &#34;cite&#34;: &#34;XMPP Registrar&#34;
              }
            }
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;schema&#34;,
      &#34;-topic&#34;: &#34;XML Schema&#34;,
      &#34;code&#34;: &#34;\u003c?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?\u003e\n\n\u003cxs:schema\n    xmlns:xs=&#39;http://www.w3.org/2001/XMLSchema&#39;\n    targetNamespace=&#39;urn:xmpp:captcha&#39;\n    xmlns=&#39;urn:xmpp:captcha&#39;\n    elementFormDefault=&#39;qualified&#39;\u003e\n\n  \u003cxs:annotation\u003e\n    \u003cxs:documentation\u003e\n      The protocol documented by this schema is defined in\n      XEP-0158: http://xmpp.org/extensions/xep-0158.html\n    \u003c/xs:documentation\u003e\n  \u003c/xs:annotation\u003e\n\n  \u003cxs:import namespace=&#39;jabber:x:data&#39;\n             schemaLocation=&#39;http://xmpp.org/schemas/x-data.xsd&#39;/\u003e\n\n  \u003cxs:element name=&#39;captcha&#39;\u003e\n    \u003cxs:complexType\u003e\n      \u003cxs:sequence xmlns:xdata=&#39;jabber:x:data&#39;\u003e\n        \u003cxs:element ref=&#39;xdata:x&#39; minOccurs=&#39;1&#39; maxOccurs=&#39;1&#39;/\u003e\n      \u003c/xs:sequence\u003e\n    \u003c/xs:complexType\u003e\n  \u003c/xs:element\u003e\n\n\u003c/xs:schema\u003e&#34;
    },
    {
      &#34;-anchor&#34;: &#34;open&#34;,
      &#34;-topic&#34;: &#34;Open Issues&#34;,
      &#34;p&#34;: &#34;Another protocol could allow users to edit the challenges their server will make on their behalf. For example, the number of SHA-256 bits, a personal or original question and answer, a picture, a video, or a sound recording. Of course Aunt Tillie would typically use this feature only if she was plagued by abusive traffic.&#34;
    }
  ]
}</pre></a></td><td>planned</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0374.html>xep-0374:<pre>{
  &#34;-xmlns&#34;: &#34;&#34;,
  &#34;header&#34;: {
    &#34;abstract&#34;: &#34;Specifies a OpenPGP for XMPP (XEP-0373) profile for the Instant\n    Messaging (IM) use case.&#34;,
    &#34;approver&#34;: &#34;Council&#34;,
    &#34;author&#34;: [
      {
        &#34;email&#34;: &#34;flo@geekplace.eu&#34;,
        &#34;firstname&#34;: &#34;Florian&#34;,
        &#34;jid&#34;: &#34;flo@geekplace.eu&#34;,
        &#34;surname&#34;: &#34;Schmaus&#34;
      },
      {
        &#34;email&#34;: &#34;dominik@dominikschuermann.de&#34;,
        &#34;firstname&#34;: &#34;Dominik&#34;,
        &#34;jid&#34;: &#34;dominik@dominikschuermann.de&#34;,
        &#34;surname&#34;: &#34;Schürmann&#34;
      },
      {
        &#34;email&#34;: &#34;look@my.amazin.horse&#34;,
        &#34;firstname&#34;: &#34;Vincent&#34;,
        &#34;jid&#34;: &#34;valodim@stratum0.org&#34;,
        &#34;surname&#34;: &#34;Breitmoser&#34;
      }
    ],
    &#34;dependencies&#34;: {
      &#34;spec&#34;: [
        &#34;XMPP Core&#34;,
        &#34;XEP-0030&#34;,
        &#34;XEP-0373&#34;
      ]
    },
    &#34;legal&#34;: {
      &#34;conformance&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol has been contributed in full conformance with the XSF&#39;s Intellectual Property Rights Policy (a copy of which can be found at \u003c&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;
        }
      },
      &#34;copyright&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol is copyright © 1999 – 2024 by the&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;XMPP Standards Foundation&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/&#34;
        }
      },
      &#34;liability&#34;: &#34;In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.&#34;,
      &#34;permissions&#34;: &#34;Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \&#34;Specification\&#34;), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.&#34;,
      &#34;warranty&#34;: &#34;## NOTE WELL: This Specification is provided on an \&#34;AS IS\&#34; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##&#34;
    },
    &#34;number&#34;: &#34;0374&#34;,
    &#34;revision&#34;: [
      {
        &#34;date&#34;: &#34;2018-01-25&#34;,
        &#34;initials&#34;: &#34;XEP Editor (jwi)&#34;,
        &#34;remark&#34;: &#34;Defer due to lack of activity.&#34;,
        &#34;version&#34;: &#34;0.2.0&#34;
      },
      {
        &#34;date&#34;: &#34;2017-01-20&#34;,
        &#34;initials&#34;: &#34;fs&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Make use of XEP-0380: Explicit Message Encryption.&#34;
        },
        &#34;version&#34;: &#34;0.1.2&#34;
      },
      {
        &#34;date&#34;: &#34;2016-06-04&#34;,
        &#34;initials&#34;: &#34;fs&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Minior editorial fixes.&#34;
        },
        &#34;version&#34;: &#34;0.1.1&#34;
      },
      {
        &#34;date&#34;: &#34;2016-05-10&#34;,
        &#34;initials&#34;: &#34;XEP Editor (ssw)&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Initial published version approved by the XMPP Council.&#34;
        },
        &#34;version&#34;: &#34;0.1&#34;
      },
      {
        &#34;date&#34;: &#34;2016-03-25&#34;,
        &#34;initials&#34;: &#34;fs&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;First draft.&#34;
        },
        &#34;version&#34;: &#34;0.0.1&#34;
      }
    ],
    &#34;shortname&#34;: &#34;oxim&#34;,
    &#34;sig&#34;: &#34;Standards&#34;,
    &#34;status&#34;: &#34;Deferred&#34;,
    &#34;supersededby&#34;: &#34;&#34;,
    &#34;supersedes&#34;: &#34;&#34;,
    &#34;title&#34;: &#34;OpenPGP for XMPP Instant Messaging&#34;,
    &#34;type&#34;: &#34;Standards Track&#34;
  },
  &#34;section1&#34;: [
    {
      &#34;-anchor&#34;: &#34;intro&#34;,
      &#34;-topic&#34;: &#34;Introduction&#34;,
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;This XMPP extension protocol specifies a profile of&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;XEP-0373: OpenPGP for XMPP \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;OpenPGP for XMPP (XEP-0373)&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;
            }
          }
        },
        {
          &#34;#text&#34;: &#34;Unlike similar XEPs, e.g.,&#34;,
          &#34;em&#34;: &#34;does not&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;XEP-0384: OMEMO Encryption \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;OMEMO Encryption (XEP-0384)&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;
            }
          }
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;ox-im-profile&#34;,
      &#34;-topic&#34;: &#34;OX Instant Messaging Profile&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;disco&#34;,
          &#34;-topic&#34;: &#34;Discovering Support&#34;,
          &#34;example&#34;: [
            {
              &#34;#text&#34;: &#34;\u003ciq type=&#39;get&#39;\n    from=&#39;juliet@example.org/balcony&#39;\n    to=&#39;romeo@example.org/orchard&#39;\n    id=&#39;disco1&#39;\u003e\n  \u003cquery xmlns=&#39;http://jabber.org/protocol/disco#info&#39;/\u003e\n\u003c/iq\u003e&#34;,
              &#34;-caption&#34;: &#34;Service Discovery information request&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003ciq type=&#39;result&#39;\n    from=&#39;romeo@example.org/orchard&#39;\n    to=&#39;juliet@example.org/balcony&#39;\n    id=&#39;disco1&#39;\u003e\n  \u003cquery xmlns=&#39;http://jabber.org/protocol/disco#info&#39;\u003e\n    ...\n    \u003cfeature var=&#39;urn:xmpp:openpgp:im:0&#39;/\u003e\n    ...\n  \u003c/query\u003e\n\u003c/iq\u003e&#34;,
              &#34;-caption&#34;: &#34;Service Discovery information response&#34;
            }
          ],
          &#34;p&#34;: [
            {
              &#34;#text&#34;: &#34;If an entity supports exchanging OpenPGP encrypted and signed\n    instant messages over XMPP, i.e., what is specified herein, it MUST\n    advertise that fact by announcing a&#34;,
              &#34;note&#34;: {
                &#34;#text&#34;: &#34;XEP-0030: Service Discovery \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0030.html&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0030.html&#34;
                }
              },
              &#34;span&#34;: {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;Service Discovery (XEP-0030)&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0030.html&#34;
                }
              }
            },
            &#34;Because of possible downgrade attacks, users should be given an\n    option to force the usage of the protocol defined herein no matter\n    if the remote announces support or not.&#34;
          ]
        },
        {
          &#34;-anchor&#34;: &#34;openpgp-secured-im&#34;,
          &#34;-topic&#34;: &#34;OpenPGP Secured Instant Messaging&#34;,
          &#34;p&#34;: [
            {
              &#34;#text&#34;: &#34;In order to establish an OpenPGP secured IM communication, IM\n    clients first need to determine the public key of their\n    interlocutor(s). OpenPGP historically provides public keyservers\n    which can be used for key retrieval. Additional there are methods\n    to store OpenPGP key information in the Domain Name\n    System (DNS). This specification does not restrict the mechanism\n    of key discovery and retrieval, but compliant clients MUST support\n    the public key announcement as described in&#34;,
              &#34;cite&#34;: &#34;XEP-0373&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;§ 4&#34;,
                &#34;-url&#34;: &#34;./xep-0373.html#announcing-discover-pubkey&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;After the required public keys have been discovered, XMPP\n    clients engage in an OpenPGP secured IM\n    conversation by exchanging \u003copenpgp/\u003e extension elements. They MUST\n    use the \u003csigncrypt/\u003e OpenPGP content element specified in&#34;,
              &#34;cite&#34;: &#34;XEP-0373&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;§ 3.1&#34;,
                &#34;-url&#34;: &#34;./xep-0373.html#exchange&#34;
              }
            },
            &#34;The child elements of the OpenPGP content element&#39;s \u003cpayload/\u003e\n    can be seen as stanza extension elements which are encrypted and\n    signed. After the \u003copenpgp/\u003e element and the including \u003csigncrypt/\u003e,\n    element was verified, they SHOULD be processed similar as if they\n    had been direct extension elements of the stanza. For example,\n    direct child elements found in \u003cpayload/\u003e in the context of IM\n    could be:&#34;,
            &#34;But just as with stanza extension elements, child elements of\n    \u003cpayload/\u003e can be any extension element. The example above uses\n    the \u003cbody/\u003e element as defined in RFC 6121. Note that it\n    uses &#39;jabber:client&#39; as namespace, but since the same\n    \u003cbody/\u003e element is also defined in the &#39;jabber:server&#39;\n    namespace, recipients MUST accept both.&#34;
          ],
          &#34;ul&#34;: {
            &#34;li&#34;: [
              {
                &#34;#text&#34;: &#34;Message bodies (&#34;,
                &#34;note&#34;: {
                  &#34;#text&#34;: &#34;RFC 6121: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence \u003c&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;,
                    &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;
                  }
                },
                &#34;span&#34;: {
                  &#34;-class&#34;: &#34;ref&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;RFC 6121&#34;,
                    &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;
                  }
                }
              },
              {
                &#34;#text&#34;: &#34;: \u003cactive xmlns=&#39;http://jabber.org/protocol/chatstates&#39;/\u003e&#34;,
                &#34;note&#34;: {
                  &#34;#text&#34;: &#34;XEP-0085: Chat State Notifications \u003c&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0085.html&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0085.html&#34;
                  }
                },
                &#34;span&#34;: {
                  &#34;-class&#34;: &#34;ref&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;Chat State Notifications (XEP-0085)&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0085.html&#34;
                  }
                }
              },
              {
                &#34;#text&#34;: &#34;: \u003chtml xmlns=&#39;http://jabber.org/protocol/xhtml-im&#39;/\u003e&#34;,
                &#34;note&#34;: {
                  &#34;#text&#34;: &#34;XEP-0071: XHTML-IM \u003c&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0071.html&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0071.html&#34;
                  }
                },
                &#34;span&#34;: {
                  &#34;-class&#34;: &#34;ref&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;XHTML-IM (XEP-0071)&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0071.html&#34;
                  }
                }
              }
            ]
          }
        },
        {
          &#34;-anchor&#34;: &#34;openpgp-key-handling&#34;,
          &#34;-topic&#34;: &#34;OpenPGP Key Handling&#34;,
          &#34;section3&#34;: [
            {
              &#34;-anchor&#34;: &#34;choose-pubkey&#34;,
              &#34;-topic&#34;: &#34;Choosing Public Keys&#34;,
              &#34;p&#34;: &#34;Clients MUST expect multiple public keys to be announced for a single remote entity. In this case all keys MUST be used for encryption.&#34;
            },
            {
              &#34;-anchor&#34;: &#34;openpgp-secret-key-sync&#34;,
              &#34;-topic&#34;: &#34;OpenPGP Secret Key Synchronization&#34;,
              &#34;p&#34;: {
                &#34;#text&#34;: &#34;Clients MAY want to use the mechanism in&#34;,
                &#34;cite&#34;: &#34;XEP-0373 § 5&#34;
              }
            }
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;rules&#34;,
      &#34;-topic&#34;: &#34;Business Rules&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;signcrypt-im-use-case&#34;,
          &#34;-topic&#34;: &#34;Always Use \u003csigncrypt/\u003e&#34;,
          &#34;p&#34;: &#34;Only \u003csigncrypt/\u003e MUST be used for the IM\n    use case. Encrypted but unsigned messages (\u003ccrypt/\u003e) do not provide\n    an advantage over unencrypted ones since the sender can not be\n    verified. As result of this rule, the user interface of\n    IM clients implementing the protocol defined herein MUST NOT\n    provide an option for the user to select between sign&#43;crypt, sign\n    or crypt. This also increases the usability.&#34;
        },
        {
          &#34;-anchor&#34;: &#34;hint-im-use-case&#34;,
          &#34;-topic&#34;: &#34;Provide Hints&#34;,
          &#34;example&#34;: {
            &#34;#text&#34;: &#34;\u003cmessage to=&#39;juliet@example.org&#39;\u003e\n  \u003cbody\u003eThis message is encrypted using OpenPGP.\u003c/body\u003e\n  \u003cstore xmlns=&#39;urn:xmpp:hints&#39;/\u003e\n  \u003cencryption xmlns=&#39;urn:xmpp:eme:0&#39; namespace=&#39;urn:xmpp:openpgp:0&#39;/\u003e\n  \u003copenpgp xmlns=&#39;urn:xmpp:openpgp:0&#39;\u003e\n    BASE64_OPENPGP_MESSAGE_CONTAINING_CONTENT_ELEMENT\n  \u003c/openpgp\u003e\n\u003c/message\u003e&#34;,
            &#34;-caption&#34;: &#34;An encrypted and signed message with hints.&#34;
          },
          &#34;p&#34;: {
            &#34;#text&#34;: &#34;In the IM use case every \u003cmessage/\u003e equipped with \u003copenpgp/\u003e\n    SHOULD include an unencrypted \u003cbody/\u003e explaining that the actual\n    message is encrypted. Furthermore the message SHOULD contain a\n    &#39;store&#39; hint as defined in&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;§\n    4.4&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html#sect-idp1502160&#34;
            },
            &#34;note&#34;: [
              {
                &#34;#text&#34;: &#34;XEP-0334: Message Processing Hints \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;
                }
              },
              {
                &#34;#text&#34;: &#34;XEP-0380: Explicit Message Encryption \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0380.html&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0380.html&#34;
                }
              }
            ],
            &#34;span&#34;: [
              {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;Message Processing Hints (XEP-0334)&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;
                }
              },
              {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;Explicit Message Encryption (XEP-0380)&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0380.html&#34;
                }
              }
            ]
          }
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;iana&#34;,
      &#34;-topic&#34;: &#34;IANA Considerations&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;This document requires no interaction with the&#34;,
        &#34;note&#34;: {
          &#34;#text&#34;: &#34;The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see \u003c&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;http://www.iana.org/&#34;,
            &#34;-url&#34;: &#34;http://www.iana.org/&#34;
          }
        },
        &#34;span&#34;: {
          &#34;-class&#34;: &#34;ref&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;Internet Assigned Numbers Authority (IANA)&#34;,
            &#34;-url&#34;: &#34;http://www.iana.org/&#34;
          }
        }
      }
    },
    {
      &#34;-anchor&#34;: &#34;registrar&#34;,
      &#34;-topic&#34;: &#34;XMPP Registrar Considerations&#34;,
      &#34;section2&#34;: {
        &#34;-anchor&#34;: &#34;registrar-ns&#34;,
        &#34;-topic&#34;: &#34;Protocol Namespaces&#34;,
        &#34;p&#34;: {
          &#34;#text&#34;: &#34;The&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;https://xmpp.org/registrar/namespaces.html&#34;,
            &#34;-url&#34;: &#34;https://xmpp.org/registrar/namespaces.html&#34;
          },
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/registrar/&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/registrar/&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;XMPP Registrar&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/registrar/&#34;
            }
          }
        }
      }
    },
    {
      &#34;-anchor&#34;: &#34;schema&#34;,
      &#34;-topic&#34;: &#34;XML Schema&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;This XEP does not define a Schema, since it exclusively uses elements from&#34;,
        &#34;cite&#34;: &#34;XEP-0373&#34;
      }
    },
    {
      &#34;-anchor&#34;: &#34;acknowledgements&#34;,
      &#34;-topic&#34;: &#34;Acknowledgements&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;Please refer to the&#34;,
        &#34;cite&#34;: &#34;XEP-0373&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;Acknowledgements section&#34;,
          &#34;-url&#34;: &#34;./xep-0373.html#acknowledgements&#34;
        }
      }
    }
  ]
}</pre></a></td><td>planned</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0386.html>xep-0386:<pre>{
  &#34;-xmlns&#34;: &#34;&#34;,
  &#34;header&#34;: {
    &#34;abstract&#34;: &#34;This specification provides a single-request replacement for several activities an XMPP client needs to do at startup.&#34;,
    &#34;approver&#34;: &#34;Council&#34;,
    &#34;author&#34;: [
      {
        &#34;email&#34;: &#34;kevin.smith@isode.com&#34;,
        &#34;firstname&#34;: &#34;Kevin&#34;,
        &#34;jid&#34;: &#34;kevin.smith@isode.com&#34;,
        &#34;surname&#34;: &#34;Smith&#34;
      },
      {
        &#34;email&#34;: &#34;mwild1@gmail.com&#34;,
        &#34;firstname&#34;: &#34;Matthew&#34;,
        &#34;jid&#34;: &#34;me@matthewwild.co.uk&#34;,
        &#34;surname&#34;: &#34;Wild&#34;
      }
    ],
    &#34;dependencies&#34;: {
      &#34;spec&#34;: [
        &#34;XMPP Core&#34;,
        &#34;XMPP IM&#34;,
        &#34;XEP-0313&#34;,
        &#34;XEP-0280&#34;
      ]
    },
    &#34;lastcall&#34;: &#34;2024-04-01&#34;,
    &#34;legal&#34;: {
      &#34;conformance&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol has been contributed in full conformance with the XSF&#39;s Intellectual Property Rights Policy (a copy of which can be found at \u003c&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;
        }
      },
      &#34;copyright&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol is copyright © 1999 – 2024 by the&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;XMPP Standards Foundation&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/&#34;
        }
      },
      &#34;liability&#34;: &#34;In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.&#34;,
      &#34;permissions&#34;: &#34;Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \&#34;Specification\&#34;), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.&#34;,
      &#34;warranty&#34;: &#34;## NOTE WELL: This Specification is provided on an \&#34;AS IS\&#34; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##&#34;
    },
    &#34;number&#34;: &#34;0386&#34;,
    &#34;revision&#34;: [
      {
        &#34;date&#34;: &#34;2024-07-02&#34;,
        &#34;initials&#34;: &#34;egp&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Add an XML Schema.&#34;
        },
        &#34;version&#34;: &#34;1.0.1&#34;
      },
      {
        &#34;date&#34;: &#34;2024-04-04&#34;,
        &#34;initials&#34;: &#34;XEP Editor (dg)&#34;,
        &#34;remark&#34;: &#34;Accept as Stable as per Council Vote from 2024-04-02.&#34;,
        &#34;version&#34;: &#34;1.0.0&#34;
      },
      {
        &#34;date&#34;: &#34;2022-10-07&#34;,
        &#34;initials&#34;: &#34;mw&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: [
            &#34;Various changes, made in parallel with working client and server implementation experience, and SASL2 updates.&#34;,
            &#34;More tightly define the integration with XEP-0388 and several session feature XEPs: XEP-0198, XEP-0280, XEP-0352.&#34;,
            &#34;Replace the custom latest-id element with the new metadata element from XEP-0313, which also provides richer information.&#34;,
            &#34;Drop unread tracking, as this is a deep topic not directly related to resource binding. Instead the details of integration with other extensions have been better defined and demonstrated, to allow such functionality when it is fully defined and exists.&#34;,
            &#34;Adjust proposed namespace on aesthetic grounds and consistency with SASL2&#39;s approach. As this protocol may become part of the new preferred connection flow for a long time to come, it makes no sense to include the redundant and potentially confusing &#39;2&#39; when there is no conflict without it. Similarly, the &#39;.0&#39; has been dropped from the XEP&#39;s title, as it isn&#39;t really a version number.&#34;,
            &#34;Allow the client some influence over the resulting resource identifier, and define a standard format for these combined identifiers.&#34;,
            &#34;Specify that servers should terminate old sessions from a client when it binds a new resource.&#34;
          ]
        },
        &#34;version&#34;: &#34;0.4.0&#34;
      },
      {
        &#34;date&#34;: &#34;2019-01-31&#34;,
        &#34;initials&#34;: &#34;kis&#34;,
        &#34;remark&#34;: &#34;Begrudingly allow non-unread-tracking servers, mention SASL2.&#34;,
        &#34;version&#34;: &#34;0.3.0&#34;
      },
      {
        &#34;date&#34;: &#34;2018-02-08&#34;,
        &#34;initials&#34;: &#34;XEP Editor (jc)&#34;,
        &#34;remark&#34;: &#34;Defer due to lack of activity.&#34;,
        &#34;version&#34;: &#34;0.2.0&#34;
      },
      {
        &#34;date&#34;: &#34;2017-02-08&#34;,
        &#34;initials&#34;: &#34;XEP Editor: ssw&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;First draft accepted by the XMPP Council.&#34;
        },
        &#34;version&#34;: &#34;0.1.0&#34;
      }
    ],
    &#34;shortname&#34;: &#34;bind2&#34;,
    &#34;sig&#34;: &#34;Standards&#34;,
    &#34;status&#34;: &#34;Draft&#34;,
    &#34;supersededby&#34;: &#34;&#34;,
    &#34;supersedes&#34;: &#34;&#34;,
    &#34;title&#34;: &#34;Bind 2&#34;,
    &#34;type&#34;: &#34;Standards Track&#34;
  },
  &#34;section1&#34;: [
    {
      &#34;-anchor&#34;: &#34;intro&#34;,
      &#34;-topic&#34;: &#34;Introduction&#34;,
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;Every session on XMPP generally has a unique routable identifier, known as a \&#34;resource\&#34;. Many details and rules about resources in XMPP can be found in&#34;,
          &#34;note&#34;: [
            {
              &#34;#text&#34;: &#34;RFC 6120: Extensible Messaging and Presence Protocol (XMPP): Core \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0388: Extensible SASL Profile \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0388.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0388.html&#34;
              }
            }
          ],
          &#34;span&#34;: [
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;RFC 6120&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Extensible SASL Profile (XEP-0388)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0388.html&#34;
              }
            }
          ]
        },
        &#34;As XMPP has grown more feature-rich over time, more steps have been introduced that clients are likely to perform at startup, e.g. resource binding, archive synchronisation, enabling Carbons. Some of these introduce race conditions - e.g. if a client synchronises the archive before enabling Carbons, it can miss stanzas sent between these events, or if it enables Carbons before synchronising the archive it can receive duplicate messages. It may also cause duplicate messages by combining archive synchronisation and receipt of offline messages, or by receipt of messages addressed to the full JID between resource binding and archive synchronisation. Therefore, this document provides a mechanism for atomically performing these operations to avoid these race conditions. It also allows the server to provide information to a client that is generally useful about the state of the user&#39;s account.&#34;
      ]
    },
    {
      &#34;-anchor&#34;: &#34;reqs&#34;,
      &#34;-topic&#34;: &#34;Requirements&#34;,
      &#34;ul&#34;: {
        &#34;li&#34;: [
          {
            &#34;#text&#34;: &#34;Reduce round-trips and race conditions by providing a single atomic session establishment operation, with support for common session features such as&#34;,
            &#34;note&#34;: [
              {
                &#34;#text&#34;: &#34;XEP-0280: Message Carbons \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0280.html&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0280.html&#34;
                }
              },
              {
                &#34;#text&#34;: &#34;XEP-0313: Message Archive Management \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0313.html&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0313.html&#34;
                }
              },
              {
                &#34;#text&#34;: &#34;XEP-0198: Stream Management \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0198.html&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0198.html&#34;
                }
              }
            ],
            &#34;span&#34;: [
              {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;Message Carbons (XEP-0280)&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0280.html&#34;
                }
              },
              {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;Message Archive Management (XEP-0313)&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0313.html&#34;
                }
              },
              {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;Stream Management (XEP-0198)&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0198.html&#34;
                }
              }
            ]
          },
          &#34;Integrate with SASL2 (XEP-0388) for further round-trip reduction and simpler session establishment.&#34;
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;usecases&#34;,
      &#34;-topic&#34;: &#34;Use Cases&#34;,
      &#34;section2&#34;: [
        {
          &#34;-topic&#34;: &#34;Discovering support&#34;,
          &#34;example&#34;: {
            &#34;#text&#34;: &#34;\u003cstream:features\u003e\n  \u003cauthentication xmlns=&#39;urn:xmpp:sasl:2&#39;\u003e\n    \u003cmechanism\u003eSCRAM-SHA-1\u003c/mechanism\u003e\n    \u003cmechanism\u003eSCRAM-SHA-1-PLUS\u003c/mechanism\u003e\n    \u003cinline\u003e\n      \u003cbind xmlns=&#39;urn:xmpp:bind:0&#39;\u003e\n        \u003cinline\u003e\n          \u003cfeature var=\&#34;urn:xmpp:carbons:2\&#34; /\u003e\n          \u003cfeature var=\&#34;urn:xmpp:csi:0\&#34; /\u003e\n          \u003cfeature var=\&#34;urn:xmpp:sm:3\&#34; /\u003e\n        \u003c/inline\u003e\n      \u003c/bind\u003e\n      \u003csm xmlns=&#39;urn:xmpp:sm:3&#39;/\u003e\n    \u003c/inline\u003e\n  \u003c/authentication\u003e\n\u003c/stream:features\u003e&#34;,
            &#34;-caption&#34;: &#34;Server advertises support in stream features&#34;
          },
          &#34;p&#34;: [
            &#34;If a server supports Bind 2, it MUST advertise this within the SASL2 \u003cinline/\u003e element in the stream features, with a feature named &#39;bind&#39; in the namespace &#39;urn:xmpp:bind:0&#39;.&#34;,
            &#34;Clients do not advertise support for Bind 2.&#34;,
            &#34;Bind 2 supports inline negotiation of certain features specific to a session. The features supported by the server for such inline negotiation MUST be included in an \u003cinline/\u003e child element within the bind feature element. Each feature is listed as a \u003cfeature/\u003e child element with a &#39;var&#39; attribute indicating the extension&#39;s defined service discovery feature name or namespace.&#34;,
            &#34;Bind 2 is never supported without SASL2, and so servers without support for SASL2 MUST NOT advertise the feature. Servers supporting SASL2 and Bind 2 may continue to offer legacy resource binding to clients.&#34;
          ]
        },
        {
          &#34;-anchor&#34;: &#34;bind-request&#34;,
          &#34;-topic&#34;: &#34;Performing the bind&#34;,
          &#34;example&#34;: [
            {
              &#34;#text&#34;: &#34;\u003cauthenticate xmlns=&#39;urn:xmpp:sasl:2&#39; mechanism=&#39;SCRAM-SHA-1&#39;\u003e\n  \u003cinitial-response\u003e[base64 encoded SASL data]\u003c/initial-response\u003e\n  \u003cbind xmlns=&#39;urn:xmpp:bind:0&#39;\u003e\n    \u003ctag\u003eAwesomeXMPP\u003c/tag\u003e\n  \u003c/bind\u003e\n\u003c/authenticate\u003e&#34;,
              &#34;-caption&#34;: &#34;Client provides a resource bind request&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003cauthenticate xmlns=&#39;urn:xmpp:sasl:2&#39; mechanism=&#39;SCRAM-SHA-1&#39;\u003e\n  \u003cinitial-response\u003e[base64 encoded SASL data]\u003c/initial-response\u003e\n  \u003cbind xmlns=&#39;urn:xmpp:bind:0&#39;\u003e\n    \u003ctag\u003eAwesomeXMPP\u003c/tag\u003e\n    \u003cenable xmlns=&#39;urn:xmpp:carbons:2&#39;/\u003e\n    \u003cenable xmlns=&#39;urn:xmpp:sm:3&#39;/\u003e\n    \u003cinactive xmlns=&#39;urn:xmpp:csi:0&#39;/\u003e\n  \u003c/bind\u003e\n\u003c/authenticate\u003e&#34;,
              &#34;-caption&#34;: &#34;Client provides a resource bind request, additionally requesting some session features&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003csuccess xmlns=&#39;urn:xmpp:sasl:2&#39;\u003e\n  \u003cauthorization-identity\u003euser@example.com/AwesomeXMPP.4232f4d4\u003c/authorization-identity\u003e\n  \u003cbound xmlns=&#39;urn:xmpp:bind:0&#39;\u003e\n    \u003cmetadata xmlns=&#39;urn:xmpp:mam:2&#39;\u003e\n      \u003cstart id=&#39;YWxwaGEg&#39; timestamp=&#39;2008-08-22T21:09:04Z&#39; /\u003e\n      \u003cend id=&#39;b21lZ2Eg&#39; timestamp=&#39;2020-04-20T14:34:21Z&#39; /\u003e\n    \u003c/metadata\u003e\n  \u003c/bound\u003e\n\u003c/success\u003e&#34;,
              &#34;-caption&#34;: &#34;Server responds after processing the bind&#34;
            }
          ],
          &#34;p&#34;: [
            &#34;To request resource binding, the client MUST include a \u003cbind/\u003e element, qualified by the &#39;urn:xmpp:bind:0&#39; namespace, in its SASL2 \u003cauthenticate/\u003e request.&#34;,
            &#34;The \u003cbind/\u003e element MAY contain the following child elements:&#34;,
            &#34;Additionally, the \u003cbind/\u003e element MAY contain one or more child elements in other namespaces, representing features that the client requests to be automatically enabled for its new session.&#34;,
            &#34;If the client included a \u003cbind/\u003e element in its SASL2 \u003cauthenticate/\u003e then the server MUST process the bind request after authentication is successful (including any necessary subsequent SASL2 tasks), but before sending the \u003csuccess/\u003e response. Following the usual rules of SASL2, the bind request MUST NOT be processed (i.e. it should be ignored) if the authentication is not successful.&#34;,
            {
              &#34;#text&#34;: &#34;Note: If the client included a \u003cresume/\u003e element in its SASL2 negotiation, that MUST be processed first by the server. If that resumption is successful, the server MUST skip resource binding (a resumed session already has a resource bound) and MUST entirely ignore the \u003cbind/\u003e request. If resumption of the previous stream fails, the server MUST include the XEP-0198 failure in the response, and then MUST proceed to process the bind request to establish a new session for the client.&#34;,
              &#34;-class&#34;: &#34;box&#34;
            },
            &#34;Upon processing the bind request, the server MUST perform several operations, including:&#34;,
            &#34;Upon successful binding of a resource, the server SHOULD terminate any earlier sessions from the same client (identified by the \u003cuser-agent\u003e &#39;id&#39; attribute in its SASL2 authentication request).&#34;,
            &#34;After processing the bind request as described above, the server MUST respond with the SASL \u003csuccess/\u003e element, including the client&#39;s full JID in the \u003cauthorization-identity/\u003e element, and a \u003cbound/\u003e element qualified by the &#39;urn:xmpp:bind:0&#39; namespace, as in the following example:&#34;,
            &#34;The server SHOULD include a \u003cmetadata/\u003e element as defined by XEP-0313, describing the state of the user&#39;s message archive at the precise time of resource binding. This helps the client determine what queries it may need to perform to synchronise messages.&#34;,
            &#34;Interactions with certain other extensions are hereby defined in this document:&#34;,
            &#34;The \u003cbound/\u003e response MUST also contain any defined responses to other enabled features, if any, though details of these are beyond the scope of this specification.&#34;
          ],
          &#34;section3&#34;: {
            &#34;-anchor&#34;: &#34;identifiers&#34;,
            &#34;-topic&#34;: &#34;Resource identifier generation&#34;,
            &#34;p&#34;: [
              {
                &#34;#text&#34;: &#34;If the client provided a \u003ctag/\u003e element in its bind request, the text content of that element SHOULD be included as-is in the final resource identifier, subject to the necessary validation for resource identifiers. This tag can help with client identification and debugging. The RECOMMENDED format is to include the client tag as a prefix of the server-generated identifier, separated by a single &#39;/&#39; character:&#34;,
                &#34;tt&#34;: [
                  &#34;[client tag]/[server generated identifier]&#34;,
                  &#34;AwesomeXMPP/rQ7Lwut0CcxW6&#34;
                ]
              },
              &#34;Servers MAY choose to assign stable resource identifiers to clients, i.e. ensuring the same client will receive the same resource identifier for every bind request it makes. If a server or deployment provides resource identifier stability, the generated identifier SHOULD remain stable for every bind request with the same \u003ctag/\u003e and SASL2 \u003cuser-agent\u003e id. The SASL2 \u003cuser-agent\u003e id itself MUST NOT be exposed by the server in the generated resource identifier.&#34;
            ]
          },
          &#34;ul&#34;: [
            {
              &#34;li&#34;: {
                &#34;#text&#34;: &#34;\u003ctag/\u003e: This element contains a short text string that typically identifies the software the user is using, mostly useful for diagnostic purposes for users, operators and developers. This tag may be visible to other entities on the XMPP network (see&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;Security Considerations&#34;,
                  &#34;-url&#34;: &#34;#security&#34;
                }
              }
            },
            {
              &#34;li&#34;: [
                &#34;Clear the offline messages for this user, if any, without sending them (as they will be provided by MAM).&#34;,
                &#34;Generate a resource identifier (per the rules below) and bind it to the current stream&#34;,
                &#34;Get the archive id of the newest stanza in the user&#39;s MAM archive&#34;,
                &#34;Enable any additional features requested by the client for this session&#34;
              ]
            },
            {
              &#34;li&#34;: [
                &#34;If the client included a XEP-0198 \u003cenable/\u003e element in the requested features, Stream Management should be enabled at this point. The \u003cbound/\u003e response MUST contain the resulting XEP-0198 \u003cenabled/\u003e (or \u003cfailed/\u003e) element. For full business rules, syntax  and examples, see XEP-0198.&#34;,
                &#34;If the client included a XEP-0280 \u003cenable/\u003e element in the requested features, Message Carbons MUST be enabled at this point. As this operation MUST succeed, no response is necessary.&#34;,
                &#34;If the client included a XEP-0352 \u003cactive/\u003e or \u003cinactive/\u003e element, the session must begin in that state.&#34;
              ]
            }
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;security&#34;,
      &#34;-topic&#34;: &#34;Security Considerations&#34;,
      &#34;p&#34;: [
        &#34;This specification mostly combines existing protocols together. Security considerations defined in those XEPs should be heeded as normal.&#34;,
        &#34;The additional facility provided here to provide information on the user&#39;s archive is provided post-authentication and is only providing the user&#39;s data to the user.&#34;,
        &#34;Implementations must adhere to the security considerations defined in XEP-0388 regarding the inclusion of SASL2 requests and inline feature negotiation in TLS 0-RTT (\&#34;early data\&#34;) extensions. That is, they MUST NOT be sent or processed, except when appropriate mitigations are in place (which are beyond the scope of this document, but may be defined by others).&#34;,
        &#34;As it forms part of the resource identifier and therefore the full JID of the session, the &#39;tag&#39; value provided by the client (if any), may be visible to other XMPP entities on the network that the client communicates with or that have access to the user&#39;s presence. The simple name of the client can provide value to users, operators and developers diagnosing issues, and it generally will not reveal more information than would be already available through service discovery. Unless they are operating in fully trusted environments, clients MUST NOT use identifiers that might reveal private information about a user or their system (such as hostnames).&#34;
      ]
    },
    {
      &#34;-anchor&#34;: &#34;iana&#34;,
      &#34;-topic&#34;: &#34;IANA Considerations&#34;,
      &#34;p&#34;: &#34;None.&#34;
    },
    {
      &#34;-anchor&#34;: &#34;registrar&#34;,
      &#34;-topic&#34;: &#34;XMPP Registrar Considerations&#34;,
      &#34;p&#34;: &#34;The urn:xmpp:bind:0 namespace must be registered..&#34;
    },
    {
      &#34;-anchor&#34;: &#34;schema&#34;,
      &#34;-topic&#34;: &#34;XML Schema&#34;,
      &#34;code&#34;: &#34;\u003c?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?\u003e\n\n\u003cxs:schema\n    xmlns:xs=&#39;http://www.w3.org/2001/XMLSchema&#39;\n    xmlns:mam=&#39;urn:xmpp:mam:2&#39;\n    xmlns=&#39;urn:xmpp:bind:0&#39;\n    targetNamespace=&#39;urn:xmpp:bind:0&#39;\n    elementFormDefault=&#39;qualified&#39;\u003e\n\n  \u003cxs:annotation\u003e\n    \u003cxs:documentation\u003e\n      The protocol documented by this schema is defined in\n      XEP-0386: https://xmpp.org/extensions/xep-0386.html\n    \u003c/xs:documentation\u003e\n  \u003c/xs:annotation\u003e\n\n  \u003cxs:import namespace=&#39;urn:xmpp:mam:2&#39;\n    schemaLocation=&#39;xep-0313.xsd&#39;/\u003e\n\n  \u003cxs:element name=&#39;bind&#39;\u003e\n    \u003cxs:complexType\u003e\n      \u003cxs:choice\u003e\n        \u003cxs:element ref=&#39;inline&#39;/\u003e\n        \u003cxs:sequence\u003e\n          \u003cxs:element ref=&#39;tag&#39; minOccurs=&#39;0&#39;/\u003e\n          \u003cxs:any namespace=&#39;##other&#39; minOccurs=&#39;0&#39; maxOccurs=&#39;unbounded&#39; processContents=&#39;lax&#39;/\u003e\n        \u003c/xs:sequence\u003e\n      \u003c/xs:choice\u003e\n    \u003c/xs:complexType\u003e\n  \u003c/xs:element\u003e\n\n  \u003cxs:element name=&#39;inline&#39;\u003e\n    \u003cxs:complexType\u003e\n      \u003cxs:sequence\u003e\n        \u003cxs:element ref=&#39;feature&#39; maxOccurs=&#39;unbounded&#39;/\u003e\n      \u003c/xs:sequence\u003e\n    \u003c/xs:complexType\u003e\n  \u003c/xs:element\u003e\n\n  \u003cxs:element name=&#39;feature&#39;\u003e\n    \u003cxs:complexType\u003e\n      \u003cxs:attribute name=&#39;var&#39; type=&#39;xs:string&#39;/\u003e\n    \u003c/xs:complexType\u003e\n  \u003c/xs:element\u003e\n\n  \u003cxs:element name=&#39;tag&#39; type=&#39;xs:string&#39;/\u003e\n\n  \u003cxs:element name=&#39;bound&#39;\u003e\n    \u003cxs:complexType\u003e\n      \u003cxs:sequence\u003e\n        \u003cxs:element ref=&#39;mam:metadata&#39; minOccurs=&#39;0&#39;/\u003e\n      \u003c/xs:sequence\u003e\n    \u003c/xs:complexType\u003e\n  \u003c/xs:element\u003e\n\n\u003c/xs:schema\u003e&#34;
    },
    {
      &#34;-anchor&#34;: &#34;acknowledgements&#34;,
      &#34;-topic&#34;: &#34;Acknowledgements&#34;,
      &#34;p&#34;: &#34;Thanks to Daniel Gultsch, Philipp Hörist, Thilo Molitor and Andrzej Wójcik for their valuable support with feedback, suggestions and implementations.&#34;
    }
  ]
}</pre></a><br>XEP-0386: Bind 2.0</td><td>planned</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0420.html>xep-0420:<pre>{
  &#34;-xmlns&#34;: &#34;&#34;,
  &#34;header&#34;: {
    &#34;abstract&#34;: &#34;The Stanza Content Encryption (SCE) protocol is intended as a way to allow clients to securely exchange arbitrary extension elements using different end-to-end encryption schemes.&#34;,
    &#34;approver&#34;: &#34;Council&#34;,
    &#34;author&#34;: {
      &#34;email&#34;: &#34;vanitasvitae@riseup.net&#34;,
      &#34;firstname&#34;: &#34;Paul&#34;,
      &#34;jid&#34;: &#34;vanitasvitae@jabberhead.tk&#34;,
      &#34;surname&#34;: &#34;Schaub&#34;
    },
    &#34;dependencies&#34;: {
      &#34;spec&#34;: [
        &#34;XMPP Core&#34;,
        &#34;XEP-0001&#34;,
        &#34;Etc.&#34;
      ]
    },
    &#34;legal&#34;: {
      &#34;conformance&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol has been contributed in full conformance with the XSF&#39;s Intellectual Property Rights Policy (a copy of which can be found at \u003c&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;
        }
      },
      &#34;copyright&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol is copyright © 1999 – 2024 by the&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;XMPP Standards Foundation&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/&#34;
        }
      },
      &#34;liability&#34;: &#34;In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.&#34;,
      &#34;permissions&#34;: &#34;Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \&#34;Specification\&#34;), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.&#34;,
      &#34;warranty&#34;: &#34;## NOTE WELL: This Specification is provided on an \&#34;AS IS\&#34; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##&#34;
    },
    &#34;number&#34;: &#34;0420&#34;,
    &#34;revision&#34;: [
      {
        &#34;date&#34;: &#34;2021-11-18&#34;,
        &#34;initials&#34;: &#34;melvo&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Clarify bare JID usage and improve sentences:&#34;,
          &#34;ul&#34;: {
            &#34;li&#34;: [
              &#34;Clarify usage of bare JIDs for affix elements&#34;,
              &#34;Improve and correct sentences about affix elements&#34;
            ]
          }
        },
        &#34;version&#34;: &#34;0.4.1&#34;
      },
      {
        &#34;date&#34;: &#34;2021-04-07&#34;,
        &#34;initials&#34;: &#34;melvo&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: [
            &#34;Use &#39;envelope&#39; and &#39;content&#39; consistently by renaming elements&#34;,
            {
              &#34;#text&#34;: &#34;Update namespace to&#34;,
              &#34;tt&#34;: &#34;urn:xmpp:sce:1&#34;
            }
          ]
        },
        &#34;version&#34;: &#34;0.4.0&#34;
      },
      {
        &#34;date&#34;: &#34;2021-03-04&#34;,
        &#34;initials&#34;: &#34;mw&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Cross-document editorial adjustments for inclusive language.&#34;
        },
        &#34;version&#34;: &#34;0.3.2&#34;
      },
      {
        &#34;date&#34;: &#34;2020-11-03&#34;,
        &#34;initials&#34;: &#34;melvo&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Fix misspelling of &#39;whose&#39;&#34;
        },
        &#34;version&#34;: &#34;0.3.1&#34;
      },
      {
        &#34;date&#34;: &#34;2020-07-03&#34;,
        &#34;initials&#34;: &#34;ps&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: [
            &#34;Allow origin-id elements, disallow stanza-id and extended stanza addressing elements inside the payload element&#34;,
            &#34;Clarify wording on stanza processed elements and improve XEP formatting&#34;,
            &#34;Remove limitation of random padding content to base64 characters alone&#34;,
            &#34;Chat messages MUST contain message processing store hint&#34;,
            &#34;Credit where credit is due&#34;
          ]
        },
        &#34;version&#34;: &#34;0.3.0&#34;
      },
      {
        &#34;date&#34;: &#34;2019-10-04&#34;,
        &#34;initials&#34;: &#34;ps&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: [
            &#34;Specify IQ encryption&#34;,
            &#34;Add examples and addenda&#34;
          ]
        },
        &#34;version&#34;: &#34;0.2.0&#34;
      },
      {
        &#34;date&#34;: &#34;2019-07-30&#34;,
        &#34;initials&#34;: &#34;XEP Editor (jsc)&#34;,
        &#34;remark&#34;: &#34;Accepted by vote of Council on 2019-06-26.&#34;,
        &#34;version&#34;: &#34;0.1.0&#34;
      },
      {
        &#34;date&#34;: &#34;2019-06-03&#34;,
        &#34;initials&#34;: &#34;ps&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;First draft.&#34;
        },
        &#34;version&#34;: &#34;0.0.1&#34;
      }
    ],
    &#34;shortname&#34;: &#34;SCE&#34;,
    &#34;sig&#34;: &#34;Standards&#34;,
    &#34;status&#34;: &#34;Experimental&#34;,
    &#34;supersededby&#34;: &#34;&#34;,
    &#34;supersedes&#34;: &#34;&#34;,
    &#34;title&#34;: &#34;Stanza Content Encryption&#34;,
    &#34;type&#34;: &#34;Standards Track&#34;
  },
  &#34;section1&#34;: [
    {
      &#34;-anchor&#34;: &#34;intro&#34;,
      &#34;-topic&#34;: &#34;Introduction&#34;,
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;There is a number of different end-to-end encryption mechanisms that can be used to secure user communication against unauthorized access from malicious third parties. Popular examples for this are&#34;,
          &#34;note&#34;: [
            {
              &#34;#text&#34;: &#34;XEP-0384: OMEMO Encryption \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0373: OpenPGP for XMPP \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;
              }
            }
          ],
          &#34;span&#34;: [
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;OMEMO Encryption (XEP-0384)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;OpenPGP for XMPP (XEP-0373)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;
              }
            }
          ]
        },
        {
          &#34;#text&#34;: &#34;While the latter allows for encryption of arbitrary extension elements, protocols such as&#34;,
          &#34;note&#34;: [
            {
              &#34;#text&#34;: &#34;XEP-0384: OMEMO Encryption \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0385: Stateless Inline Media Sharing (SIMS) \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0385.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0385.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0308: Last Message Correction \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0308.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0308.html&#34;
              }
            }
          ],
          &#34;span&#34;: [
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;OMEMO Encryption (XEP-0384)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Stateless Inline Media Sharing (XEP-0385)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0385.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Last Message Correction (XEP-0308)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0308.html&#34;
              }
            }
          ]
        },
        {
          &#34;#text&#34;: &#34;This extension protocol proposes a solution to aforementioned issues by generalizing the OpenPGP Content Elements (eg.&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;\u003csigncrypt\u003e&#34;,
            &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html#example-2&#34;
          },
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;XEP-0373: OpenPGP for XMPP \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;OpenPGP for XMPP (XEP-0373)&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;
            }
          }
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;reqs&#34;,
      &#34;-topic&#34;: &#34;Requirements&#34;,
      &#34;p&#34;: [
        &#34;This proposal widens the scope of the security guarantees given by the used encryption mechanism from just the body of the message to various extension elements. It is intended to serve as a \&#34;one size fits all\&#34; solution for extension element encryption in XMPP.&#34;,
        &#34;In order to achieve its goal, Stanza Content Encryption does the following:&#34;
      ],
      &#34;ul&#34;: {
        &#34;li&#34;: [
          &#34;Define elements that hold sensitive information&#34;,
          &#34;Speficy rules about how extension elements are encrypted and embedded in the message&#34;,
          &#34;Specify rules about which elements are allowed inside and outside the protected domain&#34;
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;glossary&#34;,
      &#34;-topic&#34;: &#34;Glossary&#34;,
      &#34;dl&#34;: {
        &#34;di&#34;: [
          {
            &#34;dd&#34;: &#34;An XMPP extension element which is used to hold the \u003ccontent/\u003e element and the affix elements.\n            The XML representation of this element is encrypted and then embedded as the payload of the message being sent.&#34;,
            &#34;dt&#34;: &#34;Envelope Element \u003cenvelope/\u003e&#34;
          },
          {
            &#34;dd&#34;: &#34;An element which is used to contain all extension elements which need to be encrypted.&#34;,
            &#34;dt&#34;: &#34;Content Element \u003ccontent/\u003e&#34;
          }
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;affix_elements&#34;,
      &#34;-topic&#34;: &#34;Affix Elements&#34;,
      &#34;example&#34;: {
        &#34;#text&#34;: &#34;\u003ctime stamp=&#39;2004-01-25T06:05:00&#43;01:00&#39;/\u003e\n\u003cto jid=&#39;missioncontrol@houston.nasa.gov&#39;/\u003e\n\u003cfrom jid=&#39;opportunity@mars.planet&#39;/\u003e\n\u003crpad\u003eC1DHN9HK-9A25tSmwK4hU!Jji9%GKYK^syIlHJT9TnI4\u003c/rpad\u003e&#34;,
        &#34;-caption&#34;: &#34;Examples of Affix Elements&#34;
      },
      &#34;p&#34;: [
        &#34;In order to prevent certain attacks, different affix elements MAY be added as direct child elements of the \u003cenvelope/\u003e element.&#34;,
        &#34;Encryption protocols that make use of Stanza Content Encryption MUST define their own profiles that describe mandatory behaviour of which of these elements are used. They MAY also define and add their own specific affix elements.&#34;
      ],
      &#34;table&#34;: {
        &#34;-caption&#34;: &#34;Overview about different crypto property elements&#34;,
        &#34;tr&#34;: [
          {
            &#34;th&#34;: [
              &#34;Element&#34;,
              &#34;Description&#34;,
              &#34;Usage&#34;,
              &#34;Verification&#34;
            ]
          },
          {
            &#34;td&#34;: [
              &#34;\u003crpad/\u003e&#34;,
              &#34;Random-length random-content padding&#34;,
              &#34;Prevent known ciphertext and message length correlation attacks. The content of this element is a randomly generated sequence of random length between 0 and 200 characters. TODO: sane boundaries?&#34;,
              &#34;None. This element is only used to change the length of the ciphertext and doesn&#39;t need to be verified&#34;
            ]
          },
          {
            &#34;td&#34;: [
              &#34;\u003ctime/\u003e&#34;,
              &#34;Timestamp&#34;,
              {
                &#34;#text&#34;: &#34;Prevent replay attacks using old messages. This element MUST have one attribute &#39;stamp&#39;, whose value is a timestamp following the format described in&#34;,
                &#34;note&#34;: {
                  &#34;#text&#34;: &#34;XEP-0082: XMPP Date and Time Profiles \u003c&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0082.html&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0082.html&#34;
                  }
                },
                &#34;span&#34;: {
                  &#34;-class&#34;: &#34;ref&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;XMPP Date and Time Profiles (XEP-0082)&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0082.html&#34;
                  }
                }
              },
              &#34;Receiving clients MUST check whether the difference between the timestamp and the sending time derived from the stanza itself lays within a reasonable margin. The client SHOULD use the content of the timestamp element when displaying the send date of the message&#34;
            ]
          },
          {
            &#34;td&#34;: [
              &#34;\u003cto/\u003e&#34;,
              &#34;Recipient of the message&#34;,
              &#34;Prevent spoofing of the recipient. This element MUST have one attribute &#39;jid&#39; whose value is the bare JID of the message&#39;s recipient.&#34;,
              &#34;Receiving clients MUST check if the JID matches the to attribute of the enclosing stanza and otherwise alert the user/reject the message&#34;
            ]
          },
          {
            &#34;td&#34;: [
              &#34;\u003cfrom/\u003e&#34;,
              &#34;Sender of the message&#34;,
              &#34;Prevent spoofing of the sender. This element MUST have one attribute &#39;jid&#39; whose value is the bare JID of the message&#39;s sender.&#34;,
              &#34;Receiving clients MUST check if the value matches the from attribute of the enclosing stanza and otherwise alert the user/reject the message&#34;
            ]
          }
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;motivation&#34;,
      &#34;-topic&#34;: &#34;Motivation&#34;,
      &#34;example&#34;: [
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;narrator@jabber.org&#39;\n         to=&#39;viewer@jabber.org&#39;\u003e\n  \u003cencrypted xmlns=&#39;eu.siacs.conversations.axolotl&#39;\u003e\n    \u003cheader sid=&#39;27183&#39;\u003e\n      ...\n    \u003c/header\u003e\n    \u003cpayload\u003e\n      SSBnb3QgaW4gZXZlcnlvbmUncyBob3N0aWxlIGxpdHRsZSBmYWNlLiBZZXMsIHRoZXNlIGFyZSBi\n      cnVpc2VzIGZyb20gZmlnaHRpbmcuIFllcywgSSdtIGNvbWZvcnRhYmxlIHdpdGggdGhhdC4gSSBh\n      bSBlbmxpZ2h0ZW5lZC4=\n    \u003c/payload\u003e\n  \u003c/encrypted\u003e\n  \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n    \u003curl\u003ehttps://en.wikipedia.org/wiki/Fight_Club#Plot\u003c/url\u003e\n  \u003c/x\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;An imperfectly encrypted message which leaks dangerous information about the conversation through the plaintext OOB extension element&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003ciq from=&#39;doctor@shakespeare.lit/pda&#39;\n    id=&#39;get-data-1&#39;\n    to=&#39;ladymacbeth@shakespeare.lit/castle&#39;\n    type=&#39;get&#39;\u003e\n  \u003cdata xmlns=&#39;urn:xmpp:bob&#39;\n        cid=&#39;sha1&#43;8f35fef110ffc5df08d579a50083ff9308fb6242@bob.xmpp.org&#39;/\u003e\n\u003c/iq\u003e&#34;,
          &#34;-caption&#34;: &#34;Unencrypted IQ request&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003ciq from=&#39;ladymacbeth@shakespeare.lit/castle&#39;\n    id=&#39;get-data-1&#39;\n    to=&#39;doctor@shakespeare.lit/pda&#39;\n    type=&#39;result&#39;\u003e\n  \u003cdata xmlns=&#39;urn:xmpp:bob&#39;\n        cid=&#39;sha1&#43;8f35fef110ffc5df08d579a50083ff9308fb6242@bob.xmpp.org&#39;\n        max-age=&#39;86400&#39;\n        type=&#39;image/png&#39;\u003e\n    iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs&#43;9AAAABGdBTUEAALGP\n    C/xhBQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9YGARc5KB0XV&#43;IA\n    AAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAF1J\n    REFUGNO9zL0NglAAxPEfdLTs4BZM4DIO4C7OwQg2JoQ9LE1exdlYvBBeZ7jq\n    ch9//q1uH4TLzw4d6&#43;ErXMMcXuHWxId3KOETnnXXV6MJpcq2MLaI97CER3N0\n    vr4MkhoXe0rZigAAAABJRU5ErkJggg==\n  \u003c/data\u003e\n\u003c/iq\u003e&#34;,
          &#34;-caption&#34;: &#34;Likewise unencrypted reply&#34;
        }
      ],
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;Some end-to-end encryption protocols like&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;XEP-0384: OMEMO Encryption \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;OMEMO Encryption (XEP-0384)&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0384.html&#34;
            }
          }
        },
        &#34;The example above obviously leaks information about the communication through the unencrypted OOB extension element.&#34;,
        &#34;Most end-to-end encryption mechanisms are also focussed solely on message content encryption and do not tackle \u003ciq/\u003e requests/replies at all. Stanza Content Encryption can be applied to those as well.&#34;
      ]
    },
    {
      &#34;-anchor&#34;: &#34;usecases&#34;,
      &#34;-topic&#34;: &#34;Use Cases&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;use-case-message&#34;,
          &#34;-topic&#34;: &#34;Use in \u003cmessage/\u003e stanzas&#34;,
          &#34;example&#34;: [
            {
              &#34;#text&#34;: &#34;\u003cenvelope xmlns=&#39;urn:xmpp:sce:1&#39;\u003e\n  \u003ccontent\u003e\n    \u003cbody xmlns=&#39;jabber:client&#39;\u003e[...]\u003c/body\u003e\n    \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n      \u003curl\u003ehttps://en.wikipedia.org/wiki/Fight_Club#Plot\u003c/url\u003e\n    \u003c/x\u003e\n  \u003c/content\u003e\n\u003c/envelope\u003e&#34;,
              &#34;-caption&#34;: &#34;Envelope element containing the messages body and the OBB element.&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003cmessage from=&#39;narrator@jabber.org&#39;\n         to=&#39;viewer@jabber.org&#39;\u003e\n  \u003cencrypted xmlns=&#39;urn:xmpp:encryption:stub:sce:1&#39;\u003e\n    \u003cpayload\u003e\n      PGNvbnRlbnQgeG1sbnM9J3Vybjp4bXBwOnNjZTowJz48cGF5bG9hZD48Ym9keSB4bWxucz0namFi\n      YmVyOmNsaWVudCc&#43;SSBnb3QgaW4gZXZlcnlvbmUncyBob3N0aWxlIGxpdHRsZSBmYWNlLiBZZXMs\n      IHRoZXNlIGFyZSBicnVpc2VzIGZyb20gZmlnaHRpbmcuIFllcywgSSdtIGNvbWZvcnRhYmxlIHdp\n      dGggdGhhdC4gSSBhbSBlbmxpZ2h0ZW5lZC48L2JvZHk&#43;PHggeG1sbnM9J2phYmJlcjp4Om9vYic&#43;\n      PHVybD5odHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaWdodF9DbHViI1Bsb3Q8L3VybD48\n      L3g&#43;PC9wYXlsb2FkPjwvY29udGVudD4=\n    \u003c/payload\u003e\n  \u003c/encrypted\u003e\n\u003c/message\u003e&#34;,
              &#34;-caption&#34;: &#34;Finished message stanza containing the \u003cenvelope/\u003e element from the previous example, inside of its payload element, encrypted using a hypothetical encryption protocol and SCE.&#34;
            }
          ],
          &#34;p&#34;: [
            &#34;The main use case of Stanza Content Encryption is the use of end-to-end encryption protocols in combination with extension protocols that store sensitive information in other places than the message body.&#34;,
            {
              &#34;#text&#34;: &#34;This applies to many extension elements that add additional information to \u003cmessage/\u003e stanzas, such as those of&#34;,
              &#34;note&#34;: {
                &#34;#text&#34;: &#34;XEP-0066: Out of Band Data \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;
                }
              },
              &#34;span&#34;: {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;Out-of-Band Data (XEP-0066)&#34;,
                  &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;
                }
              }
            }
          ]
        },
        {
          &#34;-anchor&#34;: &#34;use-case-iq&#34;,
          &#34;-topic&#34;: &#34;Use in \u003ciq/\u003e stanzas&#34;,
          &#34;example&#34;: [
            {
              &#34;#text&#34;: &#34;\u003cenvelope xmlns=&#39;urn:xmpp:sce:1&#39;\u003e\n  \u003ccontent\u003e\n    \u003cdata xmlns=&#39;urn:xmpp:bob&#39;\n        cid=&#39;sha1&#43;8f35fef110ffc5df08d579a50083ff9308fb6242@bob.xmpp.org&#39;/\u003e\n  \u003c/content\u003e\n  \u003cfrom jid=&#39;doctor@shakespeare.lit/pda&#39;/\u003e\n  \u003cto jid=&#39;ladymacbeth@shakespear.lit/castle&#39;/\u003e\n\u003c/envelope\u003e&#34;,
              &#34;-caption&#34;: &#34;Sender prepares a \u003ccontent/\u003e element containing the query subject.&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003ciq from=&#39;doctor@shakespeare.lit/pda&#39;\n    id=&#39;get-data-1&#39;\n    to=&#39;ladymacbeth@shakespeare.lit/castle&#39;\n    type=&#39;get&#39;\u003e\n  \u003cencrypted xmlns=&#39;urn:xmpp:encryption:stub:sce:1&#39;\u003e\n    \u003cpayload\u003e\n      V2FpdCwgd2hhdD8gQXJlIHlvdSBzZXJpb3VzPyBEaWQgeW91IHJlYWxseSBqdXN0IGdyYWIgeW91\n      ciBmYXZvdXJpdGUgYmFzZTY0IGRlY29kZXIganVzdCB0byBjaGVjayB0aGlzIGRvY3VtZW50IGZv\n      ciBoaWRkZW4gbWVzc2FnZXM/IFdoYXQgYXJlIHlvdSBzb21lIGtpbmQgb2YgbmVyZD8gU29tZSBn\n      ZWVrIHdpdGggYSBiaW5hcnkgd3Jpc3Qgd2F0Y2g/\n    \u003c/payload\u003e\n  \u003c/encrypted\u003e\n\u003c/iq\u003e&#34;,
              &#34;-caption&#34;: &#34;The sender then encrypts the \u003cenvelope/\u003e element for the recipient and sends the \u003ciq/\u003e containing the result of the encryption.&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003cenvelope xmlns=&#39;urn:xmpp:sce:1&#39;\u003e\n  \u003ccontent\u003e\n    \u003cdata xmlns=&#39;urn:xmpp:bob&#39;\n        cid=&#39;sha1&#43;8f35fef110ffc5df08d579a50083ff9308fb6242@bob.xmpp.org&#39;\n        max-age=&#39;86400&#39;\n        type=&#39;image/png&#39;\u003e\n    iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D&#43;PAAAAclBMVEUAAADYZArfaA9GIAoBAAGN\n    QA3MXgniaAiEOgZMIATDXRXZZhHUZBHIXhDrbQ6sUQ7OYA2TRAubRwqMQQq7VQlKHgMAAAK5WRfJ\n    YBOORBFoMBCwUQ/ycA6FPgvbZQpeKglNJQmrTQeOPgQyFwR6MwACAABRPE/oAAAAW0lEQVQI1xXI\n    Rw6EMBTAUP8kJKENnaF37n9FQPLCekAgzklhgCwfrlNHEXhrvCsxaU/SwLGAFuIWZFpBERtKm9Xf\n    JqH&#43;vVWh4POqgHrsAtht095b&#43;geYRSl57QHSPgP3&#43;CwvAAAAAABJRU5ErkJggg==\n    \u003c/data\u003e\n  \u003c/content\u003e\n  \u003cfrom jid=&#39;ladymacbeth@shakespear.lit/castle&#39;/\u003e\n  \u003cto jid=&#39;doctor@shakespeare.lit/pda&#39;/\u003e\n\u003c/envelope\u003e&#34;,
              &#34;-caption&#34;: &#34;The recipient prepares the reply to the request by assembling the \u003cenvelope/\u003e element.&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003ciq from=&#39;ladymacbeth@shakespeare.lit/castle&#39;\n    id=&#39;get-data-1&#39;\n    to=&#39;doctor@shakespeare.lit/pda&#39;\n    type=&#39;result&#39;\u003e\n  \u003cencrypted xmlns=&#39;urn:xmpp:encryption:stub:sce:1&#39;\u003e\n    \u003cpayload\u003e\n      PGNvbnRlbnQgeG1sbnM9J3Vybjp4bXBwOnNjZTowJz4KICA8cGF5bG9hZD4KICAgIDxkYXRhIHht\n      bG5zPSd1cm46eG1wcDpib2InCiAgICAgICAgY2lkPSdzaGExKzhmMzVmZWYxMTBmZmM1ZGYwOGQ1\n      NzlhNTAwODNmZjkzMDhmYjYyNDJAYm9iLnhtcHAub3JnJwogICAgICAgIG1heC1hZ2U9Jzg2NDAw\n      JwogICAgICAgIHR5cGU9J2ltYWdlL3BuZyc&#43;CiAgICBpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFB\n      QW9BQUFBS0NBTUFBQUM2N0QrUEFBQUFjbEJNVkVVQUFBRFlaQXJmYUE5R0lBb0JBQUdOCiAgICBR\n      QTNNWGduaWFBaUVPZ1pNSUFURFhSWFpaaEhVWkJISVhoRHJiUTZzVVE3T1lBMlRSQXViUndxTVFR\n      cTdWUWxLSGdNQUFBSzVXUmZKCiAgICBZQk9PUkJGb01CQ3dVUS95Y0E2RlBndmJaUXBlS2dsTkpR\n      bXJUUWVPUGdReUZ3UjZNd0FDQUFCUlBFL29BQUFBVzBsRVFWUUkxeFhJCiAgICBSdzZFTUJUQVVQ\n      OGtKS0VObmFGMzduOUZRUExDZWtBZ3prbGhnQ3dmcmxOSEVYaHJ2Q3N4YVUvU3dMR0FGdUlXWkZw\n      QkVSdEttOVhmCiAgICBKcUgrdlZXaDRQT3FnSHJzQXRodDA5NWIrZ2VZUlNsNTdRSFNQZ1AzK0N3\n      dkFBQUFBQUJKUlU1RXJrSmdnZz09CiAgICA8L2RhdGE&#43;CiAgPC9wYXlsb2FkPgogIDxmcm9tIGpp\n      ZD0nbGFkeW1hY2JldGhAc2hha2VzcGVhci5saXQvY2FzdGxlJy8&#43;CiAgPHRvIGppZD0nZG9jdG9y\n      QHNoYWtlc3BlYXJlLmxpdC9wZGEnLz4KPC9jb250ZW50Pgo=\n    \u003c/payload\u003e\n  \u003c/encrypted\u003e\n\u003c/iq\u003e&#34;,
              &#34;-caption&#34;: &#34;The \u003cenvelope/\u003e element is then encrypted and sent as a reply to the initiator of the request.&#34;
            }
          ],
          &#34;p&#34;: &#34;Stanza Content Encryption thrives not only to allow for rich content encryption in \u003cmessage/\u003e stanzas, but is also applicable to \u003ciq/\u003e queries. A resource might want to query sensitive information from another resource capable of Stanza Content Encryption.&#34;
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;sending&#34;,
      &#34;-topic&#34;: &#34;Sending an encrypted stanza&#34;,
      &#34;p&#34;: [
        &#34;In order to send an encrypted message without leaking extension elements, the sender prepares the message by placing the sensitive extension elements inside a \u003ccontent/\u003e element and that inside an \u003cenvelope/\u003e element.&#34;,
        &#34;Depending on the encryption-specific SCE-profile, some affix elements are added as child elements of the \u003cenvelope/\u003e element.&#34;,
        &#34;The \u003cenvelope/\u003e element is then serialized into XML and encrypted using the SCE-specific profile of the encryption mechanism in place. The result is appended to the message.&#34;,
        {
          &#34;#text&#34;: &#34;Since the outer message element does not contain a \u003cbody/\u003e element the sender appends an unencrypted \u003cstore/\u003e hint as specified in&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;XEP-0334: Message Processing Hints \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;Message Processing Hints (XEP-0334)&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;
            }
          }
        },
        &#34;The message can then be sent to the recipient.&#34;
      ]
    },
    {
      &#34;-anchor&#34;: &#34;receiving&#34;,
      &#34;-topic&#34;: &#34;Receiving an encrypted stanza&#34;,
      &#34;p&#34;: [
        &#34;The recipient of the message decrypts its encrypted payload. The result is the \u003cenvelope/\u003e element containing the \u003ccontent/\u003e element and the affix elements as direct child elements. Depending on the affix profiles specified by the used encryption protocol, the affix elements are verified to prevent certain attacks from taking place.&#34;,
        &#34;Afterwards, the extension elements inside the \u003ccontent/\u003e element are checked against the permitted list and any disallowed elements are discarded.&#34;,
        &#34;As a last step, the original unencrypted stanza is recreated by replacing the \u003cenvelope/\u003e element of the stanza with the elements inside of the \u003ccontent/\u003e element.&#34;
      ]
    },
    {
      &#34;-anchor&#34;: &#34;server-processed&#34;,
      &#34;-topic&#34;: &#34;Server-processed Elements&#34;,
      &#34;p&#34;: [
        &#34;There are certain extension elements which are required to be available to the server in order to do message routing and processing.\n     Additionally there are some elements that MUST be filtered by the server.\n     Allowing for those elements to be included in, and parsed from the encrypted payload would allow a malicious client to perform a number of attacks.&#34;,
        &#34;Contrary to this, other elements are considered sensitive and MUST NOT be available in plaintext outside the \u003cenvelope/\u003e element.&#34;,
        &#34;It is hard to come up with a complete list of exceptional elements at this point, as there is no practical implementation experience.&#34;,
        &#34;Below is a non-exhaustive list of elements that are definitely forbidden inside the \u003cenvelope/\u003e element and permitted as direct child elements of the message.&#34;
      ],
      &#34;table&#34;: {
        &#34;-caption&#34;: &#34;Examples for exceptional elements that MUST NOT be included in, or read from the \u003cenvelope/\u003e element and MUST instead be sent traditionally as direct child elements of the stanza.&#34;,
        &#34;tr&#34;: [
          {
            &#34;th&#34;: [
              &#34;Element&#34;,
              &#34;Reason&#34;
            ]
          },
          {
            &#34;td&#34;: [
              {
                &#34;#text&#34;: &#34;Elements of&#34;,
                &#34;note&#34;: {
                  &#34;#text&#34;: &#34;XEP-0334: Message Processing Hints \u003c&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;
                  }
                },
                &#34;span&#34;: {
                  &#34;-class&#34;: &#34;ref&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;Message Processing Hints (XEP-0334)&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;
                  }
                }
              },
              &#34;Message Processing Hints are addressed to the server and MUST therefore be accessible in plaintext. A receiving client MUST ignore any message processing hints encountered inside the encrypted \u003cenvelope/\u003e element&#34;
            ]
          },
          {
            &#34;td&#34;: [
              {
                &#34;#text&#34;: &#34;Stanza-ID elements of&#34;,
                &#34;note&#34;: {
                  &#34;#text&#34;: &#34;XEP-0359: Unique and Stable Stanza IDs \u003c&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0359.html&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0359.html&#34;
                  }
                },
                &#34;span&#34;: {
                  &#34;-class&#34;: &#34;ref&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;Unique and Stable Stanza IDs (XEP-0359)&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0359.html&#34;
                  }
                }
              },
              &#34;Sending clients MUST NOT include Stanza-ID elements inside the \u003cenvelope/\u003e element, as this would prevent the server from filtering it.\n          A client MUST ignore Stanza-ID elements encountered inside the \u003cenvelope/\u003e element&#34;
            ]
          },
          {
            &#34;td&#34;: [
              {
                &#34;#text&#34;: &#34;Elements of&#34;,
                &#34;note&#34;: {
                  &#34;#text&#34;: &#34;XEP-0033: Extended Stanza Addressing \u003c&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0033.html&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0033.html&#34;
                  }
                },
                &#34;span&#34;: {
                  &#34;-class&#34;: &#34;ref&#34;,
                  &#34;link&#34;: {
                    &#34;#text&#34;: &#34;Extended Stanza Addressing (XEP-0033)&#34;,
                    &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0033.html&#34;
                  }
                }
              },
              &#34;The server MUST be able to access the \u003caddresses/\u003e and \u003caddress/\u003e elements in order to do message routing, so they MUST NOT be encrypted.&#34;
            ]
          },
          {
            &#34;td&#34;: [
              &#34;TODO: Other elements?&#34;,
              &#34;&#34;
            ]
          }
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;rules&#34;,
      &#34;-topic&#34;: &#34;Business Rules&#34;,
      &#34;p&#34;: [
        &#34;Unencrypted \u003cenvelope/\u003e elements are NOT ALLOWED as child elements of the stanza and MUST be dropped.&#34;,
        &#34;Elements in the \u003ccontent/\u003e element MUST be identified using an element name and namespace.\n     Notably the \u003cbody/\u003e element MUST contain a valid namespace (i.e. \&#34;jabber:client\&#34;).&#34;,
        &#34;The recipient MUST verify that the decrypted \u003cenvelope/\u003e element contains valid XML before processing it any further. Invalid XML must be rejected.&#34;,
        &#34;After verifying the integrity of the \u003cenvelope/\u003e element, the recipient needs to make sure that no server-processed elements are found inside of it.\n     Any forbidden elements MUST be dropped before the message is processed any further.&#34;,
        &#34;Furthermore the receiving client MUST ignore any extension elements considered as sensitive which are found outside of the \u003cenvelope/\u003e element,\n     especially as direct unencrypted child elements of the enclosing stanza.&#34;,
        {
          &#34;#text&#34;: &#34;Since a chat message encrypted with SCE MUST NOT contain a \u003cbody/\u003e element, it is not eligible for MAM message storage (&#34;,
          &#34;note&#34;: [
            {
              &#34;#text&#34;: &#34;XEP-0313: Message Archive Management \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0313.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0313.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0334: Message Processing Hints \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;
              }
            }
          ],
          &#34;span&#34;: [
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Message Archive Management (XEP-0313)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0313.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Message Processing Hints (XEP-0334)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0334.html&#34;
              }
            }
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;impl&#34;,
      &#34;-topic&#34;: &#34;Implementation Notes&#34;,
      &#34;p&#34;: [
        &#34;As a first, naïve approach a recipient of a message containing an \u003cenvelope/\u003e element could simply reinject the reassambled unencrypted stanza into the XML stream.\n     This might introduce some security issues.\n     Most notably, depending on the clients implementation it may become ambiguous which elements were received end-to-end encrypted and which were received unencrypted.&#34;,
        &#34;Implementations should rather handle encrypted elements explicitly.&#34;
      ]
    },
    {
      &#34;-anchor&#34;: &#34;security&#34;,
      &#34;-topic&#34;: &#34;Security Considerations&#34;,
      &#34;p&#34;: &#34;For the sake of simplicity, the examples in this document are not encrypted. A real-world implementation MUST make use of real cryptographic protocols.&#34;,
      &#34;section2&#34;: {
        &#34;-anchor&#34;: &#34;security_profiles&#34;,
        &#34;-topic&#34;: &#34;Encryption Profiles&#34;,
        &#34;p&#34;: [
          &#34;This specification presents a set of affix elements which can be used to counter certain attacks. However it does not dictate any behaviour regarding what elements MUST be used/verified or when.&#34;,
          &#34;Different cryptographic protocols come with different possible attack scenarios which must be taken into consideration, so it is left up to those cryptographic protocols to define profiles that describe the use of affix elements.&#34;
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;registrar&#34;,
      &#34;-topic&#34;: &#34;XMPP Registrar Considerations&#34;,
      &#34;p&#34;: &#34;TODO: Maybe the Registrar should handle a list of elements that are forbidden as child elements of the \u003ccontent/\u003e element?&#34;
    },
    {
      &#34;-anchor&#34;: &#34;schema&#34;,
      &#34;-topic&#34;: &#34;XML Schema&#34;,
      &#34;p&#34;: &#34;TODO.&#34;
    },
    {
      &#34;-anchor&#34;: &#34;acknowledgements&#34;,
      &#34;-topic&#34;: &#34;Acknowledgements&#34;,
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;Big thanks to the authors of&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;XEP-0373: OpenPGP for XMPP \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;OpenPGP for XMPP (XEP-0373)&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0373.html&#34;
            }
          }
        },
        &#34;Also thanks to Marvin Wißfeld, Tim Henkes, Daniel Gultsch, Melvin Keskin and Andreas Straub for their feedback.&#34;
      ]
    }
  ]
}</pre></a></td><td>planned</td><tr><tr><td><a href=https://xmpp.org/extensions/xep-0158.html>xep-0158:<pre>{
  &#34;-xmlns&#34;: &#34;&#34;,
  &#34;header&#34;: {
    &#34;abstract&#34;: &#34;This document specifies an XMPP protocol extension that entities may use to discover whether the sender of an XML stanza is a human user or a robot.&#34;,
    &#34;approver&#34;: &#34;Council&#34;,
    &#34;author&#34;: [
      {
        &#34;email&#34;: &#34;ian.paterson@clientside.co.uk&#34;,
        &#34;firstname&#34;: &#34;Ian&#34;,
        &#34;jid&#34;: &#34;ian@zoofy.com&#34;,
        &#34;surname&#34;: &#34;Paterson&#34;
      },
      {
        &#34;email&#34;: &#34;stpeter@stpeter.im&#34;,
        &#34;firstname&#34;: &#34;Peter&#34;,
        &#34;jid&#34;: &#34;stpeter@jabber.org&#34;,
        &#34;surname&#34;: &#34;Saint-Andre&#34;,
        &#34;uri&#34;: &#34;https://stpeter.im/&#34;
      }
    ],
    &#34;dependencies&#34;: {
      &#34;spec&#34;: [
        &#34;XMPP Core&#34;,
        &#34;XMPP IM&#34;,
        &#34;XEP-0004&#34;,
        &#34;XEP-0066&#34;,
        &#34;XEP-0221&#34;
      ]
    },
    &#34;legal&#34;: {
      &#34;conformance&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol has been contributed in full conformance with the XSF&#39;s Intellectual Property Rights Policy (a copy of which can be found at \u003c&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/about/xsf/ipr-policy&#34;
        }
      },
      &#34;copyright&#34;: {
        &#34;#text&#34;: &#34;This XMPP Extension Protocol is copyright © 1999 – 2024 by the&#34;,
        &#34;link&#34;: {
          &#34;#text&#34;: &#34;XMPP Standards Foundation&#34;,
          &#34;-url&#34;: &#34;https://xmpp.org/&#34;
        }
      },
      &#34;liability&#34;: &#34;In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.&#34;,
      &#34;permissions&#34;: &#34;Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the \&#34;Specification\&#34;), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.&#34;,
      &#34;warranty&#34;: &#34;## NOTE WELL: This Specification is provided on an \&#34;AS IS\&#34; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##&#34;
    },
    &#34;number&#34;: &#34;0158&#34;,
    &#34;revision&#34;: [
      {
        &#34;date&#34;: &#34;2019-11-07&#34;,
        &#34;initials&#34;: &#34;egp, mb&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Use the correct FORM_TYPE for extended IBR, and use a proper MUC join as an example. Also fix typos.&#34;
        },
        &#34;version&#34;: &#34;1.0.1&#34;
      },
      {
        &#34;date&#34;: &#34;2008-09-03&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Per a vote of the XMPP Council, advanced status to Draft; concurrently, the XMPP Registrar issued the urn:xmpp:captcha namespace; also changed element name from challenge to captcha in order to match the namespace name.&#34;
        },
        &#34;version&#34;: &#34;1.0&#34;
      },
      {
        &#34;date&#34;: &#34;2008-08-06&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Further modified examples to track changes to XEP-0231.&#34;
        },
        &#34;version&#34;: &#34;0.11&#34;
      },
      {
        &#34;date&#34;: &#34;2008-08-06&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Modified examples to track changes to XEP-0231; to avoid confusion with cid URIs, changed name of challenge ID form field from cid to challenge.&#34;
        },
        &#34;version&#34;: &#34;0.10&#34;
      },
      {
        &#34;date&#34;: &#34;2008-05-12&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Specified that cid field is required; more clearly defined structure of challenge stanza; added several security considerations; corrected several errors in the text and examples.&#34;
        },
        &#34;version&#34;: &#34;0.9&#34;
      },
      {
        &#34;date&#34;: &#34;2008-05-12&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Moved text regarding labels to new internationalization considerations section; removed necessity that ID of IQ-set shall match ID of challenge, since this is not consistent with existing usage that IDs are generated by the sender of an IQ.&#34;
        },
        &#34;version&#34;: &#34;0.8&#34;
      },
      {
        &#34;date&#34;: &#34;2008-04-28&#34;,
        &#34;initials&#34;: &#34;psa&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Generalized text to cover abuse rather than just spim; modified temporary namespace to adhere to XMPP Registrar procedures; added use case for joining multi-user chat rooms.&#34;
        },
        &#34;version&#34;: &#34;0.7&#34;
      },
      {
        &#34;date&#34;: &#34;2007-07-11&#34;,
        &#34;initials&#34;: &#34;psa/ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Moved media element definition to XEP-0221; consistently used the terms sender and challenger rather than client and entity; modified provisional namespaces to adhere to XMPP Registrar policies; completed editorial review.&#34;
        },
        &#34;version&#34;: &#34;0.6&#34;
      },
      {
        &#34;date&#34;: &#34;2006-10-30&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Added reference to SPIM Reporting.&#34;
        },
        &#34;version&#34;: &#34;0.5&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-30&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Required WAV instead of MP3 for audio CAPTCHAs; minor corrections.&#34;
        },
        &#34;version&#34;: &#34;0.4&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-28&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Added more CAPTCHA types and the legacy question and answer section.&#34;
        },
        &#34;version&#34;: &#34;0.3&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-14&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Minor fixes.&#34;
        },
        &#34;version&#34;: &#34;0.2&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-14&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;Initial version.&#34;
        },
        &#34;version&#34;: &#34;0.1&#34;
      },
      {
        &#34;date&#34;: &#34;2005-09-07&#34;,
        &#34;initials&#34;: &#34;ip&#34;,
        &#34;remark&#34;: {
          &#34;p&#34;: &#34;First draft.&#34;
        },
        &#34;version&#34;: &#34;0.0.1&#34;
      }
    ],
    &#34;schemaloc&#34;: {
      &#34;url&#34;: &#34;http://xmpp.org/schemas/captcha.xsd&#34;
    },
    &#34;shortname&#34;: &#34;captcha&#34;,
    &#34;sig&#34;: &#34;Standards&#34;,
    &#34;status&#34;: &#34;Draft&#34;,
    &#34;supersededby&#34;: &#34;&#34;,
    &#34;supersedes&#34;: &#34;&#34;,
    &#34;title&#34;: &#34;CAPTCHA Forms&#34;,
    &#34;type&#34;: &#34;Standards Track&#34;
  },
  &#34;section1&#34;: [
    {
      &#34;-anchor&#34;: &#34;intro&#34;,
      &#34;-topic&#34;: &#34;Introduction&#34;,
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;The appearance of large public IM services based on&#34;,
          &#34;em&#34;: &#34;discourage&#34;,
          &#34;note&#34;: [
            {
              &#34;#text&#34;: &#34;RFC 6120: Extensible Messaging and Presence Protocol (XMPP): Core \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;RFC 6121: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;
              }
            }
          ],
          &#34;span&#34;: [
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;XMPP Core&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6120&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;XMPP IM&#34;,
                &#34;-url&#34;: &#34;http://tools.ietf.org/html/rfc6121&#34;
              }
            }
          ]
        },
        {
          &#34;#text&#34;: &#34;One technique developed to combat abusive messages and behavior via non-XMPP technologies requires humans to be differentiated from bots using a \&#34;Completely Automated Public Turing Test to Tell Computers and Humans Apart\&#34; or CAPTCHA (see \u003c&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;http://www.captcha.net/&#34;,
            &#34;-url&#34;: &#34;http://www.captcha.net/&#34;
          }
        },
        {
          &#34;#text&#34;: &#34;An alternative technique to CAPTCHAs requires Desktop PC clients to undertake a&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;Hashcash \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;http://hashcash.org/&#34;,
              &#34;-url&#34;: &#34;http://hashcash.org/&#34;
            }
          },
          &#34;span&#34;: {
            &#34;#text&#34;: &#34;Hashcash&#34;,
            &#34;-class&#34;: &#34;ref&#34;
          }
        },
        &#34;Both CAPTCHAs and hashcash have been criticized regarding their effectiveness (or lack thereof). Therefore, the challenge protocol specified herein provides a great deal of flexibility, so that challenges can include CAPTCHAs, hashcash, word puzzles, so-called kitten authentication, and any other mechanism that may be developed in the future.&#34;,
        {
          &#34;#text&#34;: &#34;The generic challenge protocol described in this document is designed for incorporation into protocols such as&#34;,
          &#34;note&#34;: [
            {
              &#34;#text&#34;: &#34;XEP-0077: In-Band Registration \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0077.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0077.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0045: Multi-User Chat \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0045.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0045.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0016: Privacy Lists \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0016.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0016.html&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;XEP-0159: SPIM-Blocking Control \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0159.html&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0159.html&#34;
              }
            }
          ],
          &#34;span&#34;: [
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;In-Band Registration (XEP-0077)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0077.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Multi-User Chat (XEP-0045)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0045.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Privacy Lists (XEP-0016)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0016.html&#34;
              }
            },
            {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;SPIM-Blocking Control (XEP-0159)&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0159.html&#34;
              }
            }
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;require&#34;,
      &#34;-topic&#34;: &#34;Requirements&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;require-extend&#34;,
          &#34;-topic&#34;: &#34;Extensibility&#34;,
          &#34;p&#34;: &#34;The CAPTCHAs in most common use today are Optical Character Recognition (OCR) challenges where an image containing deformed text is presented and the human enters the characters they can read. However, if OCR software advances more rapidly than the techniques used to disguise text from Artificial Intelligence (AI) then very different CAPTCHAs will need to be deployed. This protocol must be extensible enough to allow the incorporation of CAPTCHA techniques that may not have been envisaged.&#34;
        },
        {
          &#34;-anchor&#34;: &#34;require-variety&#34;,
          &#34;-topic&#34;: &#34;Variety&#34;,
          &#34;p&#34;: {
            &#34;#text&#34;: &#34;Several common CAPTCHA techniques present major problems to users with disabilities (see&#34;,
            &#34;note&#34;: {
              &#34;#text&#34;: &#34;Inaccessibility of Visually-Oriented Anti-Robot Tests \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;http://www.w3.org/TR/turingtest/&#34;,
                &#34;-url&#34;: &#34;http://www.w3.org/TR/turingtest/&#34;
              }
            },
            &#34;span&#34;: {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Inaccessibility of Visually-Oriented Anti-Robot Tests&#34;,
                &#34;-url&#34;: &#34;http://www.w3.org/TR/turingtest/&#34;
              }
            }
          }
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;protocol&#34;,
      &#34;-topic&#34;: &#34;Protocol&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;protocol-simple&#34;,
          &#34;-topic&#34;: &#34;Simple Challenge&#34;,
          &#34;section3&#34;: [
            {
              &#34;-anchor&#34;: &#34;protocol-trigger&#34;,
              &#34;-topic&#34;: &#34;Triggering Stanza&#34;,
              &#34;example&#34;: {
                &#34;#text&#34;: &#34;\u003cmessage from=&#39;robot@abuser.com/zombie&#39;\n    to=&#39;innocent@victim.com&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;spam1&#39;\u003e\n  \u003cbody\u003eLove pills - 75% OFF\u003c/body\u003e\n  \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n    \u003curl\u003ehttp://www.abuser.com/lovepills.html\u003c/url\u003e\n  \u003c/x\u003e\n\u003c/message\u003e&#34;,
                &#34;-caption&#34;: &#34;Sender Generates Triggering Stanza&#34;
              },
              &#34;p&#34;: &#34;A \&#34;triggering stanza\&#34; is an XMPP \u003cmessage/\u003e, \u003cpresence/\u003e, or \u003ciq/\u003e stanza that is deemed abusive by the receiving entity (e.g., a client) or an intermediate router (e.g., a server). The entity that generates a triggering stanza is called a \&#34;sender\&#34;.&#34;
            },
            {
              &#34;-anchor&#34;: &#34;protocol-challenge&#34;,
              &#34;-topic&#34;: &#34;Challenge Stanza&#34;,
              &#34;example&#34;: {
                &#34;#text&#34;: &#34;\u003cmessage from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;F3A6292C&#39;\u003e\n  \u003cbody\u003e\n    Your messages to innocent@victim.com are being blocked. To unblock\n    them, visit http://www.victim.com/challenge.html?F3A6292C\n  \u003c/body\u003e\n  \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n    \u003curl\u003ehttp://www.victim.com/challenge.html?F3A6292C\u003c/url\u003e\n  \u003c/x\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;sid&#39;\u003e\u003cvalue\u003espam1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39; label=&#39;Enter the text you see&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;80&#39;\n               width=&#39;290&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/ocr.jpeg?F3A6292C\n          \u003c/uri\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            cid:sha1&#43;f24030b8d91d233bac14777be5ab531ca3b9f102@bob.xmpp.org\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;picture_recog&#39; label=&#39;Identify the picture&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;150&#39;\n               width=&#39;150&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/picture.jpeg?F3A6292C\n          \u003c/uri\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            cid:sha1&#43;f2377f3a3287eac81028243079e1aa9905c466bc@bob.xmpp.org\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;speech_recog&#39; label=&#39;Enter the words you hear&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\u003e\n          \u003curi type=&#39;audio/x-wav&#39;\u003e\n            http://www.victim.com/challenges/speech.wav?F3A6292C\n          \u003c/uri\u003e\n          \u003curi type=&#39;audio/ogg-speex&#39;\u003e\n            http://www.victim.com/challenges/speech.ogg?F3A6292C\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;video_recog&#39; label=&#39;Identity the video&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;150&#39;\n               width=&#39;150&#39;\u003e\n          \u003curi type=&#39;video/mpeg&#39;\u003e\n            http://www.victim.com/challenges/video.mpeg?F3A6292C\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;Type the color of a stop light&#39; type=&#39;text-single&#39; var=&#39;qa&#39;/\u003e\n      \u003cfield label=&#39;93C7A&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/message\u003e&#34;,
                &#34;-caption&#34;: &#34;Challenger Offers a Choice of Challenges to Sender&#34;
              },
              &#34;ol&#34;: {
                &#34;li&#34;: [
                  &#34;The challenge stanza MUST include an &#39;id&#39; attribute set to the challenge ID (i.e., a unique identifier for this challenge within the challenger&#39;s application).&#34;,
                  &#34;The challenge stanza SHOULD include a \u003cbody/\u003e element that provides an explanation of the challenge for clients that do not yet support CAPTCHA forms.&#34;,
                  {
                    &#34;#text&#34;: &#34;The challenge stanza MAY include a URL (typically a Web page with instructions) using&#34;,
                    &#34;note&#34;: {
                      &#34;#text&#34;: &#34;XEP-0066: Out of Band Data \u003c&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;
                      }
                    },
                    &#34;span&#34;: {
                      &#34;-class&#34;: &#34;ref&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Out-of-Band Data (XEP-0066)&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0066.html&#34;
                      }
                    }
                  },
                  &#34;The &#39;xml:lang&#39; attribute of the challenge stanza SHOULD be the same as the one received from the sender, if any.&#34;,
                  {
                    &#34;#text&#34;: &#34;The challenge stanza MUST include a CAPTCHA form, i.e., a data form of type \&#34;form\&#34; containing one or more challenges.&#34;,
                    &#34;note&#34;: &#34;Inclusion of a CAPTCHA form not only makes it possible to flexibly support or require a large number of challenge types, but also enables constrained clients to respond to challenges (e.g., mobile phone clients that cannot present web pages, or clients on XMPP-only networks).&#34;
                  },
                  {
                    &#34;#text&#34;: &#34;The CAPTCHA form MUST include a hidden field named \&#34;FORM_TYPE\&#34; (in accordance with&#34;,
                    &#34;note&#34;: {
                      &#34;#text&#34;: &#34;XEP-0068: Field Data Standardization for Data Forms \u003c&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0068.html&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0068.html&#34;
                      }
                    },
                    &#34;span&#34;: {
                      &#34;-class&#34;: &#34;ref&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Field Standardization for Data Forms (XEP-0068)&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0068.html&#34;
                      }
                    }
                  },
                  &#34;The CAPTCHA form MUST include a hidden field named \&#34;challenge\&#34; set to the challenge ID.&#34;,
                  &#34;The CAPTCHA form MUST include a hidden field named \&#34;from\&#34; set to the value of the &#39;to&#39; attribute from the triggering stanza.&#34;,
                  &#34;If the triggering stanza included an &#39;id&#39; attribute, then the CAPTCHA form MUST include a hidden field named \&#34;sid\&#34; set to that value.&#34;,
                  &#34;Each of the CAPTCHA form&#39;s non-hidden \u003cfield/\u003e elements MAY contain a different challenge.&#34;,
                  {
                    &#34;#text&#34;: &#34;Each CAPTCHA field MAY contain a media element (see&#34;,
                    &#34;note&#34;: {
                      &#34;#text&#34;: &#34;XEP-0221: Data Forms Media Element \u003c&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0221.html&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0221.html&#34;
                      }
                    },
                    &#34;span&#34;: {
                      &#34;-class&#34;: &#34;ref&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Data Forms Media Element (XEP-0221)&#34;,
                        &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0221.html&#34;
                      }
                    }
                  }
                ]
              },
              &#34;p&#34;: [
                &#34;Upon receiving a triggering stanza, an entity MAY send a \&#34;challenge stanza\&#34;. An entity MUST NOT send a challenge stanza under any other circumstances. The entity that generates the challenge stanza is called the \&#34;challenger\&#34;.&#34;,
                {
                  &#34;#text&#34;: &#34;The challenge stanza consists of an XMPP \u003cmessage/\u003e stanza containing a data form for the sender to fill out, formatted according to&#34;,
                  &#34;note&#34;: {
                    &#34;#text&#34;: &#34;XEP-0004: Data Forms \u003c&#34;,
                    &#34;link&#34;: {
                      &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0004.html&#34;,
                      &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0004.html&#34;
                    }
                  },
                  &#34;span&#34;: {
                    &#34;-class&#34;: &#34;ref&#34;,
                    &#34;link&#34;: {
                      &#34;#text&#34;: &#34;Data Forms (XEP-0004)&#34;,
                      &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0004.html&#34;
                    }
                  }
                },
                {
                  &#34;#text&#34;: &#34;The sender then would retrieve the media data via HTTP or (for the cid: URIs) via XMPP as described in&#34;,
                  &#34;note&#34;: {
                    &#34;#text&#34;: &#34;XEP-0231: Bits of Binary \u003c&#34;,
                    &#34;link&#34;: {
                      &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0231.html&#34;,
                      &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0231.html&#34;
                    }
                  },
                  &#34;span&#34;: {
                    &#34;-class&#34;: &#34;ref&#34;,
                    &#34;link&#34;: {
                      &#34;#text&#34;: &#34;Bits of Binary (XEP-0231)&#34;,
                      &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0231.html&#34;
                    }
                  }
                }
              ]
            },
            {
              &#34;-anchor&#34;: &#34;protocol-response&#34;,
              &#34;-topic&#34;: &#34;Response Stanza&#34;,
              &#34;example&#34;: [
                {
                  &#34;#text&#34;: &#34;\u003cmessage type=&#39;error&#39;\n    from=&#39;robot@abuser.com/zombie&#39;\n    to=&#39;victim.com&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;F3A6292C&#39;\u003e\n  \u003cerror type=&#39;modify&#39;\u003e\n    \u003cnot-acceptable xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;/\u003e\n  \u003c/error\u003e\n\u003c/message\u003e&#34;,
                  &#34;-caption&#34;: &#34;Sender Reports Challenge Not Acceptable&#34;
                },
                {
                  &#34;#text&#34;: &#34;\u003ciq type=&#39;set&#39;\n    from=&#39;robot@abuser.com/zombie&#39;\n    to=&#39;victim.com&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;z140r0s&#39;\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;submit&#39;\u003e\n      \u003cfield var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;sid&#39;\u003e\u003cvalue\u003espam1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39;\u003e\u003cvalue\u003e7nHL3\u003c/value\u003e\u003c/field\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/iq\u003e&#34;,
                  &#34;-caption&#34;: &#34;Sender Sends One Response to Challenger&#34;
                }
              ],
              &#34;p&#34;: [
                &#34;The sender&#39;s client SHOULD ignore the challenge stanza in either of the following cases:&#34;,
                {
                  &#34;#text&#34;: &#34;Otherwise, if the challenger provided a URL using&#34;,
                  &#34;cite&#34;: &#34;Out-of-Band Data&#34;
                },
                &#34;Otherwise, the sender&#39;s client MUST respond to the challenge.&#34;,
                &#34;The sender&#39;s client MUST respond with a \u003cnot-acceptable/\u003e error in any of the following cases:&#34;,
                &#34;Otherwise, it MUST select one challenge according to the sender&#39;s preferences and submit the sender&#39;s response form to the challenger.&#34;
              ],
              &#34;ul&#34;: [
                {
                  &#34;li&#34;: [
                    {
                      &#34;#text&#34;: &#34;If it has not recently sent (e.g., in the last two minutes) a stanza to the JID specified in the &#39;from&#39; field of the form with the &#39;id&#39; specified in the &#39;sid&#39; field (or with no &#39;id&#39; if no &#39;sid&#39; field is included).&#34;,
                      &#34;note&#34;: &#34;Otherwise the user&#39;s presence would be disclosed, or a robot might dupe the user into providing answers to other people&#39;s challenges!&#34;
                    },
                    &#34;If the &#39;from&#39; attribute of the challenge stanza does not match the &#39;from&#39; field of the form. (If the values are different, then they still match if the bare JIDs are the same, or if the &#39;from&#39; attribute is the domain of the other JID.)&#34;
                  ]
                },
                {
                  &#34;li&#34;: [
                    &#34;if it does not understand the CAPTCHA form&#34;,
                    {
                      &#34;#text&#34;: &#34;if it does not support all of the&#34;,
                      &#34;em&#34;: &#34;required&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Multiple Challenges&#34;,
                        &#34;-url&#34;: &#34;#protocol-multiple&#34;
                      }
                    },
                    {
                      &#34;#text&#34;: &#34;if it does not support enough of the challenges (see&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Multiple Challenges&#34;,
                        &#34;-url&#34;: &#34;#protocol-multiple&#34;
                      }
                    }
                  ]
                },
                {
                  &#34;li&#34;: [
                    {
                      &#34;#text&#34;: &#34;if it does not support all of the required challenges (see&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Multiple Challenges&#34;,
                        &#34;-url&#34;: &#34;#protocol-multiple&#34;
                      }
                    },
                    {
                      &#34;#text&#34;: &#34;if it does not support enough of the challenges (see&#34;,
                      &#34;link&#34;: {
                        &#34;#text&#34;: &#34;Multiple Challenges&#34;,
                        &#34;-url&#34;: &#34;#protocol-multiple&#34;
                      }
                    },
                    &#34;if the sender declines the challenge&#34;
                  ]
                }
              ]
            },
            {
              &#34;-anchor&#34;: &#34;protocol-result&#34;,
              &#34;-topic&#34;: &#34;Result Stanza&#34;,
              &#34;example&#34;: [
                {
                  &#34;#text&#34;: &#34;\u003ciq type=&#39;error&#39;\n    from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    id=&#39;z140r0s&#39;\u003e\n  \u003cerror type=&#39;cancel&#39;\u003e\n    \u003cservice-unavailable xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;/\u003e\n  \u003c/error\u003e\n\u003c/iq\u003e&#34;,
                  &#34;-caption&#34;: &#34;Challenger Indicates Challenge Not Found&#34;
                },
                {
                  &#34;#text&#34;: &#34;\u003ciq type=&#39;result&#39;\n    from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    id=&#39;z140r0s&#39;/\u003e&#34;,
                  &#34;-caption&#34;: &#34;Challenger Tells Sender it Passed&#34;
                },
                {
                  &#34;#text&#34;: &#34;\u003ciq type=&#39;error&#39;\n    from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    id=&#39;z140r0s&#39;\u003e\n  \u003cerror type=&#39;cancel&#39;\u003e\n    \u003cnot-acceptable xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;/\u003e\n  \u003c/error\u003e\n\u003c/iq\u003e&#34;,
                  &#34;-caption&#34;: &#34;Challenger Tells Sender it Failed&#34;
                }
              ],
              &#34;p&#34;: [
                &#34;The challenger SHOULD send a \u003cservice-unavailable/\u003e error to the sender if:&#34;,
                &#34;Note: This error MAY be sent even in cases where the challenge became unnecessary while the challenger was waiting for the response.&#34;,
                &#34;After receiving a correct response to its challenge, the challenger SHOULD inform the sender that it was successful.&#34;,
                {
                  &#34;#text&#34;: &#34;However, if the sender submits an incorrect response the challenger SHOULD send it a \u003cnot-acceptable/\u003e error with type \&#34;cancel\&#34;:&#34;,
                  &#34;note&#34;: {
                    &#34;#text&#34;: &#34;If a large proportion of the responses a server is receiving from another IP are incorrect then it SHOULD inform the administrator of the other server using the protocol specified in&#34;,
                    &#34;note&#34;: [
                      {
                        &#34;#text&#34;: &#34;XEP-0161: Abuse Reporting \u003c&#34;,
                        &#34;link&#34;: {
                          &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0161.html&#34;,
                          &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0161.html&#34;
                        }
                      },
                      {
                        &#34;#text&#34;: &#34;XEP-0236: Abuse Reporting \u003c&#34;,
                        &#34;link&#34;: {
                          &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0236.html&#34;,
                          &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0236.html&#34;
                        }
                      }
                    ],
                    &#34;span&#34;: [
                      {
                        &#34;-class&#34;: &#34;ref&#34;,
                        &#34;link&#34;: {
                          &#34;#text&#34;: &#34;Abuse Reporting (XEP-0161)&#34;,
                          &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0161.html&#34;
                        }
                      },
                      {
                        &#34;-class&#34;: &#34;ref&#34;,
                        &#34;link&#34;: {
                          &#34;#text&#34;: &#34;Abuse Reporting (XEP-0236)&#34;,
                          &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0236.html&#34;
                        }
                      }
                    ]
                  }
                }
              ],
              &#34;ul&#34;: {
                &#34;li&#34;: [
                  {
                    &#34;#text&#34;: &#34;The challenger did not send the specified challenge.&#34;,
                    &#34;note&#34;: &#34;If the challenger is a client then it SHOULD be careful not to leak information about the presence of the sender and reply to potentially bogus challenge responses with exactly the same XML that its server would send if the sender were offline.&#34;
                  },
                  &#34;The sender already submitted its response to this challenge.&#34;,
                  &#34;The sender took too long to submit its response.&#34;
                ]
              }
            }
          ]
        },
        {
          &#34;-anchor&#34;: &#34;protocol-multiple&#34;,
          &#34;-topic&#34;: &#34;Multiple Challenges&#34;,
          &#34;example&#34;: [
            {
              &#34;#text&#34;: &#34;\u003cmessage from=&#39;victim.com&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;73DE28A2&#39;\u003e\n  \u003cbody\u003eYour messages to innocent@victim.com are being blocked.\n    To unblock them, ask innocent@victim.com to send you a message.\u003c/body\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003e73DE28A2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;sid&#39;\u003e\u003cvalue\u003espam2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;answers&#39;\u003e\u003cvalue\u003e2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39; label=&#39;Enter the text you see&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;80&#39;\n               width=&#39;290&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/ocr.jpeg?F3A6292C\n          \u003c/uri\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            cid:sha1&#43;f24030b8d91d233bac14777be5ab531ca3b9f102@bob.xmpp.org\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;audio_recog&#39; label=&#39;Describe the sound you hear&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\u003e\n          \u003curi type=&#39;audio/x-wav&#39;\u003e\n            http://www.victim.com/challenges/audio.wav?F3A6292C\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;Type the color of a stop light&#39; type=&#39;text-single&#39; var=&#39;qa&#39;\u003e\n        \u003crequired/\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;e03d7&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/message\u003e&#34;,
              &#34;-caption&#34;: &#34;Challenger Sets Multiple Challenges&#34;
            },
            {
              &#34;#text&#34;: &#34;\u003ciq type=&#39;set&#39;\n    from=&#39;robot@abuser.com/zombie&#39;\n    to=&#39;victim.com&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;73DE28A2&#39;\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;submit&#39;\u003e\n      \u003cfield var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;challenge&#39;\u003e\u003cvalue\u003e73DE28A2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;sid&#39;\u003e\u003cvalue\u003espam2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;answers&#39;\u003e\u003cvalue\u003e2\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;qa&#39;\u003e\u003cvalue\u003ered\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;SHA-256&#39;\u003e\u003cvalue\u003einnocent@victim.com2450F06C173B05E3\u003c/value\u003e\u003c/field\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/iq\u003e&#34;,
              &#34;-caption&#34;: &#34;Sender Sends Multiple Responses to the Challenger&#34;
            }
          ],
          &#34;p&#34;: [
            &#34;The challenger MAY demand responses to more than one of the challenges it is offering; this is done by including an &#39;answers&#39; \u003cfield/\u003e element in the form, which specifies how many answers the sender needs to include. The challenger also MAY require responses to particular challenges; this is done by including a \u003crequired/\u003e element in the compulsory fields.&#34;,
            {
              &#34;#text&#34;: &#34;If the sender finds the request acceptable, it MUST answer all challenges that include a \u003crequired/\u003e element. If the total number of answers was specified and it is greater than the number of \u003crequired/\u003e elements then the sender MUST also answer one or more of the challenges without a \u003crequired/\u003e element. In the example above, the sender should respond to the &#39;qa&#39; challenge&#34;,
              &#34;em&#34;: &#34;and&#34;
            },
            &#34;The challenger MAY decide the sender has passed a challenge even if the responses are not all perfectly correct.&#34;
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;register&#34;,
      &#34;-topic&#34;: &#34;Extended In-Band Registration&#34;,
      &#34;example&#34;: [
        {
          &#34;#text&#34;: &#34;\u003ciq type=&#39;get&#39; xml:lang=&#39;en&#39; id=&#39;reg1&#39;\u003e\n  \u003cquery xmlns=&#39;jabber:iq:register&#39;/\u003e\n\u003c/iq\u003e&#34;,
          &#34;-caption&#34;: &#34;Entity Requests Registration Fields from Host&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003ciq type=&#39;result&#39; xml:lang=&#39;en&#39; id=&#39;reg1&#39;\u003e\n  \u003cquery xmlns=&#39;jabber:iq:register&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003ejabber:iq:register\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;sid&#39;\u003e\u003cvalue\u003ereg1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;answers&#39;\u003e\u003cvalue\u003e3\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39; label=&#39;Enter the text you see&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;80&#39;\n               width=&#39;290&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/ocr.jpeg?F3A6292C\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;93C7A&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n      \u003cfield type=&#39;text-single&#39; var=&#39;username&#39;\u003e\n        \u003crequired/\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;text-private&#39; var=&#39;password&#39;\u003e\n        \u003crequired/\u003e\n      \u003c/field\u003e\n    \u003c/x\u003e\n    \u003cinstructions\u003e\n      To register, visit http://www.victim.com/register.html\n    \u003c/instructions\u003e\n    \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n      \u003curl\u003ehttp://www.victim.com/register.html\u003c/url\u003e\n    \u003c/x\u003e\n  \u003c/query\u003e\n\u003c/iq\u003e&#34;,
          &#34;-caption&#34;: &#34;Host Returns Registration and Challenge Fields to Entity&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003ciq type=&#39;set&#39; xml:lang=&#39;en&#39; id=&#39;reg2&#39;\u003e\n  \u003cquery xmlns=&#39;jabber:iq:register&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;submit&#39;\u003e\n      \u003cfield var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003ejabber:iq:register\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;sid&#39;\u003e\u003cvalue\u003ereg1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;answers&#39;\u003e\u003cvalue\u003e3\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39;\u003e\u003cvalue\u003e7nHL3\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;username&#39;\u003e\u003cvalue\u003ebill\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;password&#39;\u003e\u003cvalue\u003eCalliope\u003c/value\u003e\u003c/field\u003e\n    \u003c/x\u003e\n  \u003c/query\u003e\n\u003c/iq\u003e&#34;,
          &#34;-caption&#34;: &#34;Entity Provides Required Information In-Band&#34;
        }
      ],
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;This section shows how challenges SHOULD be combined with the existing In-Band Registration protocol according to the rules defined in the Extensibility section of&#34;,
          &#34;cite&#34;: &#34;XEP-0077&#34;
        },
        {
          &#34;#text&#34;: &#34;Note: The \u003cchallenge/\u003e wrapper element is not included, because&#34;,
          &#34;cite&#34;: &#34;XEP-0077&#34;
        },
        &#34;Note that the CAPTCHA form MUST be inside the \u003cquery/\u003e element, and the server&#39;s challenge ID is specified within the form:&#34;,
        {
          &#34;#text&#34;: &#34;The server MAY include an \u003cinstructions/\u003e element and a URL using&#34;,
          &#34;cite&#34;: [
            &#34;Out-of-Band Data&#34;,
            &#34;In-Band Registration&#34;
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;muc&#34;,
      &#34;-topic&#34;: &#34;Multi-User Chat&#34;,
      &#34;example&#34;: [
        {
          &#34;#text&#34;: &#34;\u003cpresence from=&#39;robot@abuser.com/zombie&#39;\n          to=&#39;friendly-chat@muc.victim.com/robot101&#39;\u003e\n  \u003cx xmlns=&#39;http://jabber.org/protocol/muc&#39;/\u003e\n\u003c/presence\u003e&#34;,
          &#34;-caption&#34;: &#34;Sender Attempts to Join Chat Room&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;friendly-chat@muc.victim.com&#39;\n         to=&#39;robot@abuser.com/zombie&#39;\n         id=&#39;A4C7303D&#39;\u003e\n  \u003cbody\u003e\n    Your messages to friendly-chat@muc.victim.com are being blocked. To unblock\n    them, visit http://www.victim.com/challenge.html?A4C7303D\n  \u003c/body\u003e\n  \u003cx xmlns=&#39;jabber:x:oob&#39;\u003e\n    \u003curl\u003ehttp://www.victim.com/challenge.html?A4C7303D\u003c/url\u003e\n  \u003c/x\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;from&#39;\u003e\u003cvalue\u003efriendly-chat@muc.victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003eA4C7303D\u003c/value\u003e\u003c/field\u003e\n      \u003cfield var=&#39;ocr&#39; label=&#39;Enter the text you see&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;80&#39;\n               width=&#39;290&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/ocr.jpeg?A4C7303D\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;picture_recog&#39; label=&#39;Identify the picture&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;150&#39;\n               width=&#39;150&#39;\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            http://www.victim.com/challenges/picture.jpeg?A4C7303D\n          \u003c/uri\u003e\n          \u003curi type=&#39;image/jpeg&#39;\u003e\n            cid:sha1&#43;f2377f3a3287eac81028243079e1aa9905c466bc@bob.xmpp.org\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;speech_recog&#39; label=&#39;Enter the words you hear&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\u003e\n          \u003curi type=&#39;audio/x-wav&#39;\u003e\n            http://www.victim.com/challenges/speech.wav?A4C7303D\n          \u003c/uri\u003e\n          \u003curi type=&#39;audio/ogg-speex&#39;\u003e\n            http://www.victim.com/challenges/speech.ogg?A4C7303D\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield var=&#39;video_recog&#39; label=&#39;Identity the video&#39;\u003e\n        \u003cmedia xmlns=&#39;urn:xmpp:media-element&#39;\n               height=&#39;150&#39;\n               width=&#39;150&#39;\u003e\n          \u003curi type=&#39;video/mpeg&#39;\u003e\n            http://www.victim.com/challenges/video.mpeg?A4C7303D\n          \u003c/uri\u003e\n        \u003c/media\u003e\n      \u003c/field\u003e\n      \u003cfield label=&#39;Type the color of a stop light&#39; type=&#39;text-single&#39; var=&#39;qa&#39;/\u003e\n      \u003cfield label=&#39;93C7A&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Challenger Offers a Choice of Challenges to Sender&#34;
        }
      ],
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;A service that hosts multi-user chat rooms in accordance with&#34;,
        &#34;cite&#34;: &#34;XEP-0045&#34;
      }
    },
    {
      &#34;-anchor&#34;: &#34;challenge&#34;,
      &#34;-topic&#34;: &#34;Challenge Types&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;challenge-intro&#34;,
          &#34;-topic&#34;: &#34;Introduction&#34;,
          &#34;p&#34;: [
            &#34;Entities MUST address the needs of disabled people and CPU-constrained clients by offering senders a reasonable choice of different types of challenges.&#34;,
            {
              &#34;#text&#34;: &#34;Desktop clients running on modern PCs will typically be configured to automatically perform a specified &#39;SHA-256&#39; Hashcash challenge (see below) whenever it is below a certain level of difficulty, with the result that many people may not even notice challenges most of the time. However, people using CPU-constrained clients (e.g. Web or mobile clients) would notice the performance hit. They might prefer to take a CAPTCHA challenge instead.&#34;,
              &#34;note&#34;: &#34;A CPU-constrained client could ask a faster computer (e.g., its server) to perform a Hashcash challenge for it.&#34;
            },
            &#34;Visually disabled people using a CPU-constrained client could configure their client to always present them with an audio CAPTCHA challenge.&#34;,
            &#34;Most of the challenges below are language sensitive. However, the evaluation of the OCR and Hashcash responses does not depend on the language the sender is using.&#34;,
            {
              &#34;#text&#34;: &#34;Challenge types are distinguished by the &#39;var&#39; attribute of each \u003cfield/\u003e element. Several types of challenges are described below. More challenges MAY be documented elsewhere and registered with the XMPP Registrar (see&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Field Standardization&#34;,
                &#34;-url&#34;: &#34;#registrar-formtypes&#34;
              }
            }
          ]
        },
        {
          &#34;-anchor&#34;: &#34;challenge-hashcash&#34;,
          &#34;-topic&#34;: &#34;SHA-256 Hashcash&#34;,
          &#34;code&#34;: &#34;innocent@victim.com2450F06C173B05E3&#34;,
          &#34;p&#34;: [
            {
              &#34;#text&#34;: &#34;The SHA-256 Hashcash challenge is transparent to average PC users. It is indicated when the value of the &#39;var&#39; attribute is &#39;SHA-256&#39;. It forces clients to perform CPU-intensive work, making it difficult to send large amounts of abusive traffic. This significantly reduces abusive traffic, but alone it will not completely stop abusive stanzas from being sent through large collections of &#39;zombie&#39; computers.&#34;,
              &#34;note&#34;: &#34;The hope is that the extra CPU usage will often be noticed by the owners of the zombie machines, who will be more likely to fix them.&#34;
            },
            {
              &#34;#text&#34;: &#34;The challenger MUST set the &#39;label&#39; attribute of the \u003cfield/\u003e element to a hexadecimal random number containing a configured number of bits (e.g., 2&#34;,
              &#34;span&#34;: [
                {
                  &#34;#text&#34;: &#34;20&#34;,
                  &#34;-class&#34;: &#34;super&#34;
                },
                {
                  &#34;#text&#34;: &#34;21&#34;,
                  &#34;-class&#34;: &#34;super&#34;
                }
              ]
            },
            {
              &#34;#text&#34;: &#34;To pass the test, the sender MUST return a text string that starts with the JID the sender sent the first stanza to (i.e., the stanza that triggered the challenge). The least significant bits of the SHA-256 hash (see&#34;,
              &#34;note&#34;: {
                &#34;#text&#34;: &#34;Secure Hash Standard: Federal Information Processing Standards Publication 180-2  \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;http://csrc.nist.gov/publications/fips/fips180-2/fips186-2withchangenotice.pdf&#34;,
                  &#34;-url&#34;: &#34;http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf&#34;
                }
              },
              &#34;span&#34;: {
                &#34;-class&#34;: &#34;ref&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;SHA&#34;,
                  &#34;-url&#34;: &#34;http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf&#34;
                }
              }
            },
            &#34;Note: When configuring the number of bits to be specified by a challenger in the &#39;label&#39; attribute values, administrators MUST balance the need to make mass abuse as difficult as possible, with the inconvenience that may be caused to the users of less powerful computers. (Most clients will be challenged only very occasionally, so the consumption of 70% of a typical desktop CPU for 4 seconds might be considered appropriate.) Administrators SHOULD increment the configured number of bits from time to time to match increases in the performance of typical desktop PCs. If an administrator notices that abusive robots never attempt the Hashcash challenge, then he SHOULD consider reducing the number of bits, to avoid inconveniencing people unnecessarily.&#34;
          ]
        },
        {
          &#34;-anchor&#34;: &#34;challenge-captcha&#34;,
          &#34;-topic&#34;: &#34;CAPTCHAs&#34;,
          &#34;p&#34;: [
            &#34;Note: It may be profitable to send abusive stanzas even if less than one percent of CAPTCHA responses are successful. The effectiveness of a CAPTCHA challenge needs to be close to perfect, unless it is used in combination with other anti-abuse techniques.&#34;,
            {
              &#34;#text&#34;: &#34;If a media type is specified (see table below) then the \u003cfield/\u003e element MUST contain a \u003cmedia/\u003e element that includes a \u003curi/\u003e element of that type. Clients that support the CAPTCHA type MUST be able to play or render the specified MIME-types (see table below). They MAY also support other formats.&#34;,
              &#34;note&#34;: &#34;Audio CAPTCHAs typically require challengers to provide at least the &#39;audio/x-wav&#39; MIME-type (with the PCM codec) because more efficient patent-free formats are often not supported by constrained clients. It is RECOMMENDED that challengers provide more compact formats (like Ogg Speex or MP3) too.&#34;
            },
            {
              &#34;#text&#34;: &#34;The &#39;type&#39; attribute of the \u003cfield/\u003e element SHOULD be &#39;text-single&#39;, &#39;text-private&#39;, or &#39;text-multi&#39; (if no &#39;type&#39; is specified, the default is &#39;text-single&#39;).&#34;,
              &#34;note&#34;: &#34;The &#39;boolean&#39; and &#39;list-single&#39; field types would make it trivial for a robot to provide a correct response at least some of the time.&#34;
            },
            {
              &#34;#text&#34;: &#34;* See the&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;Internationalization Considerations&#34;,
                &#34;-url&#34;: &#34;#i18n&#34;
              }
            },
            {
              &#34;#text&#34;: &#34;** The image portrays random characters that humans can read but OCR software cannot.&#34;,
              &#34;note&#34;: {
                &#34;#text&#34;: &#34;See PWNtcha \u003c&#34;,
                &#34;link&#34;: {
                  &#34;#text&#34;: &#34;http://sam.zoy.org/pwntcha/&#34;,
                  &#34;-url&#34;: &#34;http://sam.zoy.org/pwntcha/&#34;
                }
              }
            }
          ],
          &#34;table&#34;: {
            &#34;-caption&#34;: &#34;CAPTCHAs&#34;,
            &#34;tr&#34;: [
              {
                &#34;th&#34;: [
                  &#34;&#39;var&#39;&#34;,
                  &#34;Name&#34;,
                  &#34;Media type&#34;,
                  &#34;MIME-type&#34;,
                  &#34;Suggested generic instructions *&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;audio_recog&#34;,
                  &#34;Audio Recognition&#34;,
                  &#34;audio&#34;,
                  &#34;audio/x-wav&#34;,
                  &#34;Describe the sound you hear&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;ocr **&#34;,
                  &#34;Optical Character Recognition&#34;,
                  &#34;image&#34;,
                  &#34;image/jpeg&#34;,
                  &#34;Enter the text you see&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;picture_q&#34;,
                  &#34;Picture Question&#34;,
                  &#34;image&#34;,
                  &#34;image/jpeg&#34;,
                  &#34;Answer the question you see&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;picture_recog&#34;,
                  &#34;Picture Recognition&#34;,
                  &#34;image&#34;,
                  &#34;image/jpeg&#34;,
                  &#34;Identify the picture&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;qa&#34;,
                  &#34;Text Question and Answer&#34;,
                  &#34;-&#34;,
                  &#34;-&#34;,
                  &#34;-&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;speech_q&#34;,
                  &#34;Speech Question&#34;,
                  &#34;audio&#34;,
                  &#34;audio/x-wav&#34;,
                  &#34;Answer the question you hear&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;speech_recog&#34;,
                  &#34;Speech Recognition&#34;,
                  &#34;audio&#34;,
                  &#34;audio/x-wav&#34;,
                  &#34;Enter the words you hear&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;video_q&#34;,
                  &#34;Video Question&#34;,
                  &#34;video&#34;,
                  &#34;video/mpeg&#34;,
                  &#34;Answer the question in the video&#34;
                ]
              },
              {
                &#34;td&#34;: [
                  &#34;video_recog&#34;,
                  &#34;Video Recognition&#34;,
                  &#34;video&#34;,
                  &#34;video/mpeg&#34;,
                  &#34;Identify the video&#34;
                ]
              }
            ]
          }
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;legacy&#34;,
      &#34;-topic&#34;: &#34;Question and Answer for Legacy Clients&#34;,
      &#34;example&#34;: [
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;innocent@victim.com/pda&#39;\n    to=&#39;robot@abuser.com/zombie&#39;\n    xml:lang=&#39;en&#39;\n    id=&#39;F3A6292C&#39;\u003e\n  \u003cbody\u003eYour messages to me are being blocked. To unblock them,\n    reply with the color of a stop light followed by &#39;F3A6292C&#39;.\u003c/body\u003e\n  \u003ccaptcha xmlns=&#39;urn:xmpp:captcha&#39;\u003e\n    \u003cx xmlns=&#39;jabber:x:data&#39; type=&#39;form&#39;\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;FORM_TYPE&#39;\u003e\n        \u003cvalue\u003eurn:xmpp:captcha\u003c/value\u003e\n      \u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;from&#39;\u003e\u003cvalue\u003einnocent@victim.com\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;challenge&#39;\u003e\u003cvalue\u003eF3A6292C\u003c/value\u003e\u003c/field\u003e\n      \u003cfield type=&#39;hidden&#39; var=&#39;sid&#39;\u003e\u003cvalue\u003espam1\u003c/value\u003e\u003c/field\u003e\n      \u003cfield label=&#39;Type the color of a stop light&#39; type=&#39;text-single&#39; var=&#39;qa&#39;/\u003e\n      \u003cfield label=&#39;93C7A&#39; type=&#39;text-single&#39; var=&#39;SHA-256&#39;/\u003e\n    \u003c/x\u003e\n  \u003c/captcha\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Challenger Includes a Legacy Challenge&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;robot@abuser.com/zombie&#39; to=&#39;innocent@victim.com/pda&#39;\u003e\n  \u003cbody\u003ered F3A6292C\u003c/body\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Legacy Sender Responds&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003cmessage from=&#39;innocent@victim.com/pda&#39; to=&#39;robot@abuser.com/zombie&#39;\u003e\n  \u003cbody\u003eYour message was delivered. Your messages\n        to me are no longer being blocked.\u003c/body\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Challenger Tells Legacy Sender it Passed&#34;
        },
        {
          &#34;#text&#34;: &#34;\u003cmessage type=&#39;error&#39;\n         from=&#39;innocent@victim.com/pda&#39;\n         to=&#39;robot@abuser.com/zombie&#39;\u003e\n  \u003cerror type=&#39;cancel&#39;\u003e\n    \u003cnot-acceptable xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;/\u003e\n    \u003ctext xmlns=&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;\u003e\n      Your message to me was not delivered.\n    \u003c/text\u003e\n  \u003c/error\u003e\n\u003c/message\u003e&#34;,
          &#34;-caption&#34;: &#34;Challenger Tells Legacy Sender it Failed&#34;
        }
      ],
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;A challenger MAY provide a text question in the \u003cbody/\u003e element of a challenge stanza for clients that do not support CAPTCHA forms. Entities that cannot serve&#34;,
          &#34;cite&#34;: &#34;Out-of-Band Data&#34;
        },
        &#34;Note: Robots always attempt the easiest challenge they are offered. So the question MUST be at least as difficult for a robot as the CAPTCHA form.&#34;,
        &#34;Note: Even if it provides a text question in the \u003cbody/\u003e element, a challenger MUST always provide a CAPTCHA form.&#34;,
        &#34;Legacy clients respond to the challenger using a \u003cmessage/\u003e stanza (not an \u003ciq/\u003e).&#34;,
        &#34;The challenger SHOULD treat the stanza as a normal message (instead of as a response to its challenge) if the legacy client either takes too long to submit it or has already responded to the challenge. The challenger MAY treat the response as a normal message even in cases where the challenge became unnecessary while the challenger was waiting for the response.&#34;,
        &#34;Otherwise the challenger MUST report the result of the challenge to the legacy client using a \u003cmessage/\u003e stanza (not an \u003ciq/\u003e).&#34;
      ]
    },
    {
      &#34;-anchor&#34;: &#34;stop&#34;,
      &#34;-topic&#34;: &#34;Discontinuation Policy&#34;,
      &#34;p&#34;: [
        {
          &#34;#text&#34;: &#34;It is RECOMMENDED that entities employ other techniques to combat abusive stanzas in addition to those described in this document (e.g., see&#34;,
          &#34;cite&#34;: &#34;XEP-0161&#34;,
          &#34;note&#34;: {
            &#34;#text&#34;: &#34;XEP-0205: Best Practices to Discourage Denial of Service Attacks \u003c&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/extensions/xep-0205.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0205.html&#34;
            }
          },
          &#34;span&#34;: {
            &#34;-class&#34;: &#34;ref&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;Best Practices to Discourage Denial of Service Attacks (XEP-0205)&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/extensions/xep-0205.html&#34;
            }
          }
        },
        &#34;It is expected that this protocol will be an important and successful tool for discouraging abusive traffic. However, much of its success is dependent on the quality of the CAPTCHAs and other puzzles employed by a particular implementation.&#34;,
        &#34;The administrator of an application that functions as a challenger SHOULD discontinue the use of CAPTCHA forms under the following circumstances:&#34;
      ],
      &#34;ul&#34;: {
        &#34;li&#34;: [
          &#34;If he realises that the challenger&#39;s challenges are largely ineffective in combating abusive traffic, and that the reduction in abuse does not compensate for the inconvenience to humans of responding to the challenger&#39;s challenges.&#34;,
          {
            &#34;#text&#34;: &#34;If other,&#34;,
            &#34;em&#34;: &#34;more transparent&#34;
          },
          &#34;If the challenger needs no protection at all because it receives only a negligible amount of abusive traffic.&#34;
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;i18n&#34;,
      &#34;-topic&#34;: &#34;Internationalization Considerations&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;Each form field SHOULD include a &#39;label&#39; attribute. If the sender did not include an &#39;xml:lang&#39; attribute, then the challenger may not know the correct language for the labels. Therefore, depending on user preferences, the client that receives a challenge MAY present generic but localized text instead of label text that would not be understood by the user. Suggested generic text (to be suitably localized) is provided by&#34;,
        &#34;link&#34;: [
          {
            &#34;#text&#34;: &#34;Table 1&#34;,
            &#34;-url&#34;: &#34;#table-1&#34;
          },
          {
            &#34;#text&#34;: &#34;CAPTCHAs&#34;,
            &#34;-url&#34;: &#34;#challenge-captcha&#34;
          }
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;sec&#34;,
      &#34;-topic&#34;: &#34;Security Considerations&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;The use of CAPTCHAs is not a panacea, and should be combined with other anti-abuse mechanisms, such as those described in&#34;,
        &#34;cite&#34;: [
          &#34;XEP-0161&#34;,
          &#34;XEP-0205&#34;
        ]
      }
    },
    {
      &#34;-anchor&#34;: &#34;iana&#34;,
      &#34;-topic&#34;: &#34;IANA Considerations&#34;,
      &#34;p&#34;: {
        &#34;#text&#34;: &#34;This document requires no interaction with the&#34;,
        &#34;note&#34;: {
          &#34;#text&#34;: &#34;The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see \u003c&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;http://www.iana.org/&#34;,
            &#34;-url&#34;: &#34;http://www.iana.org/&#34;
          }
        },
        &#34;span&#34;: {
          &#34;-class&#34;: &#34;ref&#34;,
          &#34;link&#34;: {
            &#34;#text&#34;: &#34;Internet Assigned Numbers Authority (IANA)&#34;,
            &#34;-url&#34;: &#34;http://www.iana.org/&#34;
          }
        }
      }
    },
    {
      &#34;-anchor&#34;: &#34;registrar&#34;,
      &#34;-topic&#34;: &#34;XMPP Registrar Considerations&#34;,
      &#34;section2&#34;: [
        {
          &#34;-anchor&#34;: &#34;ns&#34;,
          &#34;-topic&#34;: &#34;Protocol Namespaces&#34;,
          &#34;p&#34;: {
            &#34;#text&#34;: &#34;The&#34;,
            &#34;link&#34;: {
              &#34;#text&#34;: &#34;https://xmpp.org/registrar/namespaces.html&#34;,
              &#34;-url&#34;: &#34;https://xmpp.org/registrar/namespaces.html&#34;
            },
            &#34;note&#34;: {
              &#34;#text&#34;: &#34;The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see \u003c&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;https://xmpp.org/registrar/&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/registrar/&#34;
              }
            },
            &#34;span&#34;: {
              &#34;-class&#34;: &#34;ref&#34;,
              &#34;link&#34;: {
                &#34;#text&#34;: &#34;XMPP Registrar&#34;,
                &#34;-url&#34;: &#34;https://xmpp.org/registrar/&#34;
              }
            }
          }
        },
        {
          &#34;-anchor&#34;: &#34;registrar-formtypes&#34;,
          &#34;-topic&#34;: &#34;Field Standardization&#34;,
          &#34;section3&#34;: [
            {
              &#34;-anchor&#34;: &#34;registrar-formtypes-captcha&#34;,
              &#34;-topic&#34;: &#34;CAPTCHA FORM_TYPE&#34;,
              &#34;code&#34;: &#34;\u003cform_type\u003e\n  \u003cname\u003eurn:xmpp:captcha\u003c/name\u003e\n  \u003cdoc\u003eXEP-0158\u003c/doc\u003e\n  \u003cdesc\u003eForms enabling the use of CAPTCHAs.\u003c/desc\u003e\n  \u003cfield\n      var=&#39;answers&#39;\n      type=&#39;hidden&#39;\n      label=&#39;number of answers required&#39;/\u003e\n  \u003cfield\n      var=&#39;audio_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a sound&#39;/\u003e\n  \u003cfield\n      var=&#39;challenge&#39;\n      type=&#39;hidden&#39;\n      label=&#39;challenge ID&#39;/\u003e\n  \u003cfield\n      var=&#39;from&#39;\n      type=&#39;hidden&#39;\n      label=&#39;to attribute of stanza that triggered challenge&#39;/\u003e\n  \u003cfield\n      var=&#39;ocr&#39;\n      type=&#39;text-single&#39;\n      label=&#39;code appearing in an image&#39;/\u003e\n  \u003cfield\n      var=&#39;picture_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with a picture&#39;/\u003e\n  \u003cfield\n      var=&#39;picture_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a picture&#39;/\u003e\n  \u003cfield\n      var=&#39;qa&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer to a question&#39;/\u003e\n  \u003cfield\n      var=&#39;SHA-256&#39;\n      type=&#39;text-single&#39;\n      label=&#39;least significant bits of SHA-256 hash of text should equal hexadecimal label&#39;/\u003e\n  \u003cfield\n      var=&#39;sid&#39;\n      type=&#39;hidden&#39;\n      label=&#39;stanza ID&#39;/\u003e\n  \u003cfield\n      var=&#39;speech_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with speech&#39;/\u003e\n  \u003cfield\n      var=&#39;speech_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with speech&#39;/\u003e\n  \u003cfield\n      var=&#39;video_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with a video&#39;/\u003e\n  \u003cfield\n      var=&#39;video_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a video&#39;/\u003e\n\u003c/form_type\u003e&#34;,
              &#34;p&#34;: {
                &#34;#text&#34;: &#34;The&#34;,
                &#34;cite&#34;: &#34;XMPP Registrar&#34;
              }
            },
            {
              &#34;-anchor&#34;: &#34;registrar-formtypes-register&#34;,
              &#34;-topic&#34;: &#34;jabber:iq:register FORM_TYPE&#34;,
              &#34;code&#34;: &#34;\u003cform_type\u003e\n  \u003cname\u003ejabber:iq:register\u003c/name\u003e\n  \u003cdoc\u003eXEP-0077\u003c/doc\u003e\n  \u003cfield\n      var=&#39;answers&#39;\n      type=&#39;hidden&#39;\n      label=&#39;number of answers required&#39;/\u003e\n  \u003cfield\n      var=&#39;audio_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a sound&#39;/\u003e\n  \u003cfield\n      var=&#39;challenge&#39;\n      type=&#39;hidden&#39;\n      label=&#39;challenge ID&#39;/\u003e\n  \u003cfield\n      var=&#39;ocr&#39;\n      type=&#39;text-single&#39;\n      label=&#39;code appearing in an image&#39;/\u003e\n  \u003cfield\n      var=&#39;picture_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with a picture&#39;/\u003e\n  \u003cfield\n      var=&#39;picture_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a picture&#39;/\u003e\n  \u003cfield\n      var=&#39;qa&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer to a question&#39;/\u003e\n  \u003cfield\n      var=&#39;SHA-256&#39;\n      type=&#39;text-single&#39;\n      label=&#39;least significant bits of SHA-256 hash of text should equal hexadecimal label&#39;/\u003e\n  \u003cfield\n      var=&#39;sid&#39;\n      type=&#39;hidden&#39;\n      label=&#39;stanza ID&#39;/\u003e\n  \u003cfield\n      var=&#39;speech_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with speech&#39;/\u003e\n  \u003cfield\n      var=&#39;speech_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with speech&#39;/\u003e\n  \u003cfield\n      var=&#39;video_q&#39;\n      type=&#39;text-single&#39;\n      label=&#39;answer associated with a video&#39;/\u003e\n  \u003cfield\n      var=&#39;video_recog&#39;\n      type=&#39;text-single&#39;\n      label=&#39;text associated with a video&#39;/\u003e\n\u003c/form_type\u003e&#34;,
              &#34;p&#34;: {
                &#34;#text&#34;: &#34;The&#34;,
                &#34;cite&#34;: &#34;XMPP Registrar&#34;
              }
            }
          ]
        }
      ]
    },
    {
      &#34;-anchor&#34;: &#34;schema&#34;,
      &#34;-topic&#34;: &#34;XML Schema&#34;,
      &#34;code&#34;: &#34;\u003c?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?\u003e\n\n\u003cxs:schema\n    xmlns:xs=&#39;http://www.w3.org/2001/XMLSchema&#39;\n    targetNamespace=&#39;urn:xmpp:captcha&#39;\n    xmlns=&#39;urn:xmpp:captcha&#39;\n    elementFormDefault=&#39;qualified&#39;\u003e\n\n  \u003cxs:annotation\u003e\n    \u003cxs:documentation\u003e\n      The protocol documented by this schema is defined in\n      XEP-0158: http://xmpp.org/extensions/xep-0158.html\n    \u003c/xs:documentation\u003e\n  \u003c/xs:annotation\u003e\n\n  \u003cxs:import namespace=&#39;jabber:x:data&#39;\n             schemaLocation=&#39;http://xmpp.org/schemas/x-data.xsd&#39;/\u003e\n\n  \u003cxs:element name=&#39;captcha&#39;\u003e\n    \u003cxs:complexType\u003e\n      \u003cxs:sequence xmlns:xdata=&#39;jabber:x:data&#39;\u003e\n        \u003cxs:element ref=&#39;xdata:x&#39; minOccurs=&#39;1&#39; maxOccurs=&#39;1&#39;/\u003e\n      \u003c/xs:sequence\u003e\n    \u003c/xs:complexType\u003e\n  \u003c/xs:element\u003e\n\n\u003c/xs:schema\u003e&#34;
    },
    {
      &#34;-anchor&#34;: &#34;open&#34;,
      &#34;-topic&#34;: &#34;Open Issues&#34;,
      &#34;p&#34;: &#34;Another protocol could allow users to edit the challenges their server will make on their behalf. For example, the number of SHA-256 bits, a personal or original question and answer, a picture, a video, or a sound recording. Of course Aunt Tillie would typically use this feature only if she was plagued by abusive traffic.&#34;
    }
  ]
}</pre></a></td><td>planned</td><tr></table></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://monal-im.github.io/monal-im.org/site/>Monal</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script type=text/javascript src=https://monal-im.github.io/monal-im.org/site/js/main.min.416309f1329adbd311186e61f8f1d0b56d9c308752b71dd96914593d05ef8166.js integrity="sha256-QWMJ8TKa29MRGG5h+PHQtW2cMIdStx3ZaRRZPQXvgWY="></script></body></html>